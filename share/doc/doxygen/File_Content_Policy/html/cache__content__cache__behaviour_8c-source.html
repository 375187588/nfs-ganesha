<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>File Content Policy layer: cache_content_cache_behaviour.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>cache_content_cache_behaviour.c</h1><a href="cache__content__cache__behaviour_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> * vim:expandtab:shiftwidth=8:tabstop=8:</span>
00003 <span class="comment"> */</span>
00004 
00017 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
00018 <span class="preprocessor"></span><span class="preprocessor">#include "config.h"</span>
00019 <span class="preprocessor">#endif</span>
00020 <span class="preprocessor"></span>
00021 
00022 <span class="preprocessor">#include "LRU_List.h"</span>
00023 <span class="preprocessor">#include "log_functions.h"</span>
00024 <span class="preprocessor">#include "HashData.h"</span>
00025 <span class="preprocessor">#include "HashTable.h"</span>
00026 <span class="preprocessor">#include "fsal.h"</span>
00027 <span class="preprocessor">#include "cache_inode.h"</span>
00028 <span class="preprocessor">#include "cache_content.h"</span>
00029 <span class="preprocessor">#include "cache_content_policy.h"</span>
00030 
00031 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
00032 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
00033 <span class="preprocessor">#include &lt;sys/param.h&gt;</span>
00034 <span class="preprocessor">#include &lt;time.h&gt;</span>
00035 <span class="preprocessor">#include &lt;pthread.h&gt;</span>
00036 <span class="preprocessor">#include &lt;errno.h&gt;</span>
00037 
00038 
<a name="l00056"></a><a class="code" href="cache__content__cache__behaviour_8c.html#a0">00056</a> cache_content_caching_type_t <a class="code" href="cache__content__cache__behaviour_8c.html#a0">cache_content_cache_behaviour</a>( cache_entry_t               * pentry_inode,
00057                                                             cache_content_policy_data_t * ppolicy_data,
00058                                                             cache_content_client_t      * pclient,
00059                                                             cache_content_status_t      * pstatus ) 
00060 {
00061   *pstatus = CACHE_CONTENT_FULLY_CACHED ;
00062  
00063   <span class="keywordflow">if</span>( pentry_inode-&gt;internal_md.type != REGULAR_FILE ) 
00064    {
00065       *pstatus = CACHE_CONTENT_INVALID_ARGUMENT ;
00066       <span class="keywordflow">return</span> *pstatus ;
00067    }
00068  
00069   <span class="keywordflow">if</span>( ppolicy_data-&gt;UseMaxCacheSize ) 
00070    {
00071      <span class="keywordflow">if</span>( pentry_inode-&gt;object.file.attributes.filesize &gt; ppolicy_data-&gt;MaxCacheSize )
00072        *pstatus = CACHE_CONTENT_TOO_LARGE_FOR_CACHE ;
00073    }
00074 
00075   <span class="keywordflow">return</span> *pstatus ;
00076 } <span class="comment">/* cache_content_cache_behaviour */</span>
00077 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 9 08:24:21 2008 for File Content Policy layer by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
