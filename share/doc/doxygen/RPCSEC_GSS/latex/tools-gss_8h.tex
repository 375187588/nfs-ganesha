\section{tools-gss.h File Reference}
\label{tools-gss_8h}\index{tools-gss.h@{tools-gss.h}}
{\tt \#include $<$sys/time.h$>$}\par
{\tt \#include $<$stdlib.h$>$}\par
{\tt \#include $<$stdio.h$>$}\par
{\tt \#include $<$string.h$>$}\par
{\tt \#include $<$ctype.h$>$}\par
{\tt \#include $<$unistd.h$>$}\par
{\tt \#include $<$fcntl.h$>$}\par
{\tt \#include $<$errno.h$>$}\par
{\tt \#include $<$signal.h$>$}\par
{\tt \#include $<$sys/socket.h$>$}\par
{\tt \#include $<$netdb.h$>$}\par
{\tt \#include $<$netinet/in.h$>$}\par
{\tt \#include $<$netinet/tcp.h$>$}\par
{\tt \#include \char`\"{}aglae.h\char`\"{}}\par
{\tt \#include $<$dce/gssapi.h$>$}\par
\subsection*{Defines}
\begin{CompactItemize}
\item 
\#define {\bf TOKEN\_\-NOOP}\ (1$<$$<$0)
\item 
\#define {\bf TOKEN\_\-CONTEXT}\ (1$<$$<$1)
\item 
\#define {\bf TOKEN\_\-DATA}\ (1$<$$<$2)
\item 
\#define {\bf TOKEN\_\-MIC}\ (1$<$$<$3)
\item 
\#define {\bf TOKEN\_\-CONTEXT\_\-NEXT}\ (1$<$$<$4)
\item 
\#define {\bf TOKEN\_\-WRAPPED}\ (1$<$$<$5)
\item 
\#define {\bf TOKEN\_\-ENCRYPTED}\ (1$<$$<$6)
\item 
\#define {\bf TOKEN\_\-SEND\_\-MIC}\ (1$<$$<$7)
\item 
\#define {\bf TOKEN\_\-NOOP}\ (1$<$$<$0)
\item 
\#define {\bf TOKEN\_\-CONTEXT}\ (1$<$$<$1)
\item 
\#define {\bf TOKEN\_\-DATA}\ (1$<$$<$2)
\item 
\#define {\bf TOKEN\_\-MIC}\ (1$<$$<$3)
\item 
\#define {\bf TOKEN\_\-CONTEXT\_\-NEXT}\ (1$<$$<$4)
\item 
\#define {\bf TOKEN\_\-WRAPPED}\ (1$<$$<$5)
\item 
\#define {\bf TOKEN\_\-ENCRYPTED}\ (1$<$$<$6)
\item 
\#define {\bf TOKEN\_\-SEND\_\-MIC}\ (1$<$$<$7)
\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
void {\bf sperror\_\-gss} (char $\ast$str, OM\_\-uint32 major, OM\_\-uint32 minor)
\item 
int {\bf write\_\-tok} (int s, gss\_\-buffer\_\-t tok)
\item 
int {\bf read\_\-tok} (int s, gss\_\-buffer\_\-t tok)
\item 
int {\bf recv\_\-msg} (int fd, char $\ast$msg, gss\_\-ctx\_\-id\_\-t context, char $\ast$errbuf)
\item 
int {\bf send\_\-msg} (int fd, char $\ast$msg, gss\_\-ctx\_\-id\_\-t context, char $\ast$errbuf)
\item 
int {\bf recv\_\-token} (int s, int $\ast$flags, gss\_\-buffer\_\-t tok)
\end{CompactItemize}


\subsection{Define Documentation}
\index{tools-gss.h@{tools-gss.h}!TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}}
\index{TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\ (1$<$$<$1)}\label{tools-gss_8h_a9}




Definition at line 31 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}}
\index{TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\ (1$<$$<$1)}\label{tools-gss_8h_a1}




Definition at line 31 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}}
\index{TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\_\-NEXT\ (1$<$$<$4)}\label{tools-gss_8h_a12}




Definition at line 34 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}}
\index{TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\_\-NEXT\ (1$<$$<$4)}\label{tools-gss_8h_a4}




Definition at line 34 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_DATA@{TOKEN\_\-DATA}}
\index{TOKEN_DATA@{TOKEN\_\-DATA}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-DATA\ (1$<$$<$2)}\label{tools-gss_8h_a10}




Definition at line 32 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_DATA@{TOKEN\_\-DATA}}
\index{TOKEN_DATA@{TOKEN\_\-DATA}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-DATA\ (1$<$$<$2)}\label{tools-gss_8h_a2}




Definition at line 32 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}}
\index{TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-ENCRYPTED\ (1$<$$<$6)}\label{tools-gss_8h_a14}




Definition at line 36 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}}
\index{TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-ENCRYPTED\ (1$<$$<$6)}\label{tools-gss_8h_a6}




Definition at line 36 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_MIC@{TOKEN\_\-MIC}}
\index{TOKEN_MIC@{TOKEN\_\-MIC}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-MIC\ (1$<$$<$3)}\label{tools-gss_8h_a11}




Definition at line 33 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_MIC@{TOKEN\_\-MIC}}
\index{TOKEN_MIC@{TOKEN\_\-MIC}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-MIC\ (1$<$$<$3)}\label{tools-gss_8h_a3}




Definition at line 33 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_NOOP@{TOKEN\_\-NOOP}}
\index{TOKEN_NOOP@{TOKEN\_\-NOOP}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-NOOP\ (1$<$$<$0)}\label{tools-gss_8h_a8}




Definition at line 30 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_NOOP@{TOKEN\_\-NOOP}}
\index{TOKEN_NOOP@{TOKEN\_\-NOOP}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-NOOP\ (1$<$$<$0)}\label{tools-gss_8h_a0}




Definition at line 30 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}}
\index{TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-SEND\_\-MIC\ (1$<$$<$7)}\label{tools-gss_8h_a15}




Definition at line 37 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}}
\index{TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-SEND\_\-MIC\ (1$<$$<$7)}\label{tools-gss_8h_a7}




Definition at line 37 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}}
\index{TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-WRAPPED\ (1$<$$<$5)}\label{tools-gss_8h_a13}




Definition at line 35 of file tools-gss.h.\index{tools-gss.h@{tools-gss.h}!TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}}
\index{TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-WRAPPED\ (1$<$$<$5)}\label{tools-gss_8h_a5}




Definition at line 35 of file tools-gss.h.

\subsection{Function Documentation}
\index{tools-gss.h@{tools-gss.h}!read_tok@{read\_\-tok}}
\index{read_tok@{read\_\-tok}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int read\_\-tok (int {\em s}, gss\_\-buffer\_\-t {\em tok})}\label{tools-gss_8h_a18}


\index{tools-gss.h@{tools-gss.h}!recv_msg@{recv\_\-msg}}
\index{recv_msg@{recv\_\-msg}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int recv\_\-msg (int {\em fd}, char $\ast$ {\em msg}, gss\_\-ctx\_\-id\_\-t {\em context}, char $\ast$ {\em errbuf})}\label{tools-gss_8h_a19}




Definition at line 348 of file tools-gss.c.

References gss\_\-get\_\-mic, gss\_\-unwrap, recv\_\-token(), send\_\-token(), sperror\_\-gss(), and TOKEN\_\-MIC.\index{tools-gss.h@{tools-gss.h}!recv_token@{recv\_\-token}}
\index{recv_token@{recv\_\-token}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int recv\_\-token (int {\em s}, int $\ast$ {\em flags}, gss\_\-buffer\_\-t {\em tok})}\label{tools-gss_8h_a21}




Definition at line 218 of file tools-gss.c.

Referenced by negociation\_\-client(), negociation\_\-server(), recv\_\-msg(), and send\_\-msg().\index{tools-gss.h@{tools-gss.h}!send_msg@{send\_\-msg}}
\index{send_msg@{send\_\-msg}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int send\_\-msg (int {\em fd}, char $\ast$ {\em msg}, gss\_\-ctx\_\-id\_\-t {\em context}, char $\ast$ {\em errbuf})}\label{tools-gss_8h_a20}




Definition at line 285 of file tools-gss.c.

References gss\_\-qop\_\-t, gss\_\-verify\_\-mic, gss\_\-wrap, recv\_\-token(), send\_\-token(), sperror\_\-gss(), TOKEN\_\-DATA, TOKEN\_\-ENCRYPTED, and TOKEN\_\-WRAPPED.\index{tools-gss.h@{tools-gss.h}!sperror_gss@{sperror\_\-gss}}
\index{sperror_gss@{sperror\_\-gss}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void sperror\_\-gss (char $\ast$ {\em str}, OM\_\-uint32 {\em major}, OM\_\-uint32 {\em minor})}\label{tools-gss_8h_a16}




Definition at line 80 of file tools-gss.c.

References sperror\_\-gss\_\-1().

Referenced by negociation\_\-client(), negociation\_\-server(), obtention\_\-creds(), recv\_\-msg(), and send\_\-msg().\index{tools-gss.h@{tools-gss.h}!write_tok@{write\_\-tok}}
\index{write_tok@{write\_\-tok}!tools-gss.h@{tools-gss.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int write\_\-tok (int {\em s}, gss\_\-buffer\_\-t {\em tok})}\label{tools-gss_8h_a17}


