\section{tools-gss.c File Reference}
\label{tools-gss_8c}\index{tools-gss.c@{tools-gss.c}}
{\tt \#include $<$sys/time.h$>$}\par
{\tt \#include $<$stdlib.h$>$}\par
{\tt \#include $<$stdio.h$>$}\par
{\tt \#include $<$string.h$>$}\par
{\tt \#include $<$ctype.h$>$}\par
{\tt \#include $<$unistd.h$>$}\par
{\tt \#include $<$fcntl.h$>$}\par
{\tt \#include $<$errno.h$>$}\par
{\tt \#include $<$signal.h$>$}\par
{\tt \#include $<$sys/socket.h$>$}\par
{\tt \#include $<$netdb.h$>$}\par
{\tt \#include $<$netinet/in.h$>$}\par
{\tt \#include $<$netinet/tcp.h$>$}\par
{\tt \#include $<$gssapi/gssapi.h$>$}\par
{\tt \#include $<$gssapi/gssapi\_\-generic.h$>$}\par
\subsection*{Defines}
\begin{CompactItemize}
\item 
\#define {\bf gss\_\-wrap}\ gss\_\-seal
\item 
\#define {\bf gss\_\-unwrap}\ gss\_\-unseal
\item 
\#define {\bf gss\_\-get\_\-mic}\ gss\_\-sign
\item 
\#define {\bf gss\_\-verify\_\-mic}\ gss\_\-verify
\item 
\#define {\bf gss\_\-qop\_\-t}\ OM\_\-uint32
\item 
\#define {\bf TOKEN\_\-NOOP}\ (1$<$$<$0)
\item 
\#define {\bf TOKEN\_\-CONTEXT}\ (1$<$$<$1)
\item 
\#define {\bf TOKEN\_\-DATA}\ (1$<$$<$2)
\item 
\#define {\bf TOKEN\_\-MIC}\ (1$<$$<$3)
\item 
\#define {\bf TOKEN\_\-CONTEXT\_\-NEXT}\ (1$<$$<$4)
\item 
\#define {\bf TOKEN\_\-WRAPPED}\ (1$<$$<$5)
\item 
\#define {\bf TOKEN\_\-ENCRYPTED}\ (1$<$$<$6)
\item 
\#define {\bf TOKEN\_\-SEND\_\-MIC}\ (1$<$$<$7)
\item 
\#define {\bf TOKEN\_\-NOOP}\ (1$<$$<$0)
\item 
\#define {\bf TOKEN\_\-CONTEXT}\ (1$<$$<$1)
\item 
\#define {\bf TOKEN\_\-DATA}\ (1$<$$<$2)
\item 
\#define {\bf TOKEN\_\-MIC}\ (1$<$$<$3)
\item 
\#define {\bf TOKEN\_\-CONTEXT\_\-NEXT}\ (1$<$$<$4)
\item 
\#define {\bf TOKEN\_\-WRAPPED}\ (1$<$$<$5)
\item 
\#define {\bf TOKEN\_\-ENCRYPTED}\ (1$<$$<$6)
\item 
\#define {\bf TOKEN\_\-SEND\_\-MIC}\ (1$<$$<$7)
\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
void {\bf sperror\_\-gss\_\-1} (char $\ast$str, OM\_\-uint32 code, int type)
\item 
void {\bf sperror\_\-gss} (char $\ast$str, OM\_\-uint32 maj\_\-stat, OM\_\-uint32 min\_\-stat)
\item 
int {\bf send\_\-token} (int s, int flags, gss\_\-buffer\_\-t tok)
\item 
int {\bf recv\_\-token} (int s, int $\ast$flags, gss\_\-buffer\_\-t tok)
\item 
int {\bf send\_\-msg} (int fd, char $\ast$msg, gss\_\-ctx\_\-id\_\-t context, char $\ast$errbuff)
\item 
int {\bf recv\_\-msg} (int fd, char $\ast$msg, gss\_\-ctx\_\-id\_\-t context, char $\ast$errbuff)
\end{CompactItemize}
\subsection*{Variables}
\begin{CompactItemize}
\item 
char {\bf rcsid\_\-tools} [$\,$] = \char`\"{}\$Id: tools-gss.c,v 1.1 2005/04/13 13:45:49 deniel Exp \$\char`\"{}
\end{CompactItemize}


\subsection{Define Documentation}
\index{tools-gss.c@{tools-gss.c}!gss_get_mic@{gss\_\-get\_\-mic}}
\index{gss_get_mic@{gss\_\-get\_\-mic}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define gss\_\-get\_\-mic\ gss\_\-sign}\label{tools-gss_8c_a2}




Definition at line 29 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!gss_qop_t@{gss\_\-qop\_\-t}}
\index{gss_qop_t@{gss\_\-qop\_\-t}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define gss\_\-qop\_\-t\ OM\_\-uint32}\label{tools-gss_8c_a4}




Definition at line 31 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!gss_unwrap@{gss\_\-unwrap}}
\index{gss_unwrap@{gss\_\-unwrap}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define gss\_\-unwrap\ gss\_\-unseal}\label{tools-gss_8c_a1}




Definition at line 28 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!gss_verify_mic@{gss\_\-verify\_\-mic}}
\index{gss_verify_mic@{gss\_\-verify\_\-mic}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define gss\_\-verify\_\-mic\ gss\_\-verify}\label{tools-gss_8c_a3}




Definition at line 30 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!gss_wrap@{gss\_\-wrap}}
\index{gss_wrap@{gss\_\-wrap}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define gss\_\-wrap\ gss\_\-seal}\label{tools-gss_8c_a0}




Definition at line 27 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}}
\index{TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\ (1$<$$<$1)}\label{tools-gss_8c_a14}




Definition at line 42 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}}
\index{TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\ (1$<$$<$1)}\label{tools-gss_8c_a6}




Definition at line 42 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}}
\index{TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\_\-NEXT\ (1$<$$<$4)}\label{tools-gss_8c_a17}




Definition at line 45 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}}
\index{TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\_\-NEXT\ (1$<$$<$4)}\label{tools-gss_8c_a9}




Definition at line 45 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_DATA@{TOKEN\_\-DATA}}
\index{TOKEN_DATA@{TOKEN\_\-DATA}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-DATA\ (1$<$$<$2)}\label{tools-gss_8c_a15}




Definition at line 43 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_DATA@{TOKEN\_\-DATA}}
\index{TOKEN_DATA@{TOKEN\_\-DATA}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-DATA\ (1$<$$<$2)}\label{tools-gss_8c_a7}




Definition at line 43 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}}
\index{TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-ENCRYPTED\ (1$<$$<$6)}\label{tools-gss_8c_a19}




Definition at line 47 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}}
\index{TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-ENCRYPTED\ (1$<$$<$6)}\label{tools-gss_8c_a11}




Definition at line 47 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_MIC@{TOKEN\_\-MIC}}
\index{TOKEN_MIC@{TOKEN\_\-MIC}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-MIC\ (1$<$$<$3)}\label{tools-gss_8c_a16}




Definition at line 44 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_MIC@{TOKEN\_\-MIC}}
\index{TOKEN_MIC@{TOKEN\_\-MIC}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-MIC\ (1$<$$<$3)}\label{tools-gss_8c_a8}




Definition at line 44 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_NOOP@{TOKEN\_\-NOOP}}
\index{TOKEN_NOOP@{TOKEN\_\-NOOP}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-NOOP\ (1$<$$<$0)}\label{tools-gss_8c_a13}




Definition at line 41 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_NOOP@{TOKEN\_\-NOOP}}
\index{TOKEN_NOOP@{TOKEN\_\-NOOP}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-NOOP\ (1$<$$<$0)}\label{tools-gss_8c_a5}




Definition at line 41 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}}
\index{TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-SEND\_\-MIC\ (1$<$$<$7)}\label{tools-gss_8c_a20}




Definition at line 48 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}}
\index{TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-SEND\_\-MIC\ (1$<$$<$7)}\label{tools-gss_8c_a12}




Definition at line 48 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}}
\index{TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-WRAPPED\ (1$<$$<$5)}\label{tools-gss_8c_a18}




Definition at line 46 of file tools-gss.c.\index{tools-gss.c@{tools-gss.c}!TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}}
\index{TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-WRAPPED\ (1$<$$<$5)}\label{tools-gss_8c_a10}




Definition at line 46 of file tools-gss.c.

\subsection{Function Documentation}
\index{tools-gss.c@{tools-gss.c}!recv_msg@{recv\_\-msg}}
\index{recv_msg@{recv\_\-msg}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int recv\_\-msg (int {\em fd}, char $\ast$ {\em msg}, gss\_\-ctx\_\-id\_\-t {\em context}, char $\ast$ {\em errbuff})}\label{tools-gss_8c_a29}




Definition at line 348 of file tools-gss.c.

References gss\_\-get\_\-mic, gss\_\-unwrap, recv\_\-token(), send\_\-token(), sperror\_\-gss(), and TOKEN\_\-MIC.\index{tools-gss.c@{tools-gss.c}!recv_token@{recv\_\-token}}
\index{recv_token@{recv\_\-token}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int recv\_\-token (int {\em s}, int $\ast$ {\em flags}, gss\_\-buffer\_\-t {\em tok})}\label{tools-gss_8c_a27}




Definition at line 218 of file tools-gss.c.

Referenced by negociation\_\-client(), negociation\_\-server(), recv\_\-msg(), and send\_\-msg().\index{tools-gss.c@{tools-gss.c}!send_msg@{send\_\-msg}}
\index{send_msg@{send\_\-msg}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int send\_\-msg (int {\em fd}, char $\ast$ {\em msg}, gss\_\-ctx\_\-id\_\-t {\em context}, char $\ast$ {\em errbuff})}\label{tools-gss_8c_a28}




Definition at line 285 of file tools-gss.c.

References gss\_\-qop\_\-t, gss\_\-verify\_\-mic, gss\_\-wrap, recv\_\-token(), send\_\-token(), sperror\_\-gss(), TOKEN\_\-DATA, TOKEN\_\-ENCRYPTED, and TOKEN\_\-WRAPPED.\index{tools-gss.c@{tools-gss.c}!send_token@{send\_\-token}}
\index{send_token@{send\_\-token}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int send\_\-token (int {\em s}, int {\em flags}, gss\_\-buffer\_\-t {\em tok})}\label{tools-gss_8c_a26}




Definition at line 149 of file tools-gss.c.

Referenced by negociation\_\-client(), negociation\_\-server(), recv\_\-msg(), and send\_\-msg().\index{tools-gss.c@{tools-gss.c}!sperror_gss@{sperror\_\-gss}}
\index{sperror_gss@{sperror\_\-gss}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void sperror\_\-gss (char $\ast$ {\em str}, OM\_\-uint32 {\em maj\_\-stat}, OM\_\-uint32 {\em min\_\-stat})}\label{tools-gss_8c_a23}




Definition at line 80 of file tools-gss.c.

References sperror\_\-gss\_\-1().

Referenced by negociation\_\-client(), negociation\_\-server(), obtention\_\-creds(), recv\_\-msg(), and send\_\-msg().\index{tools-gss.c@{tools-gss.c}!sperror_gss_1@{sperror\_\-gss\_\-1}}
\index{sperror_gss_1@{sperror\_\-gss\_\-1}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void sperror\_\-gss\_\-1 (char $\ast$ {\em str}, OM\_\-uint32 {\em code}, int {\em type})}\label{tools-gss_8c_a22}




Definition at line 54 of file tools-gss.c.

Referenced by sperror\_\-gss().

\subsection{Variable Documentation}
\index{tools-gss.c@{tools-gss.c}!rcsid_tools@{rcsid\_\-tools}}
\index{rcsid_tools@{rcsid\_\-tools}!tools-gss.c@{tools-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}char {\bf rcsid\_\-tools}[$\,$] = \char`\"{}\$Id: tools-gss.c,v 1.1 2005/04/13 13:45:49 deniel Exp \$\char`\"{}}\label{tools-gss_8c_a21}




Definition at line 7 of file tools-gss.c.