\section{server-gss.c File Reference}
\label{server-gss_8c}\index{server-gss.c@{server-gss.c}}
{\tt \#include $<$sys/param.h$>$}\par
{\tt \#include $<$sys/time.h$>$}\par
{\tt \#include $<$stdlib.h$>$}\par
{\tt \#include $<$stdio.h$>$}\par
{\tt \#include $<$string.h$>$}\par
{\tt \#include $<$ctype.h$>$}\par
{\tt \#include $<$unistd.h$>$}\par
{\tt \#include $<$fcntl.h$>$}\par
{\tt \#include $<$errno.h$>$}\par
{\tt \#include $<$signal.h$>$}\par
{\tt \#include $<$sys/socket.h$>$}\par
{\tt \#include $<$netdb.h$>$}\par
{\tt \#include $<$netinet/in.h$>$}\par
{\tt \#include $<$netinet/tcp.h$>$}\par
{\tt \#include $<$gssapi/gssapi.h$>$}\par
{\tt \#include $<$gssapi/gssapi\_\-generic.h$>$}\par
\subsection*{Defines}
\begin{CompactItemize}
\item 
\#define {\bf Traduire\-Adresse}(adresse, dest)
\item 
\#define {\bf LOGFILE\_\-DEFAUT}\ \char`\"{}./toto-{\bf server}.log\char`\"{}
\item 
\#define {\bf MAX\_\-CONN}\ 32
\item 
\#define {\bf LENMSG}\ 256
\item 
\#define {\bf STRLEN}\ 256
\item 
\#define {\bf GSS\_\-SERVICE\_\-DEFAUT}\ \char`\"{}toto\char`\"{}
\item 
\#define {\bf TOKEN\_\-NOOP}\ (1$<$$<$0)
\item 
\#define {\bf TOKEN\_\-CONTEXT}\ (1$<$$<$1)
\item 
\#define {\bf TOKEN\_\-DATA}\ (1$<$$<$2)
\item 
\#define {\bf TOKEN\_\-MIC}\ (1$<$$<$3)
\item 
\#define {\bf TOKEN\_\-CONTEXT\_\-NEXT}\ (1$<$$<$4)
\item 
\#define {\bf TOKEN\_\-WRAPPED}\ (1$<$$<$5)
\item 
\#define {\bf TOKEN\_\-ENCRYPTED}\ (1$<$$<$6)
\item 
\#define {\bf TOKEN\_\-SEND\_\-MIC}\ (1$<$$<$7)
\item 
\#define {\bf TOKEN\_\-NOOP}\ (1$<$$<$0)
\item 
\#define {\bf TOKEN\_\-CONTEXT}\ (1$<$$<$1)
\item 
\#define {\bf TOKEN\_\-DATA}\ (1$<$$<$2)
\item 
\#define {\bf TOKEN\_\-MIC}\ (1$<$$<$3)
\item 
\#define {\bf TOKEN\_\-CONTEXT\_\-NEXT}\ (1$<$$<$4)
\item 
\#define {\bf TOKEN\_\-WRAPPED}\ (1$<$$<$5)
\item 
\#define {\bf TOKEN\_\-ENCRYPTED}\ (1$<$$<$6)
\item 
\#define {\bf TOKEN\_\-SEND\_\-MIC}\ (1$<$$<$7)
\item 
\#define {\bf KEYTAB}\ \char`\"{}/var/hpss/etc/hpss.keytab\char`\"{}
\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
int {\bf recv\_\-token} (int s, int $\ast$flags, gss\_\-buffer\_\-t tok)
\item 
int {\bf send\_\-token} (int s, int flags, gss\_\-buffer\_\-t tok)
\item 
void {\bf sperror\_\-gss} (char $\ast$str, OM\_\-uint32 major, OM\_\-uint32 minor)
\item 
int {\bf obtention\_\-creds} (char $\ast$service\_\-name, gss\_\-cred\_\-id\_\-t $\ast$pcreds)
\item 
int {\bf negociation\_\-server} (int sockfd)
\item 
int {\bf main} (int argc, char $\ast$argv[$\,$])
\end{CompactItemize}
\subsection*{Variables}
\begin{CompactItemize}
\item 
char {\bf rcsid} [$\,$] = \char`\"{}\$Id: {\bf server}-gss.c,v 1.1 2005/04/13 13:45:49 deniel Exp \$\char`\"{}
\item 
char {\bf options} [$\,$] = \char`\"{}h\-L:N:P:S:\char`\"{}
\item 
char {\bf utilisation} [$\,$]
\item 
unsigned short {\bf binding\_\-port} = 0
\item 
char {\bf gss\_\-service} [STRLEN]
\item 
gss\_\-cred\_\-id\_\-t {\bf creds}
\end{CompactItemize}


\subsection{Define Documentation}
\index{server-gss.c@{server-gss.c}!GSS_SERVICE_DEFAUT@{GSS\_\-SERVICE\_\-DEFAUT}}
\index{GSS_SERVICE_DEFAUT@{GSS\_\-SERVICE\_\-DEFAUT}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define GSS\_\-SERVICE\_\-DEFAUT\ \char`\"{}toto\char`\"{}}\label{server-gss_8c_a5}




Definition at line 39 of file server-gss.c.

Referenced by main().\index{server-gss.c@{server-gss.c}!KEYTAB@{KEYTAB}}
\index{KEYTAB@{KEYTAB}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define KEYTAB\ \char`\"{}/var/hpss/etc/hpss.keytab\char`\"{}}\label{server-gss_8c_a22}




Definition at line 58 of file server-gss.c.

Referenced by obtention\_\-creds().\index{server-gss.c@{server-gss.c}!LENMSG@{LENMSG}}
\index{LENMSG@{LENMSG}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define LENMSG\ 256}\label{server-gss_8c_a3}




Definition at line 37 of file server-gss.c.\index{server-gss.c@{server-gss.c}!LOGFILE_DEFAUT@{LOGFILE\_\-DEFAUT}}
\index{LOGFILE_DEFAUT@{LOGFILE\_\-DEFAUT}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define LOGFILE\_\-DEFAUT\ \char`\"{}./toto-{\bf server}.log\char`\"{}}\label{server-gss_8c_a1}




Definition at line 35 of file server-gss.c.\index{server-gss.c@{server-gss.c}!MAX_CONN@{MAX\_\-CONN}}
\index{MAX_CONN@{MAX\_\-CONN}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define MAX\_\-CONN\ 32}\label{server-gss_8c_a2}




Definition at line 36 of file server-gss.c.

Referenced by main(), and Svctcp\_\-create().\index{server-gss.c@{server-gss.c}!STRLEN@{STRLEN}}
\index{STRLEN@{STRLEN}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define STRLEN\ 256}\label{server-gss_8c_a4}




Definition at line 38 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}}
\index{TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\ (1$<$$<$1)}\label{server-gss_8c_a15}




Definition at line 50 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}}
\index{TOKEN_CONTEXT@{TOKEN\_\-CONTEXT}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\ (1$<$$<$1)}\label{server-gss_8c_a7}




Definition at line 50 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}}
\index{TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\_\-NEXT\ (1$<$$<$4)}\label{server-gss_8c_a18}




Definition at line 53 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}}
\index{TOKEN_CONTEXT_NEXT@{TOKEN\_\-CONTEXT\_\-NEXT}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-CONTEXT\_\-NEXT\ (1$<$$<$4)}\label{server-gss_8c_a10}




Definition at line 53 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_DATA@{TOKEN\_\-DATA}}
\index{TOKEN_DATA@{TOKEN\_\-DATA}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-DATA\ (1$<$$<$2)}\label{server-gss_8c_a16}




Definition at line 51 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_DATA@{TOKEN\_\-DATA}}
\index{TOKEN_DATA@{TOKEN\_\-DATA}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-DATA\ (1$<$$<$2)}\label{server-gss_8c_a8}




Definition at line 51 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}}
\index{TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-ENCRYPTED\ (1$<$$<$6)}\label{server-gss_8c_a20}




Definition at line 55 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}}
\index{TOKEN_ENCRYPTED@{TOKEN\_\-ENCRYPTED}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-ENCRYPTED\ (1$<$$<$6)}\label{server-gss_8c_a12}




Definition at line 55 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_MIC@{TOKEN\_\-MIC}}
\index{TOKEN_MIC@{TOKEN\_\-MIC}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-MIC\ (1$<$$<$3)}\label{server-gss_8c_a17}




Definition at line 52 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_MIC@{TOKEN\_\-MIC}}
\index{TOKEN_MIC@{TOKEN\_\-MIC}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-MIC\ (1$<$$<$3)}\label{server-gss_8c_a9}




Definition at line 52 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_NOOP@{TOKEN\_\-NOOP}}
\index{TOKEN_NOOP@{TOKEN\_\-NOOP}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-NOOP\ (1$<$$<$0)}\label{server-gss_8c_a14}




Definition at line 49 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_NOOP@{TOKEN\_\-NOOP}}
\index{TOKEN_NOOP@{TOKEN\_\-NOOP}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-NOOP\ (1$<$$<$0)}\label{server-gss_8c_a6}




Definition at line 49 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}}
\index{TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-SEND\_\-MIC\ (1$<$$<$7)}\label{server-gss_8c_a21}




Definition at line 56 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}}
\index{TOKEN_SEND_MIC@{TOKEN\_\-SEND\_\-MIC}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-SEND\_\-MIC\ (1$<$$<$7)}\label{server-gss_8c_a13}




Definition at line 56 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}}
\index{TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-WRAPPED\ (1$<$$<$5)}\label{server-gss_8c_a19}




Definition at line 54 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}}
\index{TOKEN_WRAPPED@{TOKEN\_\-WRAPPED}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define TOKEN\_\-WRAPPED\ (1$<$$<$5)}\label{server-gss_8c_a11}




Definition at line 54 of file server-gss.c.\index{server-gss.c@{server-gss.c}!TraduireAdresse@{TraduireAdresse}}
\index{TraduireAdresse@{TraduireAdresse}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define Traduire\-Adresse(adresse, dest)}\label{server-gss_8c_a0}


{\bf Value:}

\footnotesize\begin{verbatim}sprintf( dest, "%d.%d.%d.%d",                   \
                  ( ntohl( adresse ) & 0xFF000000 ) >> 24, \
                  ( ntohl( adresse ) & 0x00FF0000 ) >> 16, \
                  ( ntohl( adresse ) & 0x0000FF00 ) >> 8,  \
                  ( ntohl( adresse ) & 0x000000FF ) )
\end{verbatim}\normalsize 


Definition at line 28 of file server-gss.c.

\subsection{Function Documentation}
\index{server-gss.c@{server-gss.c}!main@{main}}
\index{main@{main}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int main (int {\em argc}, char $\ast$ {\em argv}[$\,$])}\label{server-gss_8c_a35}




Definition at line 271 of file server-gss.c.

References binding\_\-port, creds, gss\_\-service, GSS\_\-SERVICE\_\-DEFAUT, LENMSG, LOGFILE\_\-DEFAUT, MAX\_\-CONN, negociation\_\-server(), obtention\_\-creds(), options, Traduire\-Adresse, and utilisation.\index{server-gss.c@{server-gss.c}!negociation_server@{negociation\_\-server}}
\index{negociation_server@{negociation\_\-server}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int negociation\_\-server (int {\em sockfd})}\label{server-gss_8c_a34}




Definition at line 149 of file server-gss.c.

References creds, recv\_\-token(), send\_\-token(), sperror\_\-gss(), and TOKEN\_\-CONTEXT.

Referenced by main().\index{server-gss.c@{server-gss.c}!obtention_creds@{obtention\_\-creds}}
\index{obtention_creds@{obtention\_\-creds}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int obtention\_\-creds (char $\ast$ {\em service\_\-name}, gss\_\-cred\_\-id\_\-t $\ast$ {\em pcreds})}\label{server-gss_8c_a33}




Definition at line 87 of file server-gss.c.

References KEYTAB, and sperror\_\-gss().

Referenced by main().\index{server-gss.c@{server-gss.c}!recv_token@{recv\_\-token}}
\index{recv_token@{recv\_\-token}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int recv\_\-token (int {\em s}, int $\ast$ {\em flags}, gss\_\-buffer\_\-t {\em tok})}\label{server-gss_8c_a30}




Definition at line 218 of file tools-gss.c.\index{server-gss.c@{server-gss.c}!send_token@{send\_\-token}}
\index{send_token@{send\_\-token}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int send\_\-token (int {\em s}, int {\em flags}, gss\_\-buffer\_\-t {\em tok})}\label{server-gss_8c_a31}




Definition at line 149 of file tools-gss.c.

Referenced by negociation\_\-client(), negociation\_\-server(), recv\_\-msg(), and send\_\-msg().\index{server-gss.c@{server-gss.c}!sperror_gss@{sperror\_\-gss}}
\index{sperror_gss@{sperror\_\-gss}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void sperror\_\-gss (char $\ast$ {\em str}, OM\_\-uint32 {\em major}, OM\_\-uint32 {\em minor})}\label{server-gss_8c_a32}




Definition at line 80 of file tools-gss.c.

\subsection{Variable Documentation}
\index{server-gss.c@{server-gss.c}!binding_port@{binding\_\-port}}
\index{binding_port@{binding\_\-port}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}unsigned short {\bf binding\_\-port} = 0}\label{server-gss_8c_a27}




Definition at line 79 of file server-gss.c.

Referenced by main().\index{server-gss.c@{server-gss.c}!creds@{creds}}
\index{creds@{creds}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}gss\_\-cred\_\-id\_\-t {\bf creds}}\label{server-gss_8c_a29}




Definition at line 81 of file server-gss.c.

Referenced by main(), and negociation\_\-server().\index{server-gss.c@{server-gss.c}!gss_service@{gss\_\-service}}
\index{gss_service@{gss\_\-service}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}char {\bf gss\_\-service}[STRLEN]}\label{server-gss_8c_a28}




Definition at line 80 of file server-gss.c.

Referenced by main().\index{server-gss.c@{server-gss.c}!options@{options}}
\index{options@{options}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}char {\bf options}[$\,$] = \char`\"{}h\-L:N:P:S:\char`\"{}}\label{server-gss_8c_a24}




Definition at line 66 of file server-gss.c.\index{server-gss.c@{server-gss.c}!rcsid@{rcsid}}
\index{rcsid@{rcsid}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}char {\bf rcsid}[$\,$] = \char`\"{}\$Id: {\bf server}-gss.c,v 1.1 2005/04/13 13:45:49 deniel Exp \$\char`\"{}}\label{server-gss_8c_a23}




Definition at line 6 of file server-gss.c.\index{server-gss.c@{server-gss.c}!utilisation@{utilisation}}
\index{utilisation@{utilisation}!server-gss.c@{server-gss.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}char {\bf utilisation}[$\,$]}\label{server-gss_8c_a25}


{\bf Initial value:}

\footnotesize\begin{verbatim} 
"Utilisation: %s [-hLPM] \n"
"\t[-h]                   affiche cet aide en ligne\n"
"\t[-L <logfile>]         indique le fichier de log\n"
"\t[-N <NivDebug>]        indique le niveau de debug pour les journaux\n" 
"\t[-P <port ou service>] indique le port ou le service a utiliser\n"
"\t[-S <service Auth>]    le service utilise par ls GSS-API\n"
\end{verbatim}\normalsize 


Definition at line 69 of file server-gss.c.