<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>RPCSEC_GSS Library: rpcsec_gss_server.natif.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>rpcsec_gss_server.natif.c</h1><a href="rpcsec__gss__server_8natif_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> * RPCSEC_GSS: basic server for tests</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> *  $Header: /cea/home/cvs/cvs/SHERPA/BaseCvs/GANESHA/src/RPCSEC_GSS/rpcsec_gss_server.c,v 1.1 2005/04/13 11:32:38 deniel Exp $</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> * $Log: rpcsec_gss_server.c,v $</span>
00007 <span class="comment"> * Revision 1.1  2005/04/13 11:32:38  deniel</span>
00008 <span class="comment"> * Added the two test client and server</span>
00009 <span class="comment"> *</span>
00010 <span class="comment"> *</span>
00011 <span class="comment"> */</span>
00012 
00013 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00014 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
00015 <span class="preprocessor">#include &lt;stdlib.h&gt;</span> 
00016 <span class="preprocessor">#include &lt;string.h&gt;</span> 
00017 
00018 <span class="preprocessor">#include &lt;sys/errno.h&gt;</span>
00019 <span class="preprocessor">#include &lt;sys/param.h&gt;</span>
00020 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
00021 
00022 <span class="preprocessor">#include &lt;sys/socket.h&gt;</span>
00023 <span class="preprocessor">#include &lt;netdb.h&gt;</span>
00024 <span class="preprocessor">#include &lt;netinet/in.h&gt;</span>
00025 <span class="preprocessor">#include &lt;netinet/tcp.h&gt;</span>
00026 
00027 <span class="preprocessor">#include "rpc/rpc.h"</span>
00028 <span class="preprocessor">#include "rpc/auth_gss.h"</span>
00029 <span class="preprocessor">#include "rpc/pmap_clnt.h"</span> 
00030 <span class="preprocessor">#include &lt;gssapi/gssapi.h&gt;</span>
00031 
<a name="l00032"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a0">00032</a> <span class="preprocessor">#define LOGFILE_DEFAUT    "./toto-server.log"</span>
<a name="l00033"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a1">00033</a> <span class="preprocessor"></span><span class="preprocessor">#define TraduireAdresse( adresse, dest )                   \</span>
00034 <span class="preprocessor">           sprintf( dest, "%d.%d.%d.%d",                   \</span>
00035 <span class="preprocessor">                  ( ntohl( adresse ) &amp; 0xFF000000 ) &gt;&gt; 24, \</span>
00036 <span class="preprocessor">                  ( ntohl( adresse ) &amp; 0x00FF0000 ) &gt;&gt; 16, \</span>
00037 <span class="preprocessor">                  ( ntohl( adresse ) &amp; 0x0000FF00 ) &gt;&gt; 8,  \</span>
00038 <span class="preprocessor">                  ( ntohl( adresse ) &amp; 0x000000FF ) )</span>
<a name="l00039"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a2">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define TIMEOUT_SEC 25 </span>
<a name="l00040"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a3">00040</a> <span class="preprocessor"></span><span class="preprocessor">#define DEFAULT_RPC_SERVICE 300400 </span>
<a name="l00041"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a4">00041</a> <span class="preprocessor"></span><span class="preprocessor">#define RECV_SIZE 2048</span>
<a name="l00042"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a5">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define SEND_SIZE 2048</span>
<a name="l00043"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a6">00043</a> <span class="preprocessor"></span><span class="preprocessor">#define V1 1 </span>
<a name="l00044"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a7">00044</a> <span class="preprocessor"></span><span class="preprocessor">#define PROC_NULL  0 </span>
<a name="l00045"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a8">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define PROC_PLUS1 1</span>
00046 <span class="preprocessor"></span>
<a name="l00047"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a9">00047</a> <span class="preprocessor">#define DEFAULT_MECHANISM "kerberos_v5"</span>
<a name="l00048"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a10">00048</a> <span class="preprocessor"></span><span class="preprocessor">#define DEFAULT_PRINCIPAL "toto@trekking.bruyeres.s"</span>
00049 <span class="preprocessor"></span>
00050 <span class="comment">/* les options pour getopt */</span>
<a name="l00051"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a12">00051</a> <span class="keywordtype">char</span> <a class="code" href="client-gss_8c.html#a14">options</a>[] = <span class="stringliteral">"hL:N:s:S:M:"</span> ;
00052 
00053 <span class="comment">/* L'aide en ligne */</span>
<a name="l00054"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a13">00054</a> <span class="keywordtype">char</span> <a class="code" href="client-gss_8c.html#a15">utilisation</a>[] = 
00055 <span class="stringliteral">"Utilisation: %s [-hLs] \n"</span>
00056 <span class="stringliteral">"\t[-h]                   affiche cet aide en ligne\n"</span>
00057 <span class="stringliteral">"\t[-L &lt;logfile&gt;]         indique le fichier de log\n"</span>
00058 <span class="stringliteral">"\t[-N &lt;NivDebug&gt;]        indique le niveau de debug pour les journaux\n"</span> 
00059 <span class="stringliteral">"\t[-s &lt;service RPC&gt;]     indique le port ou le service a utiliser\n"</span> 
00060 <span class="stringliteral">"\t[-S &lt;service auth&gt;]    indique le principal a utiliser\n"</span>
00061 <span class="stringliteral">"\t[-M &lt;mechanism&gt;]       indique le mecanisme a utiliser\n"</span> ;
00062 
00063 <span class="comment">/* Des variables globales (en general ecrites une seule fois, relues plusieurs) */</span>
00064 <span class="keyword">static</span> <span class="keywordtype">char</span> logfile_name[MAXPATHLEN] ;    <span class="comment">/* Le chemin du fichier de log           */</span>
<a name="l00065"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a15">00065</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="onc__rpc__server_8c.html#a12">rpc_service_num</a> = DEFAULT_RPC_SERVICE ;
00066 
00067 <span class="keyword">struct </span><a class="code" href="structSvc__rpc__gss__data.html">Svc_rpc_gss_data</a> {
<a name="l00068"></a><a class="code" href="structSvc__rpc__gss__data.html#o0">00068</a>         bool_t                          established;    <span class="comment">/* context established  */</span>
<a name="l00069"></a><a class="code" href="structSvc__rpc__gss__data.html#o1">00069</a>         gss_ctx_id_t                ctx;                      <span class="comment">/* context id           */</span>
<a name="l00070"></a><a class="code" href="structSvc__rpc__gss__data.html#o9">00070</a>         <span class="keyword">struct </span>rpc_gss_sec      sec;                  <span class="comment">/* security triple      */</span>
<a name="l00071"></a><a class="code" href="structSvc__rpc__gss__data.html#o3">00071</a>         gss_buffer_desc           cname;                    <span class="comment">/* GSS client name      */</span>
<a name="l00072"></a><a class="code" href="structSvc__rpc__gss__data.html#o4">00072</a>         u_int                             seq;                <span class="comment">/* sequence number      */</span>
<a name="l00073"></a><a class="code" href="structSvc__rpc__gss__data.html#o5">00073</a>         u_int                             win;                <span class="comment">/* sequence window      */</span>
<a name="l00074"></a><a class="code" href="structSvc__rpc__gss__data.html#o6">00074</a>         u_int                             seqlast;      <span class="comment">/* last sequence number */</span>
<a name="l00075"></a><a class="code" href="structSvc__rpc__gss__data.html#o7">00075</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>          seqmask;      <span class="comment">/* bitmask of seqnums   */</span>
<a name="l00076"></a><a class="code" href="structSvc__rpc__gss__data.html#o8">00076</a>         gss_name_t                    client_name;      <span class="comment">/* unparsed name string */</span>
00077 };
00078 
<a name="l00079"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a11">00079</a> <span class="preprocessor">#define SVCAUTH_PRIVATE(auth) \</span>
00080 <span class="preprocessor">        ((struct svc_rpc_gss_data *)(auth)-&gt;svc_ah_private)</span>
00081 <span class="preprocessor"></span>
<a name="l00082"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a16">00082</a> <span class="keywordtype">void</span> <a class="code" href="rpcsec__gss__server_8natif_8c.html#a16">rpc_log_status</a>( <span class="keywordtype">char</span> *m, OM_uint32 maj_stat, OM_uint32 min_stat)
00083 {
00084         OM_uint32 min;
00085         gss_buffer_desc msg;
00086         <span class="keywordtype">int</span> msg_ctx = 0;
00087         FILE * tmplog ;
00088 
00089         fprintf(stderr, <span class="stringliteral">"Rpcsec_gss: %s: "</span>, m);
00090 
00091         gss_display_status(&amp;min, maj_stat, GSS_C_GSS_CODE, GSS_C_NULL_OID,
00092                            &amp;msg_ctx, &amp;msg);
00093         fprintf(stderr, <span class="stringliteral">"%s - "</span>, (<span class="keywordtype">char</span> *)msg.value);
00094         gss_release_buffer(&amp;min, &amp;msg);
00095 
00096         gss_display_status(&amp;min, min_stat, GSS_C_MECH_CODE, GSS_C_NULL_OID, &amp;msg_ctx, &amp;msg);
00097         fprintf(stderr, <span class="stringliteral">"%s\n"</span>, (<span class="keywordtype">char</span> *)msg.value);
00098         gss_release_buffer(&amp;min, &amp;msg);
00099 }
00100 
<a name="l00101"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a17">00101</a> <span class="keywordtype">void</span> <a class="code" href="rpcsec__gss__server_8natif_8c.html#a17">dispatch</a>( <span class="keyword">struct</span> svc_req * ptr_req, SVCXPRT * ptr_svc )
00102 {
00103   <span class="keywordtype">int</span> val ;
00104   <span class="keyword">struct </span>rpc_gss_cred     * gc = NULL ;
00105   <span class="keyword">struct </span>svc_rpc_gss_data * gd = NULL ;
00106   gss_buffer_desc           mechname;
00107   gss_buffer_desc           clientname ;
00108   OM_uint32                 maj_stat = 0 ;
00109   OM_uint32                 min_stat = 0 ;
00110 
00111   printf( <span class="stringliteral">"For this cal, authentication type %u is used\n"</span>, ptr_req-&gt;rq_cred.oa_flavor ) ;
00112 
00113   <span class="keywordflow">switch</span>( ptr_req-&gt;rq_proc )
00114     {
00115     <span class="keywordflow">case</span> <a class="code" href="onc__rpc__client_8c.html#a6">PROC_NULL</a>:
00116        printf( <span class="stringliteral">"Appel a PROC_NULL\n"</span> ) ;
00117 
00118       <span class="keywordflow">if</span>( svc_getargs( ptr_svc, xdr_void, NULL ) == FALSE )
00119         svcerr_decode( ptr_svc ) ;
00120       <span class="keywordflow">if</span>( svc_sendreply( ptr_svc, xdr_void, NULL ) == FALSE )
00121         svcerr_decode( ptr_svc ) ;
00122       break ;
00123       
00124     <span class="keywordflow">case</span> <a class="code" href="onc__rpc__client_8c.html#a7">PROC_PLUS1</a>:
00125       printf(  <span class="stringliteral">"Appel a PROC_PLUS1\n"</span> ) ;
00126      
00127       <span class="keywordflow">if</span>( ptr_req-&gt;rq_cred.oa_flavor != RPCSEC_GSS )
00128         {
00129           <span class="comment">/* On n'a pas l'authentification qu'il faut, on degage de la */</span>
00130           <a class="code" href="Svc_8c.html#a19">Svcerr_weakauth</a>( ptr_svc ) ;
00131           break ;
00132         }
00133 
00134       gc = ptr_req-&gt;rq_clntcred;
00135       gd = <a class="code" href="rpcsec__gss__server_8c.html#a11">SVCAUTH_PRIVATE</a>(ptr_req-&gt;rq_xprt-&gt;xp_auth);
00136 
00137       maj_stat = gss_display_name(&amp;min_stat, 
00138                                   gd-&gt;client_name, 
00139                                   &amp;clientname, 
00140                                   &amp;gd-&gt;sec.mech);
00141       <a class="code" href="rpcsec__gss__server_8natif_8c.html#a16">rpc_log_status</a>( <span class="stringliteral">"gss_display_name (clientname) "</span>, maj_stat, min_stat ) ; 
00142       printf( <span class="stringliteral">"    le client est %s\n"</span>, clientname.value ) ;
00143 
00144       maj_stat = gss_oid_to_str(&amp;min_stat, 
00145                                 gd-&gt;sec.mech, 
00146                                 &amp;mechname);
00147       <a class="code" href="rpcsec__gss__server_8natif_8c.html#a16">rpc_log_status</a>( <span class="stringliteral">"gss_oid_to_str"</span>, maj_stat, min_stat ) ; 
00148       printf( <span class="stringliteral">"    OID = %s\n"</span>, mechname.value ) ;
00149 
00150       printf( <span class="stringliteral">"    KRB5OID =1.2.840.113554.1.2.2\n"</span> ) ;
00151 
00152       printf( <span class="stringliteral">"    RPCSEC_GSS Service is %u   RPCSEC_GSS_SVC_NONE=%u RPCSEC_GSS_SVC_INTEGRITY=%u RPCSEC_GSS_SVC_PRIVACY=%u\n"</span>, 
00153              gc-&gt;gc_svc, RPCSEC_GSS_SVC_NONE, RPCSEC_GSS_SVC_INTEGRITY, RPCSEC_GSS_SVC_PRIVACY ) ;
00154 
00155       
00156 
00157       <span class="comment">/* Le client est un gentil, on le laisse travailler */</span>
00158       <span class="keywordflow">if</span>( svc_getargs( ptr_svc, xdr_int, (<span class="keywordtype">char</span> *)&amp;val ) == FALSE )
00159         svcerr_decode( ptr_svc ) ;
00160       
00161       printf( <span class="stringliteral">"Valeur recue = %d\n"</span>, val ) ;
00162 
00163       val = val + 1 ;  <span class="comment">/* Ce que fait cette fonction est spectaculaire ... :-)))) */</span>
00164       
00165       <span class="keywordflow">if</span>( svc_sendreply( ptr_svc, xdr_int, (<span class="keywordtype">char</span> *)&amp;val ) == FALSE )
00166         svcerr_decode( ptr_svc ) ;
00167       
00168       break ;
00169     }
00170   
00171 } <span class="comment">/* dispatch */</span>
00172 
<a name="l00173"></a><a class="code" href="rpcsec__gss__server_8natif_8c.html#a18">00173</a> <a class="code" href="server-gss_8c.html#a35">main</a>( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> * argv[] )
00174 {
00175   <span class="keywordtype">char</span>               nom_exec[MAXPATHLEN] ;
00176   <span class="keywordtype">char</span> *             tempo_nom_exec  = NULL ;
00177   <span class="keyword">struct </span>rpcent *    etc_rpc ;               <span class="comment">/* pour consulter /etc/rpc ou rpc.bynumber */</span>
00178   <span class="keywordtype">int</span>                c ;                     <span class="comment">/* pour getopt                  */</span>
00179   <span class="keyword">static</span> <span class="keywordtype">char</span>        machine_locale[256] ;
00180   SVCXPRT *          ptr_svc ;
00181   <span class="keywordtype">int</span>                rc ;
00182 
00183   <span class="keywordtype">char</span> principal[1024] ;
00184   <span class="keywordtype">char</span> mechanism[1024] ;
00185 
00186   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> req_time = 10000 ;
00187   u_int lo, hi ;
00188   
00189   bool_t ret ;
00190  
00191   <span class="comment">/* Initialisation des valeurs par defaut */</span>
00192   strcpy( logfile_name, <a class="code" href="onc__rpc__server_8c.html#a0">LOGFILE_DEFAUT</a> ) ;
00193   strcpy( principal, <a class="code" href="rpcsec__gss__client_8c.html#a9">DEFAULT_PRINCIPAL</a> ) ;
00194   strcpy( mechanism, <a class="code" href="rpcsec__gss__client_8c.html#a8">DEFAULT_MECHANISM</a> ) ;
00195   
00196   <span class="comment">/* On recupere le nom de l'executable */</span>
00197   <span class="keywordflow">if</span>( ( tempo_nom_exec = strrchr( argv[0], <span class="charliteral">'/'</span> ) ) != NULL )
00198     strcpy( (<span class="keywordtype">char</span> *)nom_exec, tempo_nom_exec + 1 ) ;
00199   
00200   <span class="keywordflow">while</span>( ( c = getopt( argc, argv, <a class="code" href="client-gss_8c.html#a14">options</a> ) ) != EOF )
00201     {
00202       <span class="keywordflow">switch</span>( c ) 
00203         {
00204         <span class="keywordflow">case</span> <span class="charliteral">'s'</span>:
00205           <span class="comment">/* Un nom ou un numero de service a ete indique */</span>
00206           <span class="keywordflow">if</span>( isalpha( (<span class="keywordtype">int</span>)*optarg ) )
00207             {
00208               <span class="comment">/* Ca commence pas par un chiffre donc c'est un nom service */</span>
00209               <span class="keywordflow">if</span>( ( etc_rpc = getrpcbyname( optarg ) ) == NULL )
00210                 {
00211                   fprintf( stderr, <span class="stringliteral">"Impossible de resoudre le service %s\n"</span>, optarg ) ;
00212                 }
00213               <span class="keywordflow">else</span>
00214                 {
00215                   <a class="code" href="onc__rpc__server_8c.html#a12">rpc_service_num</a> = etc_rpc-&gt;r_number ;
00216                 }
00217             }
00218           <span class="keywordflow">else</span>
00219             {
00220               <span class="comment">/* C'est un numero de service qui est indique */</span>
00221               <a class="code" href="onc__rpc__server_8c.html#a12">rpc_service_num</a> = atoi( optarg ) ;
00222             }
00223           break ;
00224 
00225         <span class="keywordflow">case</span> <span class="charliteral">'S'</span>:
00226           <span class="comment">/* On positionne le service */</span>
00227           strcpy( principal, optarg ) ;
00228           break ;
00229 
00230         <span class="keywordflow">case</span> <span class="charliteral">'M'</span>:
00231           <span class="comment">/* On positionne le mecanisme */</span>
00232           strcpy( mechanism, optarg ) ;
00233           break ;
00234           
00235         <span class="keywordflow">case</span> <span class="charliteral">'L'</span>:
00236            printf( <span class="stringliteral">"Option -L unsupported for now\n"</span> ) ;
00237            break ;
00238 
00239         <span class="keywordflow">case</span> <span class="charliteral">'N'</span>:
00240            printf( <span class="stringliteral">"Option -N unsupported for now\n"</span> ) ;
00241            break ;
00242 
00243         <span class="keywordflow">case</span> <span class="charliteral">'?'</span>:
00244         <span class="keywordflow">case</span> <span class="charliteral">'h'</span>:
00245         <span class="keywordflow">default</span>:
00246           <span class="comment">/* Cette option affiche l'aide en ligne */</span>
00247           printf( <span class="stringliteral">"Unknown option %c\n"</span>, c ) ;
00248           printf( <a class="code" href="client-gss_8c.html#a15">utilisation</a>, argv[0] ) ;
00249           exit( 0 ) ;
00250           break ;
00251         }
00252     }
00253 
00254   <span class="keywordflow">if</span>( argc != optind )
00255     {
00256       fprintf( stderr, <a class="code" href="client-gss_8c.html#a15">utilisation</a>, nom_exec ) ;
00257       fprintf( stderr, <span class="stringliteral">"Pas d'argument additionnel\n"</span> ) ;
00258       exit( 1 ) ;
00259     }
00260   
00261   <span class="comment">/* Obtention du nom de la machine */</span>
00262   <span class="keywordflow">if</span>( gethostname( machine_locale, <span class="keyword">sizeof</span>( machine_locale ) ) != 0 )
00263     {
00264       printf( <span class="stringliteral">"gethostbyname impossible: errno=%d, h_errno=%d\n"</span>, errno, h_errno ) ;
00265       exit( 1 ) ;
00266     }
00267  
00268   <span class="comment">/* Petit coucou initial */</span>
00269   printf( <span class="stringliteral">"Demarrage du serveur toto-server-rpc\n"</span> ) ;
00270   printf( <span class="stringliteral">"Le nom de la machine est %s\n"</span>, machine_locale ) ;
00271   printf( <span class="stringliteral">"J'utilise le service RPC %d\n"</span>, <a class="code" href="onc__rpc__server_8c.html#a12">rpc_service_num</a> ) ;
00272   printf( <span class="stringliteral">"Utilisation du principal %s sur le mecanisme %s\n"</span>, principal, mechanism ) ; 
00273 
00274   <span class="comment">/* Creation du handler SVC */</span>
00275   <span class="keywordflow">if</span>( ( ptr_svc = svctcp_create( RPC_ANYSOCK, <a class="code" href="onc__rpc__client_8c.html#a4">SEND_SIZE</a> , <a class="code" href="onc__rpc__client_8c.html#a3">RECV_SIZE</a> ) ) == NULL )
00276     {
00277       printf( <span class="stringliteral">"svctcp_create impossible\n"</span> ) ;
00278       exit( 1 ) ;
00279     }
00280   
00281   <span class="comment">/* Si un enregistrement au portmapper avait eu lieu, je le latte */</span>
00282   pmap_unset( <a class="code" href="onc__rpc__server_8c.html#a12">rpc_service_num</a>, <a class="code" href="onc__rpc__client_8c.html#a5">V1</a> ) ;
00283 
00284   <span class="comment">/* Creation des ressources pour la GSSAPI au travers de RPCSEC_GSS */</span>
00285   <span class="keywordflow">if</span>( ( ret = svcauth_gss_import_name( principal ) ) != TRUE )
00286     {
00287       printf( <span class="stringliteral">"Erreur dans svcauth_gss_import_name\n"</span> ) ;
00288       exit( 1 ) ;
00289     }
00290   
00291   
00292    <span class="comment">/* Enregistrement du service */</span>
00293   printf( <span class="stringliteral">"Enregistrement sur le service %d\n"</span>, <a class="code" href="onc__rpc__server_8c.html#a12">rpc_service_num</a> ) ;
00294   <span class="keywordflow">if</span>( svc_register( ptr_svc, <a class="code" href="onc__rpc__server_8c.html#a12">rpc_service_num</a>, <a class="code" href="onc__rpc__client_8c.html#a5">V1</a>, <a class="code" href="onc__rpc__server_8c.html#a13">dispatch</a>, IPPROTO_TCP ) == FALSE )
00295     {
00296       printf( <span class="stringliteral">"svc_register impossible\n"</span> ) ;
00297       exit( 1 ) ;
00298     }
00299 
00300   printf( <span class="stringliteral">"------------------\n"</span> ) ;
00301 
00302   <span class="comment">/* Silence, on tourne .... */</span>
00303   svc_run() ;
00304 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Dec 22 14:15:35 2006 for RPCSEC_GSS Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
