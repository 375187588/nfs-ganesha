<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>File System Abstraction Layer (HPSS) library: fsal_strings.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>fsal_strings.c</h1><a href="fsal__strings_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> * vim:expandtab:shiftwidth=8:tabstop=8:</span>
00003 <span class="comment"> */</span>
00004 
00012 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
00013 <span class="preprocessor"></span><span class="preprocessor">#include "config.h"</span>
00014 <span class="preprocessor">#endif</span>
00015 <span class="preprocessor"></span>
00016 <span class="preprocessor">#include "fsal.h"</span>
00017 <span class="preprocessor">#include "fsal_internal.h"</span>
00018 <span class="preprocessor">#include &lt;string.h&gt;</span>
00019 
00020 
00021 
<a name="l00046"></a><a class="code" href="group__FSALNameFunctions.html#ga0">00046</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga0">FSAL_str2name</a>(
00047       <span class="keyword">const</span> <span class="keywordtype">char</span>     * string ,        <span class="comment">/* IN */</span>
00048       fsal_mdsize_t  in_str_maxlen ,   <span class="comment">/* IN */</span>
00049       fsal_name_t    * name            <span class="comment">/* OUT */</span>
00050     ){
00051     
00052   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
00053   <span class="keywordtype">char</span> * output;
00054 
00055   <span class="comment">/* sanity checks */</span>
00056   <span class="keywordflow">if</span> (!name || !string ) ReturnCode( ERR_FSAL_FAULT ,0 );
00057 
00058   output = (*name).name;
00059   
00060   <span class="comment">/* computes input strlen */</span>
00061   <span class="keywordflow">for</span> (i=0;(i&lt;in_str_maxlen) &amp;&amp; (string[i] != <span class="charliteral">'\0'</span>);i++);
00062   
00063   <span class="comment">/* the value of i doesn't include terminating '\0',</span>
00064 <span class="comment">   * thus, FSAL_MAX_NAME_LEN is excluded.</span>
00065 <span class="comment">   */</span>
00066   <span class="keywordflow">if</span> (i &gt;= FSAL_MAX_NAME_LEN ) ReturnCode( ERR_FSAL_NAMETOOLONG ,0 );
00067   
00068   (*name).len=i;
00069 
00070   <span class="comment">/* copies the string */</span>
00071   <span class="keywordflow">for</span> (i=0;i&lt;(*name).len;i++){ output[i] = string[i]; }
00072   <span class="comment">/* sets the terminating \0 */</span>
00073   output[i]=<span class="charliteral">'\0'</span>;
00074   
00075   ReturnCode( ERR_FSAL_NO_ERROR , 0 ) ;
00076     
00077 }
00078 
00079 
<a name="l00096"></a><a class="code" href="group__FSALNameFunctions.html#ga1">00096</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga1">FSAL_str2path</a>(
00097       <span class="keywordtype">char</span>           * string ,        <span class="comment">/* IN */</span>
00098       fsal_mdsize_t  in_str_maxlen ,   <span class="comment">/* IN */</span>
00099       fsal_path_t    * p_path            <span class="comment">/* OUT */</span>
00100     ){
00101     
00102   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
00103   <span class="keywordtype">char</span> * output;
00104 
00105   <span class="comment">/* sanity checks */</span>
00106   <span class="keywordflow">if</span> (!p_path || !string ) ReturnCode( ERR_FSAL_FAULT ,0);
00107 
00108   output = p_path-&gt;path;
00109   
00110   <span class="comment">/* computes input strlen */</span>
00111   <span class="keywordflow">for</span> (i=0;(i&lt;in_str_maxlen) &amp;&amp; (string[i] != <span class="charliteral">'\0'</span>);i++);
00112   
00113   <span class="comment">/* the value of i doesn't include terminating '\0',</span>
00114 <span class="comment">   * thus, FSAL_MAX_PATH_LEN is excluded.</span>
00115 <span class="comment">   */</span>
00116   <span class="keywordflow">if</span> (i &gt;= FSAL_MAX_PATH_LEN ) ReturnCode( ERR_FSAL_NAMETOOLONG ,0);
00117   
00118   p_path-&gt;len=i;
00119   
00120   <span class="comment">/* copies the string */</span>
00121   <span class="keywordflow">for</span> (i=0;i&lt;p_path-&gt;len;i++){ output[i] = string[i]; }
00122   <span class="comment">/* sets the terminating \0 */</span>
00123   output[i]=<span class="charliteral">'\0'</span>;
00124   
00125   ReturnCode( ERR_FSAL_NO_ERROR , 0 );
00126     
00127 }
00128 
00129 
<a name="l00146"></a><a class="code" href="group__FSALNameFunctions.html#ga2">00146</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga2">FSAL_name2str</a>(
00147       fsal_name_t * p_name,              <span class="comment">/* IN */</span>
00148       <span class="keywordtype">char</span>        * string ,         <span class="comment">/* OUT */</span>
00149       fsal_mdsize_t  out_str_maxlen   <span class="comment">/* IN */</span>
00150     ){
00151     
00152     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
00153     <span class="keywordtype">char</span> * input;
00154     
00155     <span class="comment">/* sanity checks */</span>
00156     <span class="keywordflow">if</span> (!string || !p_name ) ReturnCode( ERR_FSAL_FAULT ,0);
00157     
00158     input = p_name-&gt;name;
00159     
00160     i = p_name-&gt;len;
00161     
00162     <span class="comment">/* the value of i doesn't include terminating '\0',</span>
00163 <span class="comment">     * thus, last value is excluded.</span>
00164 <span class="comment">     */</span>
00165     <span class="keywordflow">if</span> (i &gt;= out_str_maxlen )
00166       ReturnCode( ERR_FSAL_TOOSMALL ,0);
00167     
00168     <span class="comment">/* copies the value */</span>
00169     strncpy( string, input, out_str_maxlen );    
00170     
00171     ReturnCode( ERR_FSAL_NO_ERROR , 0 );
00172 }
00173 
00174 
<a name="l00191"></a><a class="code" href="group__FSALNameFunctions.html#ga3">00191</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga3">FSAL_path2str</a>(
00192       fsal_path_t * p_path,          <span class="comment">/* IN */</span>
00193       <span class="keywordtype">char</span>        * string ,         <span class="comment">/* OUT */</span>
00194       fsal_mdsize_t  out_str_maxlen   <span class="comment">/* IN */</span>
00195     ){
00196     
00197     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
00198     <span class="keywordtype">char</span> * input;        
00199     
00200     <span class="comment">/* sanity checks */</span>
00201     <span class="keywordflow">if</span> (!string || !p_path) ReturnCode( ERR_FSAL_FAULT ,0);
00202     
00203     input = p_path-&gt;path;
00204     
00205     i = p_path-&gt;len;
00206     
00207     <span class="comment">/* the value of i doesn't include terminating '\0',</span>
00208 <span class="comment">     * thus, last value is excluded.</span>
00209 <span class="comment">     */</span>
00210     <span class="keywordflow">if</span> (i &gt;= out_str_maxlen )
00211       ReturnCode( ERR_FSAL_TOOSMALL ,0);
00212     
00213     <span class="comment">/* copies the value */</span>
00214     strncpy( string, input, out_str_maxlen );    
00215     
00216     ReturnCode( ERR_FSAL_NO_ERROR , 0 );
00217 }
00218 
00219 
<a name="l00226"></a><a class="code" href="group__FSALNameFunctions.html#ga4">00226</a> <span class="keywordtype">int</span> <a class="code" href="group__FSALNameFunctions.html#ga4">FSAL_namecmp</a>( fsal_name_t * p_name1, fsal_name_t * p_name2 ){
00227   
00228   <span class="keywordflow">return</span> (strncmp( p_name1-&gt;name , p_name2-&gt;name , FSAL_MAX_NAME_LEN ));
00229   
00230 }
00231 
00232 
<a name="l00239"></a><a class="code" href="group__FSALNameFunctions.html#ga5">00239</a> <span class="keywordtype">int</span> <a class="code" href="group__FSALNameFunctions.html#ga5">FSAL_pathcmp</a>( fsal_path_t * p_path1, fsal_path_t * p_path2 ){
00240   
00241   <span class="keywordflow">return</span> (strncmp( p_path1-&gt;path , p_path2-&gt;path , FSAL_MAX_PATH_LEN ));    
00242   
00243 }
00244 
00245 
<a name="l00254"></a><a class="code" href="group__FSALNameFunctions.html#ga6">00254</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga6">FSAL_namecpy</a>( fsal_name_t * p_tgt_name, fsal_name_t * p_src_name ){
00255   
00256     <span class="keywordtype">char</span> * output;
00257     
00258     <span class="comment">/* sanity check */</span>
00259     <span class="keywordflow">if</span> (!p_tgt_name || !p_src_name) ReturnCode( ERR_FSAL_FAULT ,0);
00260     
00261     output = p_tgt_name-&gt;name;
00262     
00263     <span class="comment">/* copy */</span>
00264     strncpy(output, p_src_name-&gt;name,FSAL_MAX_NAME_LEN);
00265     
00266     p_tgt_name-&gt;len = p_src_name-&gt;len;
00267     
00268     ReturnCode(ERR_FSAL_NO_ERROR,0);
00269     
00270 }
00271 
00272 
<a name="l00281"></a><a class="code" href="group__FSALNameFunctions.html#ga7">00281</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga7">FSAL_pathcpy</a>( fsal_path_t * p_tgt_path, fsal_path_t * p_src_path ){
00282   
00283     <span class="keywordtype">char</span> * output;
00284     
00285     <span class="comment">/* sanity check */</span>
00286     <span class="keywordflow">if</span> (!p_tgt_path || !p_src_path) ReturnCode( ERR_FSAL_FAULT ,0);
00287     
00288     output = p_tgt_path-&gt;path;
00289     
00290     <span class="comment">/* copy */</span>
00291     strncpy(output, p_src_path-&gt;path,FSAL_MAX_PATH_LEN);
00292     
00293     p_tgt_path-&gt;len = p_src_path-&gt;len;
00294     
00295     ReturnCode(ERR_FSAL_NO_ERROR,0);
00296     
00297 }
00298 
00299 
<a name="l00304"></a><a class="code" href="group__FSALNameFunctions.html#ga8">00304</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga8">FSAL_buffdesc2name</a>( fsal_buffdesc_t * in_buf,
00305                                   fsal_name_t * out_name ){
00306   
00307   <span class="keywordflow">if</span> (!in_buf || !out_name)
00308         ReturnCode( ERR_FSAL_FAULT ,0);
00309   
00310   <span class="keywordflow">return</span> <a class="code" href="group__FSALNameFunctions.html#ga0">FSAL_str2name</a>(in_buf-&gt;pointer,in_buf-&gt;len,out_name);
00311   
00312 }
00313   
00314 
<a name="l00319"></a><a class="code" href="group__FSALNameFunctions.html#ga9">00319</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga9">FSAL_buffdesc2path</a>(fsal_buffdesc_t * in_buf,fsal_path_t * out_path){
00320   
00321     <span class="keywordflow">if</span> (!in_buf || !out_path)
00322         ReturnCode( ERR_FSAL_FAULT ,0);
00323   
00324   <span class="keywordflow">return</span> <a class="code" href="group__FSALNameFunctions.html#ga1">FSAL_str2path</a>(in_buf-&gt;pointer,in_buf-&gt;len,out_path);
00325 
00326 }
00327 
00328 
00329 
<a name="l00344"></a><a class="code" href="group__FSALNameFunctions.html#ga10">00344</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga10">FSAL_path2buffdesc</a>(fsal_path_t * in_path, fsal_buffdesc_t * out_buff){
00345     
00346   <span class="keywordflow">if</span> (!out_buff || !in_path)
00347       ReturnCode( ERR_FSAL_FAULT ,0);
00348   
00349   out_buff-&gt;pointer = in_path-&gt;path;
00350   out_buff-&gt;len     = in_path-&gt;len;
00351   
00352   ReturnCode(ERR_FSAL_NO_ERROR,0);
00353   
00354 }
00355 
00356 
00357 
<a name="l00372"></a><a class="code" href="group__FSALNameFunctions.html#ga11">00372</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga11">FSAL_name2buffdesc</a>(fsal_name_t * in_name, fsal_buffdesc_t * out_buff){
00373     
00374   <span class="keywordflow">if</span> (!out_buff || !in_name)
00375       ReturnCode( ERR_FSAL_FAULT ,0);
00376   
00377   out_buff-&gt;pointer = in_name-&gt;name;
00378   out_buff-&gt;len     = in_name-&gt;len;
00379   
00380   ReturnCode(ERR_FSAL_NO_ERROR,0);
00381   
00382 }
00383 
00384 
00385 
00386 
00387 
00388 
00389 <span class="comment">/* @} */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 9 08:24:43 2008 for File System Abstraction Layer (HPSS) library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
