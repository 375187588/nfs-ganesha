\section{fsal\_\-lookup.c File Reference}
\label{fsal__lookup_8c}\index{fsal\_\-lookup.c@{fsal\_\-lookup.c}}


Lookup operations.  
{\ttfamily \#include \char`\"{}fsal.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}fsal\_\-internal.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}fsal\_\-convert.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}fsal\_\-common.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}HPSSclapiExt/hpssclapiext.h\char`\"{}}\par
{\ttfamily \#include $<$hpss\_\-errno.h$>$}\par
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
fsal\_\-status\_\-t {\bf HPSSFSAL\_\-lookup} (hpssfsal\_\-handle\_\-t $\ast$parent\_\-directory\_\-handle, fsal\_\-name\_\-t $\ast$p\_\-filename, hpssfsal\_\-op\_\-context\_\-t $\ast$p\_\-context, hpssfsal\_\-handle\_\-t $\ast$object\_\-handle, fsal\_\-attrib\_\-list\_\-t $\ast$object\_\-attributes)
\item 
fsal\_\-status\_\-t {\bf HPSSFSAL\_\-lookupJunction} (hpssfsal\_\-handle\_\-t $\ast$p\_\-junction\_\-handle, hpssfsal\_\-op\_\-context\_\-t $\ast$p\_\-context, hpssfsal\_\-handle\_\-t $\ast$p\_\-fsoot\_\-handle, fsal\_\-attrib\_\-list\_\-t $\ast$p\_\-fsroot\_\-attributes)
\item 
fsal\_\-status\_\-t {\bf HPSSFSAL\_\-lookupPath} (fsal\_\-path\_\-t $\ast$p\_\-path, hpssfsal\_\-op\_\-context\_\-t $\ast$p\_\-context, hpssfsal\_\-handle\_\-t $\ast$object\_\-handle, fsal\_\-attrib\_\-list\_\-t $\ast$object\_\-attributes)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Lookup operations. \begin{DoxyAuthor}{Author}

\end{DoxyAuthor}
Author}
leibovic \begin{DoxyDate}{Date}

\end{DoxyDate}
Date}
2006/02/08 12:46:59 \begin{DoxyVersion}{Version}

\end{DoxyVersion}
Revision}
1.18 

Definition in file {\bf fsal\_\-lookup.c}.

\subsection{Function Documentation}
\index{fsal\_\-lookup.c@{fsal\_\-lookup.c}!HPSSFSAL\_\-lookup@{HPSSFSAL\_\-lookup}}
\index{HPSSFSAL\_\-lookup@{HPSSFSAL\_\-lookup}!fsal_lookup.c@{fsal\_\-lookup.c}}
\subsubsection[{HPSSFSAL\_\-lookup}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t HPSSFSAL\_\-lookup (hpssfsal\_\-handle\_\-t $\ast$ {\em parent\_\-directory\_\-handle}, \/  fsal\_\-name\_\-t $\ast$ {\em p\_\-filename}, \/  hpssfsal\_\-op\_\-context\_\-t $\ast$ {\em p\_\-context}, \/  hpssfsal\_\-handle\_\-t $\ast$ {\em object\_\-handle}, \/  fsal\_\-attrib\_\-list\_\-t $\ast$ {\em object\_\-attributes})}\label{fsal__lookup_8c_a856f71db0b4714ff1d475dc9a6ce0eb5}
FSAL\_\-lookup : Looks up for an object into a directory.

Note : if parent handle and filename are NULL, this retrieves root's handle.


\begin{DoxyParams}{Parameters}
\item[{\em parent\_\-directory\_\-handle}](input) Handle of the parent directory to search the object in. \item[{\em filename}](input) The name of the object to find. \item[{\em p\_\-context}](input) Authentication context for the operation (user,...). \item[{\em object\_\-handle}](output) The handle of the object corresponding to filename. \item[{\em object\_\-attributes}](optional input/output) Pointer to the attributes of the object we found. As input, it defines the attributes that the caller wants to retrieve (by positioning flags into this structure) and the output is built considering this input (it fills the structure according to the flags it contains). It can be NULL (increases performances).\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Major error codes :
\begin{DoxyItemize}
\item ERR\_\-FSAL\_\-NO\_\-ERROR (no error)
\item ERR\_\-FSAL\_\-STALE (parent\_\-directory\_\-handle does not address an existing object)
\item ERR\_\-FSAL\_\-NOTDIR (parent\_\-directory\_\-handle does not address a directory)
\item ERR\_\-FSAL\_\-NOENT (the object designated by p\_\-filename does not exist)
\item ERR\_\-FSAL\_\-XDEV (tried to operate a lookup on a filesystem junction. Use FSAL\_\-lookupJunction instead)
\item ERR\_\-FSAL\_\-FAULT (a NULL pointer was passed as mandatory argument)
\item Other error codes can be returned : ERR\_\-FSAL\_\-ACCESS, ERR\_\-FSAL\_\-IO, ... 
\end{DoxyItemize}
\end{DoxyReturn}


/!$\backslash$ WARNING : When the directory handle is stale, HPSS returns ENOTDIR. Thus, in this case, we must double check by checking the directory handle.

Definition at line 60 of file fsal\_\-lookup.c.

References hpss2fsal\_\-attributes(), hpss2fsal\_\-error(), hpss2fsal\_\-type(), HPSSFSAL\_\-getattrs(), and TakeTokenFSCall().

Referenced by HPSSFSAL\_\-lookupPath(), HPSSFSAL\_\-open\_\-by\_\-name(), and HPSSFSAL\_\-unlink().\index{fsal\_\-lookup.c@{fsal\_\-lookup.c}!HPSSFSAL\_\-lookupJunction@{HPSSFSAL\_\-lookupJunction}}
\index{HPSSFSAL\_\-lookupJunction@{HPSSFSAL\_\-lookupJunction}!fsal_lookup.c@{fsal\_\-lookup.c}}
\subsubsection[{HPSSFSAL\_\-lookupJunction}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t HPSSFSAL\_\-lookupJunction (hpssfsal\_\-handle\_\-t $\ast$ {\em p\_\-junction\_\-handle}, \/  hpssfsal\_\-op\_\-context\_\-t $\ast$ {\em p\_\-context}, \/  hpssfsal\_\-handle\_\-t $\ast$ {\em p\_\-fsoot\_\-handle}, \/  fsal\_\-attrib\_\-list\_\-t $\ast$ {\em p\_\-fsroot\_\-attributes})}\label{fsal__lookup_8c_a5eda6b1eecfd01b292ba931c73e5f4d8}
FSAL\_\-lookupJunction : Get the fileset root for a junction.


\begin{DoxyParams}{Parameters}
\item[{\em p\_\-junction\_\-handle}](input) Handle of the junction to be looked up. \item[{\em cred}](input) Authentication context for the operation (user,...). \item[{\em p\_\-fsroot\_\-handle}](output) The handle of root directory of the fileset. \item[{\em p\_\-fsroot\_\-attributes}](optional input/output) Pointer to the attributes of the root directory for the fileset. As input, it defines the attributes that the caller wants to retrieve (by positioning flags into this structure) and the output is built considering this input (it fills the structure according to the flags it contains). It can be NULL (increases performances).\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Major error codes :
\begin{DoxyItemize}
\item ERR\_\-FSAL\_\-NO\_\-ERROR (no error)
\item ERR\_\-FSAL\_\-STALE (p\_\-junction\_\-handle does not address an existing object)
\item ERR\_\-FSAL\_\-FAULT (a NULL pointer was passed as mandatory argument)
\item Other error codes can be returned : ERR\_\-FSAL\_\-ACCESS, ERR\_\-FSAL\_\-IO, ... 
\end{DoxyItemize}
\end{DoxyReturn}


Definition at line 220 of file fsal\_\-lookup.c.

References hpss2fsal\_\-attributes(), hpss2fsal\_\-error(), hpss2fsal\_\-type(), and TakeTokenFSCall().

Referenced by HPSSFSAL\_\-lookupPath().\index{fsal\_\-lookup.c@{fsal\_\-lookup.c}!HPSSFSAL\_\-lookupPath@{HPSSFSAL\_\-lookupPath}}
\index{HPSSFSAL\_\-lookupPath@{HPSSFSAL\_\-lookupPath}!fsal_lookup.c@{fsal\_\-lookup.c}}
\subsubsection[{HPSSFSAL\_\-lookupPath}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t HPSSFSAL\_\-lookupPath (fsal\_\-path\_\-t $\ast$ {\em p\_\-path}, \/  hpssfsal\_\-op\_\-context\_\-t $\ast$ {\em p\_\-context}, \/  hpssfsal\_\-handle\_\-t $\ast$ {\em object\_\-handle}, \/  fsal\_\-attrib\_\-list\_\-t $\ast$ {\em object\_\-attributes})}\label{fsal__lookup_8c_a628bea09f8e29e449b342db17e91ccd7}
FSAL\_\-lookupPath : Looks up for an object into the namespace.

Note : if path equals \char`\"{}/\char`\"{}, this retrieves root's handle.


\begin{DoxyParams}{Parameters}
\item[{\em path}](input) The path of the object to find. \item[{\em p\_\-context}](input) Authentication context for the operation (user,...). \item[{\em object\_\-handle}](output) The handle of the object corresponding to filename. \item[{\em object\_\-attributes}](optional input/output) Pointer to the attributes of the object we found. As input, it defines the attributes that the caller wants to retrieve (by positioning flags into this structure) and the output is built considering this input (it fills the structure according to the flags it contains). It can be NULL (increases performances).\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Major error codes :
\begin{DoxyItemize}
\item ERR\_\-FSAL\_\-NO\_\-ERROR (no error)
\item ERR\_\-FSAL\_\-FAULT (a NULL pointer was passed as mandatory argument)
\item ERR\_\-FSAL\_\-INVAL (the path argument is not absolute)
\item ERR\_\-FSAL\_\-NOENT (an element in the path does not exist)
\item ERR\_\-FSAL\_\-NOTDIR (an element in the path is not a directory)
\item ERR\_\-FSAL\_\-XDEV (tried to cross a filesystem junction, whereas is has not been authorized in the server configuration -\/ FSAL::auth\_\-xdev\_\-export parameter)
\item Other error codes can be returned : ERR\_\-FSAL\_\-ACCESS, ERR\_\-FSAL\_\-IO, ... 
\end{DoxyItemize}
\end{DoxyReturn}


\begin{Desc}
\item[{\bf Todo}]: Be carefull about junction crossing, symlinks, hardlinks,... \end{Desc}


Definition at line 307 of file fsal\_\-lookup.c.

References HPSSFSAL\_\-lookup(), and HPSSFSAL\_\-lookupJunction().