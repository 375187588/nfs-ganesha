\section{fsal\_\-tools.c File Reference}
\label{fsal__tools_8c}\index{fsal\_\-tools.c@{fsal\_\-tools.c}}


miscelaneous FSAL tools.  
{\ttfamily \#include \char`\"{}fsal.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}fsal\_\-internal.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}fsal\_\-common.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}fsal\_\-convert.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}config\_\-parsing.h\char`\"{}}\par
{\ttfamily \#include $<$string.h$>$}\par
\subsection*{Defines}
\begin{DoxyCompactItemize}
\item 
\#define {\bfseries STRCMP}~strcasecmp\label{fsal__tools_8c_a1ffef5879101d778f17a377e0d8b0e00}

\item 
\#define {\bfseries TYPE\_\-UUIDT}~hpss\_\-uuid\_\-t\label{fsal__tools_8c_a0415c5edcfceb55c37efa38c2c6e2212}

\item 
\#define {\bfseries INTMACRO\_\-TO\_\-STR}(\_\-x)~\_\-DEREF(\_\-x)\label{fsal__tools_8c_add61491cf401fcb9733a455efc468350}

\item 
\#define {\bfseries \_\-DEREF}(\_\-x)~\#\_\-x\label{fsal__tools_8c_a565798781a048652bd416393d92c00fa}

\item 
\#define {\bfseries SMALL\_\-PRIME\_\-MULT}~3\label{fsal__tools_8c_a95706123588ac755c4ed3b5d78dcd72b}

\item 
\#define {\bfseries SMALL\_\-PRIME\_\-ADD}~1999\label{fsal__tools_8c_a8b2eea7185994e4333b75f02231a8d7b}

\item 
\#define {\bfseries HASH\_\-INCR}(\_\-h\_\-, \_\-i\_\-)~( \_\-h\_\- = (\_\-h\_\- $\ast$ SMALL\_\-PRIME\_\-MULT + SMALL\_\-PRIME\_\-ADD) \% \_\-i\_\- )\label{fsal__tools_8c_a3e856864aba497e6b22de127c7b7ad2b}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
char $\ast$ {\bfseries HPSSFSAL\_\-GetFSName} ()\label{fsal__tools_8c_abf1467108c1eeff951c562852dfa555a}

\item 
int {\bf HPSSFSAL\_\-handlecmp} (hpssfsal\_\-handle\_\-t $\ast$handle1, hpssfsal\_\-handle\_\-t $\ast$handle2, fsal\_\-status\_\-t $\ast$status)
\item 
unsigned int {\bf HPSSFSAL\_\-Handle\_\-to\_\-HashIndex} (hpssfsal\_\-handle\_\-t $\ast$p\_\-handle, unsigned int cookie, unsigned int alphabet\_\-len, unsigned int index\_\-size)
\item 
unsigned int {\bfseries HPSSFSAL\_\-Handle\_\-to\_\-RBTIndex} (hpssfsal\_\-handle\_\-t $\ast$p\_\-handle, unsigned int cookie)\label{fsal__tools_8c_a434ad46683fd99f396c1dcc731284f59}

\item 
fsal\_\-status\_\-t {\bf HPSSFSAL\_\-DigestHandle} (hpssfsal\_\-export\_\-context\_\-t $\ast$p\_\-expcontext, fsal\_\-digesttype\_\-t output\_\-type, hpssfsal\_\-handle\_\-t $\ast$in\_\-fsal\_\-handle, caddr\_\-t out\_\-buff)
\item 
fsal\_\-status\_\-t {\bf HPSSFSAL\_\-ExpandHandle} (hpssfsal\_\-export\_\-context\_\-t $\ast$p\_\-expcontext, fsal\_\-digesttype\_\-t in\_\-type, caddr\_\-t in\_\-buff, hpssfsal\_\-handle\_\-t $\ast$out\_\-fsal\_\-handle)
\item 
fsal\_\-status\_\-t {\bf HPSSFSAL\_\-SetDefault\_\-FSAL\_\-parameter} (fsal\_\-parameter\_\-t $\ast$out\_\-parameter)
\item 
fsal\_\-status\_\-t {\bfseries HPSSFSAL\_\-SetDefault\_\-FS\_\-common\_\-parameter} (fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_a97e96d7a40775228be47be8478c6246a}

\item 
fsal\_\-status\_\-t {\bfseries HPSSFSAL\_\-SetDefault\_\-FS\_\-specific\_\-parameter} (fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_add7ac93a4856e77de6f5fbef06162d89}

\item 
fsal\_\-status\_\-t {\bf HPSSFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf} (config\_\-file\_\-t in\_\-config, fsal\_\-parameter\_\-t $\ast$out\_\-parameter)
\item 
fsal\_\-status\_\-t {\bfseries HPSSFSAL\_\-load\_\-FS\_\-common\_\-parameter\_\-from\_\-conf} (config\_\-file\_\-t in\_\-config, fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_a0846ad9cd011036779827e5296cfd26d}

\item 
fsal\_\-status\_\-t {\bfseries HPSSFSAL\_\-load\_\-FS\_\-specific\_\-parameter\_\-from\_\-conf} (config\_\-file\_\-t in\_\-config, fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_a255e1485ce16b0a7a8d2b11ff6e5745e}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
miscelaneous FSAL tools. \begin{DoxyAuthor}{Author}

\end{DoxyAuthor}
Author}
leibovic \begin{DoxyDate}{Date}

\end{DoxyDate}
Date}
2006/02/09 12:16:07 \begin{DoxyVersion}{Version}

\end{DoxyVersion}
Revision}
1.28 

Definition in file {\bf fsal\_\-tools.c}.

\subsection{Function Documentation}
\index{fsal\_\-tools.c@{fsal\_\-tools.c}!HPSSFSAL\_\-DigestHandle@{HPSSFSAL\_\-DigestHandle}}
\index{HPSSFSAL\_\-DigestHandle@{HPSSFSAL\_\-DigestHandle}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{HPSSFSAL\_\-DigestHandle}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t HPSSFSAL\_\-DigestHandle (hpssfsal\_\-export\_\-context\_\-t $\ast$ {\em p\_\-expcontext}, \/  fsal\_\-digesttype\_\-t {\em output\_\-type}, \/  hpssfsal\_\-handle\_\-t $\ast$ {\em in\_\-fsal\_\-handle}, \/  caddr\_\-t {\em out\_\-buff})}\label{fsal__tools_8c_a4e208da0b69852c013bc9240f7218136}
FSAL\_\-DigestHandle : Convert an hpssfsal\_\-handle\_\-t to a buffer to be included into NFS handles, or another digest.


\begin{DoxyParams}{Parameters}
\item[{\em output\_\-type}](input): Indicates the type of digest to do. \item[{\em in\_\-fsal\_\-handle}](input): The handle to be converted to digest. \item[{\em out\_\-buff}](output): The buffer where the digest is to be stored.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The major code is ERR\_\-FSAL\_\-NO\_\-ERROR is no error occured. Else, it is a non null value. 
\end{DoxyReturn}


Definition at line 196 of file fsal\_\-tools.c.\index{fsal\_\-tools.c@{fsal\_\-tools.c}!HPSSFSAL\_\-ExpandHandle@{HPSSFSAL\_\-ExpandHandle}}
\index{HPSSFSAL\_\-ExpandHandle@{HPSSFSAL\_\-ExpandHandle}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{HPSSFSAL\_\-ExpandHandle}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t HPSSFSAL\_\-ExpandHandle (hpssfsal\_\-export\_\-context\_\-t $\ast$ {\em p\_\-expcontext}, \/  fsal\_\-digesttype\_\-t {\em in\_\-type}, \/  caddr\_\-t {\em in\_\-buff}, \/  hpssfsal\_\-handle\_\-t $\ast$ {\em out\_\-fsal\_\-handle})}\label{fsal__tools_8c_a6b14735ce5783b50545e322d4f0e7d5b}
FSAL\_\-ExpandHandle : Convert a buffer extracted from NFS handles to an FSAL handle.


\begin{DoxyParams}{Parameters}
\item[{\em in\_\-type}](input): Indicates the type of digest to be expanded. \item[{\em in\_\-buff}](input): Pointer to the digest to be expanded. \item[{\em out\_\-fsal\_\-handle}](output): The handle built from digest.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The major code is ERR\_\-FSAL\_\-NO\_\-ERROR is no error occured. Else, it is a non null value. 
\end{DoxyReturn}


Definition at line 439 of file fsal\_\-tools.c.

References hpss2fsal\_\-type().\index{fsal\_\-tools.c@{fsal\_\-tools.c}!HPSSFSAL\_\-Handle\_\-to\_\-HashIndex@{HPSSFSAL\_\-Handle\_\-to\_\-HashIndex}}
\index{HPSSFSAL\_\-Handle\_\-to\_\-HashIndex@{HPSSFSAL\_\-Handle\_\-to\_\-HashIndex}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{HPSSFSAL\_\-Handle\_\-to\_\-HashIndex}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int HPSSFSAL\_\-Handle\_\-to\_\-HashIndex (hpssfsal\_\-handle\_\-t $\ast$ {\em p\_\-handle}, \/  unsigned int {\em cookie}, \/  unsigned int {\em alphabet\_\-len}, \/  unsigned int {\em index\_\-size})}\label{fsal__tools_8c_aecd98c40de9892f07d7cfb5b4087cb36}
FSAL\_\-Handle\_\-to\_\-HashIndex This function is used for hashing a FSAL handle in order to dispatch entries into the hash table array.


\begin{DoxyParams}{Parameters}
\item[{\em p\_\-handle}]The handle to be hashed \item[{\em cookie}]Makes it possible to have different hash value for the same handle, when cookie changes. \item[{\em alphabet\_\-len}]Parameter for polynomial hashing algorithm \item[{\em index\_\-size}]The range of hash value will be [0..index\_\-size-\/1]\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The hash value 
\end{DoxyReturn}


Definition at line 104 of file fsal\_\-tools.c.\index{fsal\_\-tools.c@{fsal\_\-tools.c}!HPSSFSAL\_\-handlecmp@{HPSSFSAL\_\-handlecmp}}
\index{HPSSFSAL\_\-handlecmp@{HPSSFSAL\_\-handlecmp}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{HPSSFSAL\_\-handlecmp}]{\setlength{\rightskip}{0pt plus 5cm}int HPSSFSAL\_\-handlecmp (hpssfsal\_\-handle\_\-t $\ast$ {\em handle1}, \/  hpssfsal\_\-handle\_\-t $\ast$ {\em handle2}, \/  fsal\_\-status\_\-t $\ast$ {\em status})}\label{fsal__tools_8c_a3bc203e0551b743f34b8d612c218767f}
FSAL\_\-handlecmp: Compare 2 handles.


\begin{DoxyParams}{Parameters}
\item[{\em handle1}](input): The first handle to be compared. \item[{\em handle2}](input): The second handle to be compared. \item[{\em status}](output): The status of the compare operation.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/ 0 if handles are the same.
\begin{DoxyItemize}
\item A non null value else.
\item Segfault if status is a NULL pointer. 
\end{DoxyItemize}
\end{DoxyReturn}


Definition at line 59 of file fsal\_\-tools.c.\index{fsal\_\-tools.c@{fsal\_\-tools.c}!HPSSFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf@{HPSSFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf}}
\index{HPSSFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf@{HPSSFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{HPSSFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t HPSSFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf (config\_\-file\_\-t {\em in\_\-config}, \/  fsal\_\-parameter\_\-t $\ast$ {\em out\_\-parameter})}\label{fsal__tools_8c_acbfbfa7ebfd1a1925ba80f133aef995f}
FSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf, FSAL\_\-load\_\-FS\_\-common\_\-parameter\_\-from\_\-conf, FSAL\_\-load\_\-FS\_\-specific\_\-parameter\_\-from\_\-conf:

Those functions initialize the FSAL init parameter structure from a configuration structure.


\begin{DoxyParams}{Parameters}
\item[{\em in\_\-config}](input): Structure that represents the parsed configuration file. \item[{\em out\_\-parameter}](ouput) FSAL initialization structure filled according to the configuration file given as parameter.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
ERR\_\-FSAL\_\-NO\_\-ERROR (no error) , ERR\_\-FSAL\_\-NOENT (missing a mandatory stanza in config file), ERR\_\-FSAL\_\-INVAL (invalid parameter), ERR\_\-FSAL\_\-SERVERFAULT (unexpected error) ERR\_\-FSAL\_\-FAULT (null pointer given as parameter), 
\end{DoxyReturn}


Definition at line 616 of file fsal\_\-tools.c.\index{fsal\_\-tools.c@{fsal\_\-tools.c}!HPSSFSAL\_\-SetDefault\_\-FSAL\_\-parameter@{HPSSFSAL\_\-SetDefault\_\-FSAL\_\-parameter}}
\index{HPSSFSAL\_\-SetDefault\_\-FSAL\_\-parameter@{HPSSFSAL\_\-SetDefault\_\-FSAL\_\-parameter}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{HPSSFSAL\_\-SetDefault\_\-FSAL\_\-parameter}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t HPSSFSAL\_\-SetDefault\_\-FSAL\_\-parameter (fsal\_\-parameter\_\-t $\ast$ {\em out\_\-parameter})}\label{fsal__tools_8c_a6ff6a1e88484ad34aa9047e4cf2e7aac}
Those routines set the default parameters for FSAL init structure. \begin{DoxyReturn}{Returns}
ERR\_\-FSAL\_\-NO\_\-ERROR (no error) , ERR\_\-FSAL\_\-FAULT (null pointer given as parameter), ERR\_\-FSAL\_\-SERVERFAULT (unexpected error) 
\end{DoxyReturn}


Definition at line 507 of file fsal\_\-tools.c.