\section{fsal\_\-tools.c File Reference}
\label{fsal__tools_8c}\index{fsal\_\-tools.c@{fsal\_\-tools.c}}
miscelaneous FSAL tools.  


{\tt \#include \char`\"{}fsal.h\char`\"{}}\par
{\tt \#include \char`\"{}fsal\_\-internal.h\char`\"{}}\par
{\tt \#include \char`\"{}fsal\_\-common.h\char`\"{}}\par
{\tt \#include \char`\"{}fsal\_\-convert.h\char`\"{}}\par
{\tt \#include \char`\"{}config\_\-parsing.h\char`\"{}}\par
{\tt \#include $<$string.h$>$}\par
\subsection*{Defines}
\begin{CompactItemize}
\item 
\#define \textbf{STRCMP}~strcasecmp\label{fsal__tools_8c_1ffef5879101d778f17a377e0d8b0e00}

\item 
\#define \textbf{SMALL\_\-PRIME\_\-MULT}~3\label{fsal__tools_8c_95706123588ac755c4ed3b5d78dcd72b}

\item 
\#define \textbf{SMALL\_\-PRIME\_\-ADD}~1999\label{fsal__tools_8c_8b2eea7185994e4333b75f02231a8d7b}

\item 
\#define \textbf{HASH\_\-INCR}(\_\-h\_\-, \_\-i\_\-)~( \_\-h\_\- = (\_\-h\_\- $\ast$ SMALL\_\-PRIME\_\-MULT + SMALL\_\-PRIME\_\-ADD) \% \_\-i\_\- )\label{fsal__tools_8c_3e856864aba497e6b22de127c7b7ad2b}

\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
char $\ast$ \textbf{FSAL\_\-GetFSName} ()\label{fsal__tools_8c_5ce13ad306b54a091960744c763b3867}

\item 
int {\bf FSAL\_\-handlecmp} (fsal\_\-handle\_\-t $\ast$handle1, fsal\_\-handle\_\-t $\ast$handle2, fsal\_\-status\_\-t $\ast$status)
\item 
unsigned int {\bf FSAL\_\-Handle\_\-to\_\-HashIndex} (fsal\_\-handle\_\-t $\ast$p\_\-handle, unsigned int cookie, unsigned int alphabet\_\-len, unsigned int index\_\-size)
\item 
unsigned int \textbf{FSAL\_\-Handle\_\-to\_\-RBTIndex} (fsal\_\-handle\_\-t $\ast$p\_\-handle, unsigned int cookie)\label{fsal__tools_8c_0afe476befc56121cceeb82a69e458c5}

\item 
fsal\_\-status\_\-t {\bf FSAL\_\-DigestHandle} (fsal\_\-export\_\-context\_\-t $\ast$p\_\-expcontext, fsal\_\-digesttype\_\-t output\_\-type, fsal\_\-handle\_\-t $\ast$in\_\-fsal\_\-handle, caddr\_\-t out\_\-buff)
\item 
fsal\_\-status\_\-t {\bf FSAL\_\-ExpandHandle} (fsal\_\-export\_\-context\_\-t $\ast$p\_\-expcontext, fsal\_\-digesttype\_\-t in\_\-type, caddr\_\-t in\_\-buff, fsal\_\-handle\_\-t $\ast$out\_\-fsal\_\-handle)
\item 
fsal\_\-status\_\-t {\bf FSAL\_\-SetDefault\_\-FSAL\_\-parameter} (fsal\_\-parameter\_\-t $\ast$out\_\-parameter)
\item 
fsal\_\-status\_\-t \textbf{FSAL\_\-SetDefault\_\-FS\_\-common\_\-parameter} (fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_7626d35bafe1d83233a23dac0309496a}

\item 
fsal\_\-status\_\-t \textbf{FSAL\_\-SetDefault\_\-FS\_\-specific\_\-parameter} (fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_2c9026a0246b7163c494edfaaed5e8b5}

\item 
fsal\_\-status\_\-t {\bf FSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf} (config\_\-file\_\-t in\_\-config, fsal\_\-parameter\_\-t $\ast$out\_\-parameter)
\item 
fsal\_\-status\_\-t \textbf{FSAL\_\-load\_\-FS\_\-common\_\-parameter\_\-from\_\-conf} (config\_\-file\_\-t in\_\-config, fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_5e93d174a899b934ed30e8bedb143655}

\item 
fsal\_\-status\_\-t \textbf{FSAL\_\-load\_\-FS\_\-specific\_\-parameter\_\-from\_\-conf} (config\_\-file\_\-t in\_\-config, fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_be783ef46edfd457473f20e3e5aa4073}

\end{CompactItemize}


\subsection{Detailed Description}
miscelaneous FSAL tools. 

\begin{Desc}
\item[Author:]\end{Desc}
\begin{Desc}
\item[Author]leibovic \end{Desc}
\begin{Desc}
\item[Date:]\end{Desc}
\begin{Desc}
\item[Date]2006/02/09 12:16:07 \end{Desc}
\begin{Desc}
\item[Version:]\end{Desc}
\begin{Desc}
\item[Revision]1.28 \end{Desc}


Definition in file {\bf fsal\_\-tools.c}.

\subsection{Function Documentation}
\index{fsal\_\-tools.c@{fsal\_\-tools.c}!FSAL\_\-DigestHandle@{FSAL\_\-DigestHandle}}
\index{FSAL\_\-DigestHandle@{FSAL\_\-DigestHandle}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{FSAL\_\-DigestHandle}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t FSAL\_\-DigestHandle (fsal\_\-export\_\-context\_\-t $\ast$ {\em p\_\-expcontext}, \/  fsal\_\-digesttype\_\-t {\em output\_\-type}, \/  fsal\_\-handle\_\-t $\ast$ {\em in\_\-fsal\_\-handle}, \/  caddr\_\-t {\em out\_\-buff})}\label{fsal__tools_8c_b02934f69a3ddfb023c4ee861a2f8ca4}


FSAL\_\-DigestHandle : Convert an fsal\_\-handle\_\-t to a buffer to be included into NFS handles, or another digest.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em output\_\-type}](input): Indicates the type of digest to do. \item[{\em in\_\-fsal\_\-handle}](input): The handle to be converted to digest. \item[{\em out\_\-buff}](output): The buffer where the digest is to be stored.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]The major code is ERR\_\-FSAL\_\-NO\_\-ERROR is no error occured. Else, it is a non null value. \end{Desc}


Definition at line 202 of file fsal\_\-tools.c.\index{fsal\_\-tools.c@{fsal\_\-tools.c}!FSAL\_\-ExpandHandle@{FSAL\_\-ExpandHandle}}
\index{FSAL\_\-ExpandHandle@{FSAL\_\-ExpandHandle}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{FSAL\_\-ExpandHandle}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t FSAL\_\-ExpandHandle (fsal\_\-export\_\-context\_\-t $\ast$ {\em p\_\-expcontext}, \/  fsal\_\-digesttype\_\-t {\em in\_\-type}, \/  caddr\_\-t {\em in\_\-buff}, \/  fsal\_\-handle\_\-t $\ast$ {\em out\_\-fsal\_\-handle})}\label{fsal__tools_8c_341eb16cdc47fbf19cbbeb1362301bcc}


FSAL\_\-ExpandHandle : Convert a buffer extracted from NFS handles to an FSAL handle.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em in\_\-type}](input): Indicates the type of digest to be expanded. \item[{\em in\_\-buff}](input): Pointer to the digest to be expanded. \item[{\em out\_\-fsal\_\-handle}](output): The handle built from digest.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]The major code is ERR\_\-FSAL\_\-NO\_\-ERROR is no error occured. Else, it is a non null value. \end{Desc}


Definition at line 449 of file fsal\_\-tools.c.

References hpss2fsal\_\-type().\index{fsal\_\-tools.c@{fsal\_\-tools.c}!FSAL\_\-Handle\_\-to\_\-HashIndex@{FSAL\_\-Handle\_\-to\_\-HashIndex}}
\index{FSAL\_\-Handle\_\-to\_\-HashIndex@{FSAL\_\-Handle\_\-to\_\-HashIndex}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{FSAL\_\-Handle\_\-to\_\-HashIndex}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int FSAL\_\-Handle\_\-to\_\-HashIndex (fsal\_\-handle\_\-t $\ast$ {\em p\_\-handle}, \/  unsigned int {\em cookie}, \/  unsigned int {\em alphabet\_\-len}, \/  unsigned int {\em index\_\-size})}\label{fsal__tools_8c_a08050a4cea7a2bd7f00b81687ffca3f}


FSAL\_\-Handle\_\-to\_\-HashIndex This function is used for hashing a FSAL handle in order to dispatch entries into the hash table array.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em p\_\-handle}]The handle to be hashed \item[{\em cookie}]Makes it possible to have different hash value for the same handle, when cookie changes. \item[{\em alphabet\_\-len}]Parameter for polynomial hashing algorithm \item[{\em index\_\-size}]The range of hash value will be [0..index\_\-size-1]\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]The hash value \end{Desc}


Definition at line 108 of file fsal\_\-tools.c.\index{fsal\_\-tools.c@{fsal\_\-tools.c}!FSAL\_\-handlecmp@{FSAL\_\-handlecmp}}
\index{FSAL\_\-handlecmp@{FSAL\_\-handlecmp}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{FSAL\_\-handlecmp}]{\setlength{\rightskip}{0pt plus 5cm}int FSAL\_\-handlecmp (fsal\_\-handle\_\-t $\ast$ {\em handle1}, \/  fsal\_\-handle\_\-t $\ast$ {\em handle2}, \/  fsal\_\-status\_\-t $\ast$ {\em status})}\label{fsal__tools_8c_808e39546ae8080e331e6d09255d1fc8}


FSAL\_\-handlecmp: Compare 2 handles.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em handle1}](input): The first handle to be compared. \item[{\em handle2}](input): The second handle to be compared. \item[{\em status}](output): The status of the compare operation.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]- 0 if handles are the same.\begin{itemize}
\item A non null value else.\item Segfault if status is a NULL pointer. \end{itemize}
\end{Desc}


Definition at line 63 of file fsal\_\-tools.c.

Referenced by FSAL\_\-rename().\index{fsal\_\-tools.c@{fsal\_\-tools.c}!FSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf@{FSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf}}
\index{FSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf@{FSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{FSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t FSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf (config\_\-file\_\-t {\em in\_\-config}, \/  fsal\_\-parameter\_\-t $\ast$ {\em out\_\-parameter})}\label{fsal__tools_8c_38fe03c0aa0fa100e90f3c0f8698c95e}


FSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf, FSAL\_\-load\_\-FS\_\-common\_\-parameter\_\-from\_\-conf, FSAL\_\-load\_\-FS\_\-specific\_\-parameter\_\-from\_\-conf:

Those functions initialize the FSAL init parameter structure from a configuration structure.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em in\_\-config}](input): Structure that represents the parsed configuration file. \item[{\em out\_\-parameter}](ouput) FSAL initialization structure filled according to the configuration file given as parameter.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]ERR\_\-FSAL\_\-NO\_\-ERROR (no error) , ERR\_\-FSAL\_\-NOENT (missing a mandatory stanza in config file), ERR\_\-FSAL\_\-INVAL (invalid parameter), ERR\_\-FSAL\_\-SERVERFAULT (unexpected error) ERR\_\-FSAL\_\-FAULT (null pointer given as parameter), \end{Desc}


Definition at line 642 of file fsal\_\-tools.c.\index{fsal\_\-tools.c@{fsal\_\-tools.c}!FSAL\_\-SetDefault\_\-FSAL\_\-parameter@{FSAL\_\-SetDefault\_\-FSAL\_\-parameter}}
\index{FSAL\_\-SetDefault\_\-FSAL\_\-parameter@{FSAL\_\-SetDefault\_\-FSAL\_\-parameter}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{FSAL\_\-SetDefault\_\-FSAL\_\-parameter}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t FSAL\_\-SetDefault\_\-FSAL\_\-parameter (fsal\_\-parameter\_\-t $\ast$ {\em out\_\-parameter})}\label{fsal__tools_8c_a4c8e7706d68c7f776c02726c89dc8d0}


Those routines set the default parameters for FSAL init structure. \begin{Desc}
\item[Returns:]ERR\_\-FSAL\_\-NO\_\-ERROR (no error) , ERR\_\-FSAL\_\-FAULT (null pointer given as parameter), ERR\_\-FSAL\_\-SERVERFAULT (unexpected error) \end{Desc}


Definition at line 517 of file fsal\_\-tools.c.