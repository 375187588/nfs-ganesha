<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Stuff Allocator: stuff_alloc.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>stuff_alloc.h File Reference</h1>
<p>Stuff allocators macros.  
<a href="#_details">More...</a></p>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &quot;BuddyMalloc.h&quot;</code><br/>

<p><a href="stuff__alloc_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stuff__alloc_8h.html#ad6b7282e7c215186f8514097b04d5bfa">Mem_Alloc</a>(a)&nbsp;&nbsp;&nbsp;BuddyMalloc( a )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stuff__alloc_8h.html#a33eb598e1abd423b85812262b3691f70">STUFF_PREALLOC</a>(pool, nb, type, name_next)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stuff__alloc_8h.html#a457d47f8b2bbac516aee6fd69707e74a">GET_PREALLOC</a>(entry, pool, nb, type, name_next)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="stuff__alloc_8h.html#aeb0d01b2e3cfab695f1240110e0994c5">RELEASE_PREALLOC</a>(entry, pool, name_next)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Stuff allocators macros. </p>
<dl class="author"><dt><b>Author:</b></dt><dd></dd></dl>
<dl class="rcs"><dt><b>Author</b></dt><dd>deniel </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd></dd></dl>
<dl class="rcs"><dt><b>Date</b></dt><dd>2005/05/03 07:24:33 </dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd></dd></dl>
<dl class="rcs"><dt><b>Revision</b></dt><dd>1.4 </dd></dl>
<p><a class="el" href="stuff__alloc_8h.html" title="Stuff allocators macros.">stuff_alloc.h</a> : Stuff allocators macros.</p>
<dl class="rcs"><dt><b>Header</b></dt><dd>/cea/home/cvs/cvs/SHERPA/BaseCvs/GANESHA/src/StuffAlloc/stuff_alloc.h,v 1.4 2005/05/03 07:24:33 deniel Exp </dd></dl>
<dl class="rcs"><dt><b>Log</b></dt><dd><a class="el" href="stuff__alloc_8h.html" title="Stuff allocators macros.">stuff_alloc.h</a>,v </dd></dl>
<p>Revision 1.4 2005/05/03 07:24:33 deniel Using Buddy System instead of regular malloc/free</p>
<p>Revision 1.3 2004/10/20 16:51:25 deniel Comments added to stuuf allocator macros</p>
<p>Revision 1.2 2004/10/19 14:40:26 deniel Ok for UDP and TCP processing</p>
<p>Revision 1.2 2004/10/18 08:43:49 deniel Many changes in protootypes ans data structures Adding some functions in preallocator</p>
<p>Revision 1.1 2004/10/13 13:01:44 deniel Now using the stuff allocator </p>

<p>Definition in file <a class="el" href="stuff__alloc_8h_source.html">stuff_alloc.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a457d47f8b2bbac516aee6fd69707e74a"></a><!-- doxytag: member="stuff_alloc.h::GET_PREALLOC" ref="a457d47f8b2bbac516aee6fd69707e74a" args="(entry, pool, nb, type, name_next)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_PREALLOC</td>
          <td>(</td>
          <td class="paramtype">entry, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pool, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">nb, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">name_next&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">do</span>                                                                        \
{                                                                         \
                                                                          \
  <span class="keywordflow">if</span>( ( pool == NULL ) &amp;&amp; ( nb != 0 ) )                                   \
    <a class="code" href="stuff__alloc_8h.html#a33eb598e1abd423b85812262b3691f70">STUFF_PREALLOC</a>( pool, nb, type, name_next ) ;                         \
                                                                          \
  <span class="keywordflow">if</span>( pool != NULL )                                                      \
    {                                                                     \
      entry = pool ;                                                      \
      pool = entry-&gt;name_next ;                                           \
    }                                                                     \
  <span class="keywordflow">else</span>                                                                    \
   entry = NULL ;                                                         \
} <span class="keywordflow">while</span>( 0 )
</pre></div><p>GET_PREALLOC: Gets an entry in a preallocated pool.</p>
<p>This macro is used to get an entry from a pre-allocated pool. If the pool is empty, the macro STUFF_PREALLOC will be called with the same last four arguments to extend the pool. If nb is set to zero during this call, STUFF_PREALLOC is not called and no entry is get from the pool that is empty.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>entry</em>&nbsp;</td><td>the entry we need. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pool</em>&nbsp;</td><td>the preallocted pool that we want to init. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb</em>&nbsp;</td><td>the number of entries to be allocated. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>the type of the entries to be allocated. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name_next</em>&nbsp;</td><td>the name of the field, in structure of type 'type' which pointer to the next entry.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>nothing (this is a macro), but entry will be NULL if an error occures. </dd></dl>

<p>Definition at line <a class="el" href="stuff__alloc_8h_source.html#l00102">102</a> of file <a class="el" href="stuff__alloc_8h_source.html">stuff_alloc.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad6b7282e7c215186f8514097b04d5bfa"></a><!-- doxytag: member="stuff_alloc.h::Mem_Alloc" ref="ad6b7282e7c215186f8514097b04d5bfa" args="(a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Mem_Alloc</td>
          <td>(</td>
          <td class="paramtype">a&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;BuddyMalloc( a )</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="stuff__alloc_8h_source.html#l00042">42</a> of file <a class="el" href="stuff__alloc_8h_source.html">stuff_alloc.h</a>.</p>

</div>
</div>
<a class="anchor" id="aeb0d01b2e3cfab695f1240110e0994c5"></a><!-- doxytag: member="stuff_alloc.h::RELEASE_PREALLOC" ref="aeb0d01b2e3cfab695f1240110e0994c5" args="(entry, pool, name_next)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RELEASE_PREALLOC</td>
          <td>(</td>
          <td class="paramtype">entry, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pool, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">name_next&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">do</span>                                                                        \
{                                                                         \
  entry-&gt;name_next = pool ;                                               \
  pool = entry ;                                                          \
} <span class="keywordflow">while</span>( 0 )
</pre></div><p>RELEASE_PREALLOC: Releases an entry and puts it back to the pool.</p>
<p>When an entry is no used any more, this macro is used to put it back to the pool, so that it could be reuse later. The released entry is chained to the pool, through the 'name_next' field.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>entry</em>&nbsp;</td><td>the entry to be released. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pool</em>&nbsp;</td><td>the pool to which the entry belongs. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name_next</em>&nbsp;</td><td>the name of the field, in structure of type 'type' which pointer to the next entry.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>nothing (this is a macro). </dd></dl>

<p>Definition at line <a class="el" href="stuff__alloc_8h_source.html#l00133">133</a> of file <a class="el" href="stuff__alloc_8h_source.html">stuff_alloc.h</a>.</p>

</div>
</div>
<a class="anchor" id="a33eb598e1abd423b85812262b3691f70"></a><!-- doxytag: member="stuff_alloc.h::STUFF_PREALLOC" ref="a33eb598e1abd423b85812262b3691f70" args="(pool, nb, type, name_next)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STUFF_PREALLOC</td>
          <td>(</td>
          <td class="paramtype">pool, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">nb, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">name_next&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">do</span>                                                                        \
{                                                                         \
  <span class="keywordtype">int</span> i = 0 ;                                                             \
                                                                          \
  pool= NULL ;                                                            \
                                                                          \
  <span class="keywordflow">if</span>( ( pool = ( type *)<a class="code" href="stuff__alloc_8h.html#ad6b7282e7c215186f8514097b04d5bfa">Mem_Alloc</a>( <span class="keyword">sizeof</span>( type ) * nb ) ) != NULL )         \
    {                                                                     \
      <span class="keywordflow">for</span>( i = 0 ; i &lt; nb ; i++ )                                         \
        {                                                                 \
          <span class="keywordflow">if</span>( i != nb -1 )                                                \
            pool[i].name_next = &amp;(pool[i+1]) ;                            \
          <span class="keywordflow">else</span>                                                            \
            pool[i].name_next = NULL ;                                    \
        }                                                                 \
    }                                                                     \
} <span class="keywordflow">while</span>( 0 )
</pre></div><p>STUFF_PREALLOC: Allocates a pool of pre-allocated entries.</p>
<p>This macro Allocates a pool of pre-allocated entries. It calls malloc to get the spool as an arry and then chains all the entries together. Each entry is supposed to have a specific 'next' field, a pointer to an object of its own type, to be used as a pointer to the next entry in the pool.</p>
<p>If BuddyMalloc is used, it is supposed to be already initialised.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pool</em>&nbsp;</td><td>the preallocted pool that we want to init. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb</em>&nbsp;</td><td>the number of entries to be allocated. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>the type of the entries to be allocated. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name_next</em>&nbsp;</td><td>the name of the field, in structure of type 'type' which pointer to the next entry.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>nothing (this is a macro), but pool will be NULL if an error occures. </dd></dl>

<p>Definition at line <a class="el" href="stuff__alloc_8h_source.html#l00065">65</a> of file <a class="el" href="stuff__alloc_8h_source.html">stuff_alloc.h</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 15 Sep 2010 for Stuff Allocator by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
