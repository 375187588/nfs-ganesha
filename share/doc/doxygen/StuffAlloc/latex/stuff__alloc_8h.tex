\section{stuff\_\-alloc.h File Reference}
\label{stuff__alloc_8h}\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}}


Stuff allocators macros.  
{\ttfamily \#include $<$stdlib.h$>$}\par
{\ttfamily \#include \char`\"{}BuddyMalloc.h\char`\"{}}\par
\subsection*{Defines}
\begin{DoxyCompactItemize}
\item 
\#define {\bf Mem\_\-Alloc}(a)~BuddyMallocExit( a )
\item 
\#define {\bf Mem\_\-Calloc}(s1, s2)~BuddyCalloc( s1, s2 )
\item 
\#define {\bf Mem\_\-Realloc}(p, s)~BuddyRealloc( (caddr\_\-t)(p), s )
\item 
\#define {\bf Mem\_\-Free}(a)~BuddyFree((caddr\_\-t) (a))
\item 
\#define {\bf Mem\_\-Errno}~BuddyErrno
\item 
\#define {\bf GetPreferedPool}(\_\-n, \_\-s)~BuddyPreferedPoolCount( \_\-n, \_\-s)
\item 
\#define {\bf STUFF\_\-PREALLOC}(\_\-pool, \_\-nb, \_\-type, \_\-name\_\-next)
\item 
\#define {\bf GET\_\-PREALLOC}(\_\-entry, \_\-pool, \_\-nb, \_\-type, \_\-name\_\-next)
\item 
\#define {\bf RELEASE\_\-PREALLOC}(\_\-entry, \_\-pool, \_\-name\_\-next)
\item 
\#define {\bf STUFF\_\-PREALLOC\_\-CONSTRUCT}(\_\-pool, \_\-nb, \_\-type, \_\-name\_\-next, \_\-construct)
\item 
\#define {\bf GET\_\-PREALLOC\_\-CONSTRUCT}(\_\-entry, \_\-pool, \_\-nb, \_\-type, \_\-name\_\-next, \_\-construct)
\item 
\#define {\bf RELEASE\_\-PREALLOC\_\-DESTRUCT}(entry, pool, name\_\-next, destruct)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Stuff allocators macros. \begin{DoxyAuthor}{Author}

\end{DoxyAuthor}
Author}
leibovic \begin{DoxyDate}{Date}

\end{DoxyDate}
Date}
2006/01/24 15:06:30 \begin{DoxyVersion}{Version}

\end{DoxyVersion}
Revision}
1.18 \doxyref{stuff\_\-alloc.h}{p.}{stuff__alloc_8h} : Stuff allocators macros. 

Definition in file {\bf stuff\_\-alloc.h}.

\subsection{Define Documentation}
\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!GET\_\-PREALLOC@{GET\_\-PREALLOC}}
\index{GET\_\-PREALLOC@{GET\_\-PREALLOC}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{GET\_\-PREALLOC}]{\setlength{\rightskip}{0pt plus 5cm}\#define GET\_\-PREALLOC(\_\-entry, \/  \_\-pool, \/  \_\-nb, \/  \_\-type, \/  \_\-name\_\-next)}\label{stuff__alloc_8h_a4ba0f04a3d862387dcc4115476b08fda}
{\bfseries Value:}
\begin{DoxyCode}
do                                                                        \
{                                                                         \
                                                                          \
  if( ( _pool == NULL ) && ( _nb != 0 ) )                                 \
    STUFF_PREALLOC( _pool, _nb, _type, _name_next ) ;                     \
                                                                          \
  if( _pool != NULL )                                                     \
    {                                                                     \
      _entry = _pool ;                                                    \
      _pool = _entry->_name_next ;                                        \
    }                                                                     \
  else                                                                    \
   _entry = NULL ;                                                        \
} while( 0 )
\end{DoxyCode}
GET\_\-PREALLOC: Gets an entry in a preallocated pool.

This macro is used to get an entry from a pre-\/allocated pool. If the pool is empty, the macro STUFF\_\-PREALLOC will be called with the same last four arguments to extend the pool. If nb is set to zero during this call, STUFF\_\-PREALLOC is not called and no entry is get from the pool that is empty.


\begin{DoxyParams}{Parameters}
\item[{\em entry}]the entry we need. \item[{\em pool}]the preallocted pool that we want to init. \item[{\em nb}]the number of entries to be allocated. \item[{\em type}]the type of the entries to be allocated. \item[{\em name\_\-next}]the name of the field, in structure of type 'type' which pointer to the next entry.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
nothing (this is a macro), but entry will be NULL if an error occures. 
\end{DoxyReturn}


Definition at line 137 of file stuff\_\-alloc.h.\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!GET\_\-PREALLOC\_\-CONSTRUCT@{GET\_\-PREALLOC\_\-CONSTRUCT}}
\index{GET\_\-PREALLOC\_\-CONSTRUCT@{GET\_\-PREALLOC\_\-CONSTRUCT}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{GET\_\-PREALLOC\_\-CONSTRUCT}]{\setlength{\rightskip}{0pt plus 5cm}\#define GET\_\-PREALLOC\_\-CONSTRUCT(\_\-entry, \/  \_\-pool, \/  \_\-nb, \/  \_\-type, \/  \_\-name\_\-next, \/  \_\-construct)}\label{stuff__alloc_8h_a7e08994c1fb518ad7d9f427ab6c93bf2}
{\bfseries Value:}
\begin{DoxyCode}
do                                                                             \
{                                                                              \
  if( ( _pool == NULL ) && ( _nb != 0 ) )                                      \
    STUFF_PREALLOC_CONSTRUCT( _pool, _nb, _type, _name_next, _construct ) ;    \
                                                                               \
  if( _pool != NULL )                                                          \
    {                                                                          \
      _entry = _pool ;                                                         \
      _pool = _entry->_name_next ;                                             \
    }                                                                          \
  else                                                                         \
   _entry = NULL ;                                                             \
} while( 0 )
\end{DoxyCode}
GET\_\-PREALLOC\_\-CONSTRUCT: Gets an entry in a preallocated pool.

This macro is used to get an entry from a pre-\/allocated pool. If the pool is empty, the macro STUFF\_\-PREALLOC will be called with the same last four arguments to extend the pool. If nb is set to zero during this call, STUFF\_\-PREALLOC is not called and no entry is get from the pool that is empty.


\begin{DoxyParams}{Parameters}
\item[{\em entry}]the entry we need. \item[{\em pool}]the preallocted pool that we want to init. \item[{\em nb}]the number of entries to be allocated. \item[{\em type}]the type of the entries to be allocated. \item[{\em name\_\-next}]the name of the field, in structure of type 'type' which pointer to the next entry. \item[{\em construct}]the constructor for the object: takes a pointer to void as argument and returns void\end{DoxyParams}
\begin{DoxyReturn}{Returns}
nothing (this is a macro), but entry will be NULL if an error occures. 
\end{DoxyReturn}


Definition at line 241 of file stuff\_\-alloc.h.\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!GetPreferedPool@{GetPreferedPool}}
\index{GetPreferedPool@{GetPreferedPool}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{GetPreferedPool}]{\setlength{\rightskip}{0pt plus 5cm}\#define GetPreferedPool(\_\-n, \/  \_\-s)~BuddyPreferedPoolCount( \_\-n, \_\-s)}\label{stuff__alloc_8h_a589a6aa3b3312bedf3f6bf7644fe631d}


Definition at line 72 of file stuff\_\-alloc.h.\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!Mem\_\-Alloc@{Mem\_\-Alloc}}
\index{Mem\_\-Alloc@{Mem\_\-Alloc}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{Mem\_\-Alloc}]{\setlength{\rightskip}{0pt plus 5cm}\#define Mem\_\-Alloc(a)~BuddyMallocExit( a )}\label{stuff__alloc_8h_ad6b7282e7c215186f8514097b04d5bfa}


Definition at line 64 of file stuff\_\-alloc.h.\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!Mem\_\-Calloc@{Mem\_\-Calloc}}
\index{Mem\_\-Calloc@{Mem\_\-Calloc}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{Mem\_\-Calloc}]{\setlength{\rightskip}{0pt plus 5cm}\#define Mem\_\-Calloc(s1, \/  s2)~BuddyCalloc( s1, s2 )}\label{stuff__alloc_8h_a44c3aa0d5261064e512efe252dd1600f}


Definition at line 65 of file stuff\_\-alloc.h.\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!Mem\_\-Errno@{Mem\_\-Errno}}
\index{Mem\_\-Errno@{Mem\_\-Errno}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{Mem\_\-Errno}]{\setlength{\rightskip}{0pt plus 5cm}\#define Mem\_\-Errno~BuddyErrno}\label{stuff__alloc_8h_acd84738997b6c23395138cbfe5f296b1}


Definition at line 70 of file stuff\_\-alloc.h.\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!Mem\_\-Free@{Mem\_\-Free}}
\index{Mem\_\-Free@{Mem\_\-Free}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{Mem\_\-Free}]{\setlength{\rightskip}{0pt plus 5cm}\#define Mem\_\-Free(a)~BuddyFree((caddr\_\-t) (a))}\label{stuff__alloc_8h_a4e6d06ceac8fce7d7b9dde85e225ad4a}


Definition at line 69 of file stuff\_\-alloc.h.\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!Mem\_\-Realloc@{Mem\_\-Realloc}}
\index{Mem\_\-Realloc@{Mem\_\-Realloc}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{Mem\_\-Realloc}]{\setlength{\rightskip}{0pt plus 5cm}\#define Mem\_\-Realloc(p, \/  s)~BuddyRealloc( (caddr\_\-t)(p), s )}\label{stuff__alloc_8h_a493e3330b67be95e7844e98de50c126a}


Definition at line 66 of file stuff\_\-alloc.h.\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!RELEASE\_\-PREALLOC@{RELEASE\_\-PREALLOC}}
\index{RELEASE\_\-PREALLOC@{RELEASE\_\-PREALLOC}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{RELEASE\_\-PREALLOC}]{\setlength{\rightskip}{0pt plus 5cm}\#define RELEASE\_\-PREALLOC(\_\-entry, \/  \_\-pool, \/  \_\-name\_\-next)}\label{stuff__alloc_8h_a75ffcec8cebe37ccd4044d7e9bb52ae1}
{\bfseries Value:}
\begin{DoxyCode}
do                                                                        \
{                                                                         \
  _entry->_name_next = _pool ;                                            \
  _pool = _entry ;                                                        \
} while( 0 )
\end{DoxyCode}
RELEASE\_\-PREALLOC: Releases an entry and puts it back to the pool.

When an entry is no used any more, this macro is used to put it back to the pool, so that it could be reuse later. The released entry is chained to the pool, through the 'name\_\-next' field.


\begin{DoxyParams}{Parameters}
\item[{\em entry}]the entry to be released. \item[{\em pool}]the pool to which the entry belongs. \item[{\em name\_\-next}]the name of the field, in structure of type 'type' which pointer to the next entry.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
nothing (this is a macro). 
\end{DoxyReturn}


Definition at line 168 of file stuff\_\-alloc.h.\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!RELEASE\_\-PREALLOC\_\-DESTRUCT@{RELEASE\_\-PREALLOC\_\-DESTRUCT}}
\index{RELEASE\_\-PREALLOC\_\-DESTRUCT@{RELEASE\_\-PREALLOC\_\-DESTRUCT}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{RELEASE\_\-PREALLOC\_\-DESTRUCT}]{\setlength{\rightskip}{0pt plus 5cm}\#define RELEASE\_\-PREALLOC\_\-DESTRUCT(entry, \/  pool, \/  name\_\-next, \/  destruct)}\label{stuff__alloc_8h_ab23410492b8d0a00fec44cf80ce0da74}
{\bfseries Value:}
\begin{DoxyCode}
do                                                                        \
{                                                                         \
  destruct( (void *)entry ) ;                                             \
  entry->name_next = pool ;                                               \
  pool = entry ;                                                          \
} while( 0 )
\end{DoxyCode}
RELEASE\_\-PREALLOC\_\-DESTRUCT: Releases an entry and puts it back to the pool with a destructor.

When an entry is no used any more, this macro is used to put it back to the pool, so that it could be reuse later. The released entry is chained to the pool, through the 'name\_\-next' field.


\begin{DoxyParams}{Parameters}
\item[{\em entry}]the entry to be released. \item[{\em pool}]the pool to which the entry belongs. \item[{\em name\_\-next}]the name of the field, in structure of type 'type' which pointer to the next entry. \item[{\em destruct}]the destructor for the object: takes a pointer to void as argument and returns void\end{DoxyParams}
\begin{DoxyReturn}{Returns}
nothing (this is a macro). 
\end{DoxyReturn}


Definition at line 272 of file stuff\_\-alloc.h.\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!STUFF\_\-PREALLOC@{STUFF\_\-PREALLOC}}
\index{STUFF\_\-PREALLOC@{STUFF\_\-PREALLOC}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{STUFF\_\-PREALLOC}]{\setlength{\rightskip}{0pt plus 5cm}\#define STUFF\_\-PREALLOC(\_\-pool, \/  \_\-nb, \/  \_\-type, \/  \_\-name\_\-next)}\label{stuff__alloc_8h_a6c09779d3013b3d009840bd835481dfb}
{\bfseries Value:}
\begin{DoxyCode}
do                                                                            \
{                                                                             \
  unsigned int _i = 0 ;                                                       \
  unsigned int _prefered = 0 ;                                                \
                                                                              \
  _prefered = GetPreferedPool( _nb, sizeof(_type) );                          \
  _pool= NULL ;                                                               \
                                                                              \
  if( ( _pool = ( _type *)Mem_Alloc( sizeof( _type ) * _prefered ) ) != NULL ) \
    {                                                                         \
      for( _i = 0 ; _i < ( unsigned int)_prefered ; _i++ )                    \
        {                                                                     \
          if( _i != _prefered -1 )                                            \
            _pool[_i]._name_next = &(_pool[_i+1]) ;                           \
          else                                                                \
            _pool[_i]._name_next = NULL ;                                     \
        }                                                                     \
    }                                                                         \
} while( 0 )
\end{DoxyCode}
STUFF\_\-PREALLOC: Allocates a pool of pre-\/allocated entries.

This macro Allocates a pool of pre-\/allocated entries. It calls malloc to get the spool as an arry and then chains all the entries together. Each entry is supposed to have a specific 'next' field, a pointer to an object of its own type, to be used as a pointer to the next entry in the pool.

If BuddyMalloc is used, it is supposed to be already initialised.


\begin{DoxyParams}{Parameters}
\item[{\em pool}]the preallocted pool that we want to init. \item[{\em nb}]the number of entries to be allocated. \item[{\em type}]the type of the entries to be allocated. \item[{\em name\_\-next}]the name of the field, in structure of type 'type' which pointer to the next entry.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
nothing (this is a macro), but pool will be NULL if an error occures. 
\end{DoxyReturn}


Definition at line 98 of file stuff\_\-alloc.h.\index{stuff\_\-alloc.h@{stuff\_\-alloc.h}!STUFF\_\-PREALLOC\_\-CONSTRUCT@{STUFF\_\-PREALLOC\_\-CONSTRUCT}}
\index{STUFF\_\-PREALLOC\_\-CONSTRUCT@{STUFF\_\-PREALLOC\_\-CONSTRUCT}!stuff_alloc.h@{stuff\_\-alloc.h}}
\subsubsection[{STUFF\_\-PREALLOC\_\-CONSTRUCT}]{\setlength{\rightskip}{0pt plus 5cm}\#define STUFF\_\-PREALLOC\_\-CONSTRUCT(\_\-pool, \/  \_\-nb, \/  \_\-type, \/  \_\-name\_\-next, \/  \_\-construct)}\label{stuff__alloc_8h_aedd85b3e73701cd559e6ec90f0c42b86}
{\bfseries Value:}
\begin{DoxyCode}
do                                                                        \
{                                                                         \
  unsigned int _i = 0 ;                                                   \
  unsigned int _prefered = 0 ;                                            \
                                                                          \
  _prefered = GetPreferedPool( _nb, sizeof(_type) );                       \
                                                                          \
  _pool = ( _type *)Mem_Calloc( _prefered, sizeof( _type ) ) ;            \
                                                                          \
  if( _pool != NULL )                                                     \
    {                                                                     \
      for( _i = 0 ; _i < _prefered ; _i++ )                               \
        {                                                                 \
          if( _i != _prefered -1 )                                        \
            _pool[_i]._name_next = &(_pool[_i+1]) ;                       \
          else                                                            \
            _pool[_i]._name_next = NULL ;                                 \
                                                                          \
          if( _construct != NULL )                                        \
            _construct( (void *)&(_pool[_i]) )  ;                         \
                                                                          \
        }                                                                 \
    }                                                                     \
} while( 0 )
\end{DoxyCode}
STUFF\_\-PREALLOC\_\-CONSTRUCT: Allocates a pool of pre-\/allocated entries with a call to a constructor.

This macro Allocates a pool of pre-\/allocated entries. It calls malloc to get the spool as an arry and then chains all the entries together. Each entry is supposed to have a specific 'next' field, a pointer to an object of its own type, to be used as a pointer to the next entry in the pool.

If BuddyMalloc is used, it is supposed to be already initialised.


\begin{DoxyParams}{Parameters}
\item[{\em pool}]the preallocted pool that we want to init. \item[{\em nb}]the number of entries to be allocated. \item[{\em type}]the type of the entries to be allocated. \item[{\em name\_\-next}]the name of the field, in structure of type 'type' which pointer to the next entry. \item[{\em construct}]the constructor for the object: takes a pointer to void as argument and returns void\end{DoxyParams}
\begin{DoxyReturn}{Returns}
nothing (this is a macro), but pool will be NULL if an error occures. 
\end{DoxyReturn}


Definition at line 196 of file stuff\_\-alloc.h.