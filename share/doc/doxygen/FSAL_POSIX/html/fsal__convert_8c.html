<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>File System Abstraction Layer (POSIX) library: fsal_convert.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>fsal_convert.c File Reference</h1>HPSS-FSAL type translation functions. <a href="#_details">More...</a>
<p>
<code>#include "fsal_convert.h"</code><br>
<code>#include "fsal_internal.h"</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;sys/stat.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>

<p>
<a href="fsal__convert_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a0" doxytag="fsal_convert.c::MAX_2"></a>
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>MAX_2</b>(x, y)&nbsp;&nbsp;&nbsp;( (x) &gt; (y) ? (x) : (y) )</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a1" doxytag="fsal_convert.c::MAX_3"></a>
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>MAX_3</b>(x, y, z)&nbsp;&nbsp;&nbsp;( (x) &gt; (y) ? MAX_2((x),(z)) : MAX_2((y),(z)) )</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsal__convert_8c.html#a2">posix2fsal_error</a> (int posix_errorcode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsal__convert_8c.html#a3">fsal2posix_testperm</a> (fsal_accessflags_t testperm)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsal__convert_8c.html#a4">fsal2posix_openflags</a> (fsal_openflags_t fsal_flags, char *p_posix_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">mode_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsal__convert_8c.html#a5">fsal2unix_mode</a> (fsal_accessmode_t fsal_mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">fsal_accessmode_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsal__convert_8c.html#a6">unix2fsal_mode</a> (mode_t unix_mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">fsal_nodetype_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsal__convert_8c.html#a7">posix2fsal_type</a> (mode_t posix_type_in)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a8" doxytag="fsal_convert.c::posix2fsal_time"></a>
fsal_time_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>posix2fsal_time</b> (time_t tsec)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a9" doxytag="fsal_convert.c::posix2fsal_fsid"></a>
fsal_fsid_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>posix2fsal_fsid</b> (dev_t posix_devid)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a10" doxytag="fsal_convert.c::posix2fsal_devt"></a>
fsal_dev_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>posix2fsal_devt</b> (dev_t posix_devid)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a11" doxytag="fsal_convert.c::posix2fsal_attributes"></a>
fsal_status_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>posix2fsal_attributes</b> (struct stat *p_buffstat, fsal_attrib_list_t *p_fsalattr_out)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">fsal_status_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fsal__convert_8c.html#a12">posixdb2fsal_error</a> (fsal_posixdb_status_t statusdb)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
HPSS-FSAL type translation functions. 
<p>
<dl compact><dt><b>Author:</b></dt><dd><dl compact><dt><b>Author</b></dt><dd>leibovic </dd></dl>
</dd></dl>
<dl compact><dt><b>Date:</b></dt><dd><dl compact><dt><b>Date</b></dt><dd>2006/01/17 15:53:39 </dd></dl>
</dd></dl>
<dl compact><dt><b>Version:</b></dt><dd><dl compact><dt><b>Revision</b></dt><dd>1.31 </dd></dl>
</dd></dl>

<p>
Definition in file <a class="el" href="fsal__convert_8c-source.html">fsal_convert.c</a>.<hr><h2>Function Documentation</h2>
<a class="anchor" name="a4" doxytag="fsal_convert.c::fsal2posix_openflags"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int fsal2posix_openflags           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">fsal_openflags_t&nbsp;</td>
          <td class="mdname" nowrap> <em>fsal_flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>p_posix_flags</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
pen_by_n fsal2posix_openflags: Convert FSAL open flags to Posix open flags.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fsal_flags</em>&nbsp;</td><td>(input): The FSAL open flags to be translated. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_hpss_flags</em>&nbsp;</td><td>(output): Pointer to the POSIX open flags.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>- ERR_FSAL_NO_ERROR (no error).<ul>
<li>ERR_FSAL_FAULT (p_hpss_flags is a NULL pointer).</li><li>ERR_FSAL_INVAL (invalid or incompatible input flags). </li></ul>
</dd></dl>

<p>
Definition at line <a class="el" href="fsal__convert_8c-source.html#l00205">205</a> of file <a class="el" href="fsal__convert_8c-source.html">fsal_convert.c</a>.
<p>
Referenced by <a class="el" href="fsal__fileop_8c-source.html#l00118">FSAL_open()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="fsal_convert.c::fsal2posix_testperm"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int fsal2posix_testperm           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">fsal_accessflags_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>testperm</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
fsal2posix_testperm: Convert FSAL permission flags to Posix permission flags.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>testperm</em>&nbsp;</td><td>(input): The FSAL permission flags to be tested.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The POSIX permission flags to be tested. </dd></dl>

<p>
Definition at line <a class="el" href="fsal__convert_8c-source.html#l00177">177</a> of file <a class="el" href="fsal__convert_8c-source.html">fsal_convert.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="fsal_convert.c::fsal2unix_mode"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">mode_t fsal2unix_mode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">fsal_accessmode_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fsal_mode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
fsal2unix_mode: Convert FSAL mode to posix mode.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fsal_mode</em>&nbsp;</td><td>(input): The FSAL mode to be translated.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The posix mode associated to fsal_mode. </dd></dl>

<p>
Definition at line <a class="el" href="fsal__convert_8c-source.html#l00263">263</a> of file <a class="el" href="fsal__convert_8c-source.html">fsal_convert.c</a>.
<p>
Referenced by <a class="el" href="fsal__create_8c-source.html#l00052">FSAL_create()</a>, <a class="el" href="fsal__create_8c-source.html#l00200">FSAL_mkdir()</a>, <a class="el" href="fsal__create_8c-source.html#l00437">FSAL_mknode()</a>, and <a class="el" href="fsal__attrs_8c-source.html#l00107">FSAL_setattrs()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="fsal_convert.c::posix2fsal_error"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int posix2fsal_error           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>posix_errorcode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
posix2fsal_error : Convert POSIX error codes to FSAL error codes.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>posix_errorcode</em>&nbsp;</td><td>(input): The error code returned from POSIX.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The FSAL error code associated to posix_errorcode.</dd></dl>
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>: The EBADF error also happens when file is opened for reading, and we try writting in it. In this case, we return ERR_FSAL_NOT_OPENED, but it doesn't seems to be a correct error translation. </dd></dl>
<p>
<dl compact><dt><b>Warning:</b></dt><dd>AIX returns EEXIST where BSD uses ENOTEMPTY; We want ENOTEMPTY to be interpreted anyway on AIX plateforms. Thus, we explicitely write its value (87). </dd></dl>

<p>
Definition at line <a class="el" href="fsal__convert_8c-source.html#l00041">41</a> of file <a class="el" href="fsal__convert_8c-source.html">fsal_convert.c</a>.
<p>
Referenced by <a class="el" href="fsal__fileop_8c-source.html#l00465">FSAL_close()</a>, <a class="el" href="fsal__dirs_8c-source.html#l00330">FSAL_closedir()</a>, <a class="el" href="fsal__create_8c-source.html#l00052">FSAL_create()</a>, <a class="el" href="fsal__fsinfo_8c-source.html#l00080">FSAL_dynamic_fsinfo()</a>, <a class="el" href="fsal__create_8c-source.html#l00331">FSAL_link()</a>, <a class="el" href="fsal__lookup_8c-source.html#l00050">FSAL_lookup()</a>, <a class="el" href="fsal__create_8c-source.html#l00200">FSAL_mkdir()</a>, <a class="el" href="fsal__create_8c-source.html#l00437">FSAL_mknode()</a>, <a class="el" href="fsal__fileop_8c-source.html#l00118">FSAL_open()</a>, <a class="el" href="fsal__dirs_8c-source.html#l00046">FSAL_opendir()</a>, <a class="el" href="fsal__rcp_8c-source.html#l00053">FSAL_rcp()</a>, <a class="el" href="fsal__fileop_8c-source.html#l00214">FSAL_read()</a>, <a class="el" href="fsal__dirs_8c-source.html#l00157">FSAL_readdir()</a>, <a class="el" href="fsal__symlinks_8c-source.html#l00047">FSAL_readlink()</a>, <a class="el" href="fsal__rename_8c-source.html#l00059">FSAL_rename()</a>, <a class="el" href="fsal__attrs_8c-source.html#l00107">FSAL_setattrs()</a>, <a class="el" href="fsal__symlinks_8c-source.html#l00143">FSAL_symlink()</a>, <a class="el" href="fsal__truncate_8c-source.html#l00048">FSAL_truncate()</a>, <a class="el" href="fsal__unlink_8c-source.html#l00046">FSAL_unlink()</a>, and <a class="el" href="fsal__fileop_8c-source.html#l00340">FSAL_write()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="fsal_convert.c::posix2fsal_type"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">fsal_nodetype_t posix2fsal_type           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">mode_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>posix_type_in</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
posix2fsal_type: Convert posix object type to FSAL node type.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>posix_type_in</em>&nbsp;</td><td>(input): The POSIX object type.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>- The FSAL node type associated to posix_type_in.<ul>
<li>-1 if the input type is unknown. </li></ul>
</dd></dl>

<p>
Definition at line <a class="el" href="fsal__convert_8c-source.html#l00331">331</a> of file <a class="el" href="fsal__convert_8c-source.html">fsal_convert.c</a>.
<p>
Referenced by <a class="el" href="fsal__internal_8c-source.html#l00453">fsal_internal_posix2posixdb_fileinfo()</a>, and <a class="el" href="fsal__lookup_8c-source.html#l00050">FSAL_lookup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="fsal_convert.c::posixdb2fsal_error"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">fsal_status_t posixdb2fsal_error           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">fsal_posixdb_status_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>statusdb</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Concert fsal_posixdb_status_t to fsal_status_t 
<p>
Definition at line <a class="el" href="fsal__convert_8c-source.html#l00518">518</a> of file <a class="el" href="fsal__convert_8c-source.html">fsal_convert.c</a>.
<p>
Referenced by <a class="el" href="fsal__internal_8c-source.html#l00703">fsal_internal_getInfoFromChildrenList()</a>, <a class="el" href="fsal__internal_8c-source.html#l00638">fsal_internal_getInfoFromName()</a>, <a class="el" href="fsal__internal_8c-source.html#l00534">fsal_internal_getPathFromHandle()</a>, <a class="el" href="fsal__dirs_8c-source.html#l00157">FSAL_readdir()</a>, <a class="el" href="fsal__rename_8c-source.html#l00059">FSAL_rename()</a>, and <a class="el" href="fsal__unlink_8c-source.html#l00046">FSAL_unlink()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="fsal_convert.c::unix2fsal_mode"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">fsal_accessmode_t unix2fsal_mode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">mode_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>unix_mode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
unix2fsal_mode: Convert posix mode to FSAL mode.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>unix_mode</em>&nbsp;</td><td>(input): The posix mode to be translated.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The FSAL mode associated to unix_mode. </dd></dl>

<p>
Definition at line <a class="el" href="fsal__convert_8c-source.html#l00296">296</a> of file <a class="el" href="fsal__convert_8c-source.html">fsal_convert.c</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Wed Apr 9 08:24:45 2008 for File System Abstraction Layer (POSIX) library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
