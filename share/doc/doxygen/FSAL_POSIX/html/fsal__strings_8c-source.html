<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>File System Abstraction Layer (POSIX) library: fsal_strings.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>fsal_strings.c</h1><a href="fsal__strings_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> * vim:expandtab:shiftwidth=8:tabstop=8:</span>
00003 <span class="comment"> */</span>
00004 
00013 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
00014 <span class="preprocessor"></span><span class="preprocessor">#include "config.h"</span>
00015 <span class="preprocessor">#endif</span>
00016 <span class="preprocessor"></span>
00017 <span class="preprocessor">#include "fsal.h"</span>
00018 <span class="preprocessor">#include "fsal_internal.h"</span>
00019 <span class="preprocessor">#include &lt;string.h&gt;</span>
00020 
00021 
00022 
<a name="l00047"></a><a class="code" href="group__FSALNameFunctions.html#ga0">00047</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga0">FSAL_str2name</a>(
00048       <span class="keyword">const</span> <span class="keywordtype">char</span>     * string ,        <span class="comment">/* IN */</span>
00049       fsal_mdsize_t  in_str_maxlen ,   <span class="comment">/* IN */</span>
00050       fsal_name_t    * name            <span class="comment">/* OUT */</span>
00051     ){
00052     
00053   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
00054   <span class="keywordtype">char</span> * output;
00055 
00056   <span class="comment">/* sanity checks */</span>
00057   <span class="keywordflow">if</span> (!name || !string ) ReturnCode( ERR_FSAL_FAULT ,0 );
00058 
00059   output = (*name).name;
00060   
00061   <span class="comment">/* computes input strlen */</span>
00062   <span class="keywordflow">for</span> (i=0;(i&lt;in_str_maxlen) &amp;&amp; (string[i] != <span class="charliteral">'\0'</span>);i++);
00063   
00064   <span class="comment">/* the value of i doesn't include terminating '\0',</span>
00065 <span class="comment">   * thus, FSAL_MAX_NAME_LEN is excluded.</span>
00066 <span class="comment">   */</span>
00067   <span class="keywordflow">if</span> (i &gt;= FSAL_MAX_NAME_LEN ) ReturnCode( ERR_FSAL_NAMETOOLONG ,0 );
00068   
00069   (*name).len=i;
00070 
00071   <span class="comment">/* copies the string */</span>
00072   <span class="keywordflow">for</span> (i=0;i&lt;(*name).len;i++){ output[i] = string[i]; }
00073   <span class="comment">/* sets the terminating \0 */</span>
00074   output[i]=<span class="charliteral">'\0'</span>;
00075   
00076   ReturnCode( ERR_FSAL_NO_ERROR , 0 ) ;
00077     
00078 }
00079 
00080 
<a name="l00097"></a><a class="code" href="group__FSALNameFunctions.html#ga1">00097</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga1">FSAL_str2path</a>(
00098       <span class="keywordtype">char</span>           * string ,        <span class="comment">/* IN */</span>
00099       fsal_mdsize_t  in_str_maxlen ,   <span class="comment">/* IN */</span>
00100       fsal_path_t    * p_path            <span class="comment">/* OUT */</span>
00101     ){
00102     
00103   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
00104   <span class="keywordtype">char</span> * output;
00105 
00106   <span class="comment">/* sanity checks */</span>
00107   <span class="keywordflow">if</span> (!p_path || !string ) ReturnCode( ERR_FSAL_FAULT ,0);
00108 
00109   output = p_path-&gt;path;
00110   
00111   <span class="comment">/* computes input strlen */</span>
00112   <span class="keywordflow">for</span> (i=0;(i&lt;in_str_maxlen) &amp;&amp; (string[i] != <span class="charliteral">'\0'</span>);i++);
00113   
00114   <span class="comment">/* the value of i doesn't include terminating '\0',</span>
00115 <span class="comment">   * thus, FSAL_MAX_PATH_LEN is excluded.</span>
00116 <span class="comment">   */</span>
00117   <span class="keywordflow">if</span> (i &gt;= FSAL_MAX_PATH_LEN ) ReturnCode( ERR_FSAL_NAMETOOLONG ,0);
00118   
00119   p_path-&gt;len=i;
00120   
00121   <span class="comment">/* copies the string */</span>
00122   <span class="keywordflow">for</span> (i=0;i&lt;p_path-&gt;len;i++){ output[i] = string[i]; }
00123   <span class="comment">/* sets the terminating \0 */</span>
00124   output[i]=<span class="charliteral">'\0'</span>;
00125   
00126   ReturnCode( ERR_FSAL_NO_ERROR , 0 );
00127     
00128 }
00129 
00130 
<a name="l00147"></a><a class="code" href="group__FSALNameFunctions.html#ga2">00147</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga2">FSAL_name2str</a>(
00148       fsal_name_t * p_name,              <span class="comment">/* IN */</span>
00149       <span class="keywordtype">char</span>        * string ,         <span class="comment">/* OUT */</span>
00150       fsal_mdsize_t  out_str_maxlen   <span class="comment">/* IN */</span>
00151     ){
00152     
00153     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
00154     <span class="keywordtype">char</span> * input;
00155     
00156     <span class="comment">/* sanity checks */</span>
00157     <span class="keywordflow">if</span> (!string || !p_name ) ReturnCode( ERR_FSAL_FAULT ,0);
00158     
00159     input = p_name-&gt;name;
00160     
00161     i = p_name-&gt;len;
00162     
00163     <span class="comment">/* the value of i doesn't include terminating '\0',</span>
00164 <span class="comment">     * thus, last value is excluded.</span>
00165 <span class="comment">     */</span>
00166     <span class="keywordflow">if</span> (i &gt;= out_str_maxlen )
00167       ReturnCode( ERR_FSAL_TOOSMALL ,0);
00168     
00169     <span class="comment">/* copies the value */</span>
00170     strncpy( string, input, out_str_maxlen );    
00171     
00172     ReturnCode( ERR_FSAL_NO_ERROR , 0 );
00173 }
00174 
00175 
<a name="l00192"></a><a class="code" href="group__FSALNameFunctions.html#ga3">00192</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga3">FSAL_path2str</a>(
00193       fsal_path_t * p_path,          <span class="comment">/* IN */</span>
00194       <span class="keywordtype">char</span>        * string ,         <span class="comment">/* OUT */</span>
00195       fsal_mdsize_t  out_str_maxlen   <span class="comment">/* IN */</span>
00196     ){
00197     
00198     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
00199     <span class="keywordtype">char</span> * input;        
00200     
00201     <span class="comment">/* sanity checks */</span>
00202     <span class="keywordflow">if</span> (!string || !p_path) ReturnCode( ERR_FSAL_FAULT ,0);
00203     
00204     input = p_path-&gt;path;
00205     
00206     i = p_path-&gt;len;
00207     
00208     <span class="comment">/* the value of i doesn't include terminating '\0',</span>
00209 <span class="comment">     * thus, last value is excluded.</span>
00210 <span class="comment">     */</span>
00211     <span class="keywordflow">if</span> (i &gt;= out_str_maxlen )
00212       ReturnCode( ERR_FSAL_TOOSMALL ,0);
00213     
00214     <span class="comment">/* copies the value */</span>
00215     strncpy( string, input, out_str_maxlen );    
00216     
00217     ReturnCode( ERR_FSAL_NO_ERROR , 0 );
00218 }
00219 
00220 
<a name="l00227"></a><a class="code" href="group__FSALNameFunctions.html#ga4">00227</a> <span class="keywordtype">int</span> <a class="code" href="group__FSALNameFunctions.html#ga4">FSAL_namecmp</a>( fsal_name_t * p_name1, fsal_name_t * p_name2 ){
00228   
00229   <span class="keywordflow">return</span> (strncmp( p_name1-&gt;name , p_name2-&gt;name , FSAL_MAX_NAME_LEN ));
00230   
00231 }
00232 
00233 
<a name="l00240"></a><a class="code" href="group__FSALNameFunctions.html#ga5">00240</a> <span class="keywordtype">int</span> <a class="code" href="group__FSALNameFunctions.html#ga5">FSAL_pathcmp</a>( fsal_path_t * p_path1, fsal_path_t * p_path2 ){
00241   
00242   <span class="keywordflow">return</span> (strncmp( p_path1-&gt;path , p_path2-&gt;path , FSAL_MAX_PATH_LEN ));    
00243   
00244 }
00245 
00246 
<a name="l00255"></a><a class="code" href="group__FSALNameFunctions.html#ga6">00255</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga6">FSAL_namecpy</a>( fsal_name_t * p_tgt_name, fsal_name_t * p_src_name ){
00256   
00257     <span class="keywordtype">char</span> * output;
00258     
00259     <span class="comment">/* sanity check */</span>
00260     <span class="keywordflow">if</span> (!p_tgt_name || !p_src_name) ReturnCode( ERR_FSAL_FAULT ,0);
00261     
00262     output = p_tgt_name-&gt;name;
00263     
00264     <span class="comment">/* copy */</span>
00265     strncpy(output, p_src_name-&gt;name,FSAL_MAX_NAME_LEN);
00266     
00267     p_tgt_name-&gt;len = p_src_name-&gt;len;
00268     
00269     ReturnCode(ERR_FSAL_NO_ERROR,0);
00270     
00271 }
00272 
00273 
<a name="l00282"></a><a class="code" href="group__FSALNameFunctions.html#ga7">00282</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga7">FSAL_pathcpy</a>( fsal_path_t * p_tgt_path, fsal_path_t * p_src_path ){
00283   
00284     <span class="keywordtype">char</span> * output;
00285     
00286     <span class="comment">/* sanity check */</span>
00287     <span class="keywordflow">if</span> (!p_tgt_path || !p_src_path) ReturnCode( ERR_FSAL_FAULT ,0);
00288     
00289     output = p_tgt_path-&gt;path;
00290     
00291     <span class="comment">/* copy */</span>
00292     strncpy(output, p_src_path-&gt;path,FSAL_MAX_PATH_LEN);
00293     
00294     p_tgt_path-&gt;len = p_src_path-&gt;len;
00295     
00296     ReturnCode(ERR_FSAL_NO_ERROR,0);
00297     
00298 }
00299 
00300 
<a name="l00305"></a><a class="code" href="group__FSALNameFunctions.html#ga8">00305</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga8">FSAL_buffdesc2name</a>( fsal_buffdesc_t * in_buf,
00306                                   fsal_name_t * out_name ){
00307   
00308   <span class="keywordflow">if</span> (!in_buf || !out_name)
00309         ReturnCode( ERR_FSAL_FAULT ,0);
00310   
00311   <span class="keywordflow">return</span> <a class="code" href="group__FSALNameFunctions.html#ga0">FSAL_str2name</a>(in_buf-&gt;pointer,in_buf-&gt;len,out_name);
00312   
00313 }
00314   
00315 
<a name="l00320"></a><a class="code" href="group__FSALNameFunctions.html#ga9">00320</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga9">FSAL_buffdesc2path</a>(fsal_buffdesc_t * in_buf,fsal_path_t * out_path){
00321   
00322     <span class="keywordflow">if</span> (!in_buf || !out_path)
00323         ReturnCode( ERR_FSAL_FAULT ,0);
00324   
00325   <span class="keywordflow">return</span> <a class="code" href="group__FSALNameFunctions.html#ga1">FSAL_str2path</a>(in_buf-&gt;pointer,in_buf-&gt;len,out_path);
00326 
00327 }
00328 
00329 
00330 
<a name="l00345"></a><a class="code" href="group__FSALNameFunctions.html#ga10">00345</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga10">FSAL_path2buffdesc</a>(fsal_path_t * in_path, fsal_buffdesc_t * out_buff){
00346     
00347   <span class="keywordflow">if</span> (!out_buff || !in_path)
00348       ReturnCode( ERR_FSAL_FAULT ,0);
00349   
00350   out_buff-&gt;pointer = in_path-&gt;path;
00351   out_buff-&gt;len     = in_path-&gt;len;
00352   
00353   ReturnCode(ERR_FSAL_NO_ERROR,0);
00354   
00355 }
00356 
00357 
00358 
<a name="l00373"></a><a class="code" href="group__FSALNameFunctions.html#ga11">00373</a> fsal_status_t <a class="code" href="group__FSALNameFunctions.html#ga11">FSAL_name2buffdesc</a>(fsal_name_t * in_name, fsal_buffdesc_t * out_buff){
00374     
00375   <span class="keywordflow">if</span> (!out_buff || !in_name)
00376       ReturnCode( ERR_FSAL_FAULT ,0);
00377   
00378   out_buff-&gt;pointer = in_name-&gt;name;
00379   out_buff-&gt;len     = in_name-&gt;len;
00380   
00381   ReturnCode(ERR_FSAL_NO_ERROR,0);
00382   
00383 }
00384 
00385 
00386 
00387 
00388 
00389 
00390 <span class="comment">/* @} */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 9 08:24:45 2008 for File System Abstraction Layer (POSIX) library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
