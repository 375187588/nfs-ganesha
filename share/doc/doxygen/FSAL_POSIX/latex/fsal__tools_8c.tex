\section{fsal\_\-tools.c File Reference}
\label{fsal__tools_8c}\index{fsal\_\-tools.c@{fsal\_\-tools.c}}


miscelaneous FSAL tools.  
{\ttfamily \#include \char`\"{}fsal.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}fsal\_\-internal.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}fsal\_\-convert.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}config\_\-parsing.h\char`\"{}}\par
{\ttfamily \#include $<$string.h$>$}\par
\subsection*{Defines}
\begin{DoxyCompactItemize}
\item 
\#define {\bfseries STRCMP}~strcasecmp\label{fsal__tools_8c_a1ffef5879101d778f17a377e0d8b0e00}

\item 
\#define {\bfseries MAGIC}~0xABCD1234\label{fsal__tools_8c_a94630370ae389fb1189282fa0742f310}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
char $\ast$ {\bfseries POSIXFSAL\_\-GetFSName} ()\label{fsal__tools_8c_a324a82f014b71f45f4098fb75ea5c4da}

\item 
int {\bf POSIXFSAL\_\-handlecmp} (posixfsal\_\-handle\_\-t $\ast$handle1, posixfsal\_\-handle\_\-t $\ast$handle2, fsal\_\-status\_\-t $\ast$status)
\item 
unsigned int {\bf POSIXFSAL\_\-Handle\_\-to\_\-HashIndex} (posixfsal\_\-handle\_\-t $\ast$p\_\-handle, unsigned int cookie, unsigned int alphabet\_\-len, unsigned int index\_\-size)
\item 
unsigned int {\bfseries POSIXFSAL\_\-Handle\_\-to\_\-RBTIndex} (posixfsal\_\-handle\_\-t $\ast$p\_\-handle, unsigned int cookie)\label{fsal__tools_8c_aecf3b3cd8dbb5924833203c5b24b8b0d}

\item 
fsal\_\-status\_\-t {\bf POSIXFSAL\_\-DigestHandle} (posixfsal\_\-export\_\-context\_\-t $\ast$p\_\-expcontext, fsal\_\-digesttype\_\-t output\_\-type, posixfsal\_\-handle\_\-t $\ast$p\_\-in\_\-fsal\_\-handle, caddr\_\-t out\_\-buff)
\item 
fsal\_\-status\_\-t {\bf POSIXFSAL\_\-ExpandHandle} (posixfsal\_\-export\_\-context\_\-t $\ast$p\_\-expcontext, fsal\_\-digesttype\_\-t in\_\-type, caddr\_\-t in\_\-buff, posixfsal\_\-handle\_\-t $\ast$p\_\-out\_\-fsal\_\-handle)
\item 
fsal\_\-status\_\-t {\bf POSIXFSAL\_\-SetDefault\_\-FSAL\_\-parameter} (fsal\_\-parameter\_\-t $\ast$out\_\-parameter)
\item 
fsal\_\-status\_\-t {\bfseries POSIXFSAL\_\-SetDefault\_\-FS\_\-common\_\-parameter} (fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_a6cd1e0339345aed1e88242605663d40e}

\item 
fsal\_\-status\_\-t {\bfseries POSIXFSAL\_\-SetDefault\_\-FS\_\-specific\_\-parameter} (fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_a50497a5e37e20bce50d878fadca55d0d}

\item 
fsal\_\-status\_\-t {\bf POSIXFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf} (config\_\-file\_\-t in\_\-config, fsal\_\-parameter\_\-t $\ast$out\_\-parameter)
\item 
fsal\_\-status\_\-t {\bfseries POSIXFSAL\_\-load\_\-FS\_\-common\_\-parameter\_\-from\_\-conf} (config\_\-file\_\-t in\_\-config, fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_a2ae9686d74bc463094c554ab923b09bb}

\item 
fsal\_\-status\_\-t {\bfseries POSIXFSAL\_\-load\_\-FS\_\-specific\_\-parameter\_\-from\_\-conf} (config\_\-file\_\-t in\_\-config, fsal\_\-parameter\_\-t $\ast$out\_\-parameter)\label{fsal__tools_8c_a19624abbe83b7d54b423ae11541ebe05}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
miscelaneous FSAL tools. \begin{DoxyAuthor}{Author}

\end{DoxyAuthor}
Author}
leibovic \begin{DoxyDate}{Date}

\end{DoxyDate}
Date}
2006/01/17 14:20:07 \begin{DoxyVersion}{Version}

\end{DoxyVersion}
Revision}
1.26 

Definition in file {\bf fsal\_\-tools.c}.

\subsection{Function Documentation}
\index{fsal\_\-tools.c@{fsal\_\-tools.c}!POSIXFSAL\_\-DigestHandle@{POSIXFSAL\_\-DigestHandle}}
\index{POSIXFSAL\_\-DigestHandle@{POSIXFSAL\_\-DigestHandle}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{POSIXFSAL\_\-DigestHandle}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t POSIXFSAL\_\-DigestHandle (posixfsal\_\-export\_\-context\_\-t $\ast$ {\em p\_\-expcontext}, \/  fsal\_\-digesttype\_\-t {\em output\_\-type}, \/  posixfsal\_\-handle\_\-t $\ast$ {\em p\_\-in\_\-fsal\_\-handle}, \/  caddr\_\-t {\em out\_\-buff})}\label{fsal__tools_8c_a8a0c070f47dfcf8aa4195bc87e4e006d}
FSAL\_\-DigestHandle : Convert an posixfsal\_\-handle\_\-t to a buffer to be included into NFS handles, or another digest.


\begin{DoxyParams}{Parameters}
\item[{\em output\_\-type}](input): Indicates the type of digest to do. \item[{\em in\_\-fsal\_\-handle}](input): The handle to be converted to digest. \item[{\em out\_\-buff}](output): The buffer where the digest is to be stored.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The major code is ERR\_\-FSAL\_\-NO\_\-ERROR is no error occured. Else, it is a non null value. 
\end{DoxyReturn}


Definition at line 124 of file fsal\_\-tools.c.\index{fsal\_\-tools.c@{fsal\_\-tools.c}!POSIXFSAL\_\-ExpandHandle@{POSIXFSAL\_\-ExpandHandle}}
\index{POSIXFSAL\_\-ExpandHandle@{POSIXFSAL\_\-ExpandHandle}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{POSIXFSAL\_\-ExpandHandle}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t POSIXFSAL\_\-ExpandHandle (posixfsal\_\-export\_\-context\_\-t $\ast$ {\em p\_\-expcontext}, \/  fsal\_\-digesttype\_\-t {\em in\_\-type}, \/  caddr\_\-t {\em in\_\-buff}, \/  posixfsal\_\-handle\_\-t $\ast$ {\em p\_\-out\_\-fsal\_\-handle})}\label{fsal__tools_8c_a45eaa2cbdc441d03d1ff332c077fec55}
FSAL\_\-ExpandHandle : Convert a buffer extracted from NFS handles to an FSAL handle.


\begin{DoxyParams}{Parameters}
\item[{\em in\_\-type}](input): Indicates the type of digest to be expanded. \item[{\em in\_\-buff}](input): Pointer to the digest to be expanded. \item[{\em out\_\-fsal\_\-handle}](output): The handle built from digest.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The major code is ERR\_\-FSAL\_\-NO\_\-ERROR is no error occured. Else, it is a non null value. 
\end{DoxyReturn}


Definition at line 252 of file fsal\_\-tools.c.\index{fsal\_\-tools.c@{fsal\_\-tools.c}!POSIXFSAL\_\-Handle\_\-to\_\-HashIndex@{POSIXFSAL\_\-Handle\_\-to\_\-HashIndex}}
\index{POSIXFSAL\_\-Handle\_\-to\_\-HashIndex@{POSIXFSAL\_\-Handle\_\-to\_\-HashIndex}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{POSIXFSAL\_\-Handle\_\-to\_\-HashIndex}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int POSIXFSAL\_\-Handle\_\-to\_\-HashIndex (posixfsal\_\-handle\_\-t $\ast$ {\em p\_\-handle}, \/  unsigned int {\em cookie}, \/  unsigned int {\em alphabet\_\-len}, \/  unsigned int {\em index\_\-size})}\label{fsal__tools_8c_aa712ec523b7817a56f1a9f3f3182143a}
FSAL\_\-Handle\_\-to\_\-HashIndex This function is used for hashing a FSAL handle in order to dispatch entries into the hash table array.


\begin{DoxyParams}{Parameters}
\item[{\em p\_\-handle}]The handle to be hashed \item[{\em cookie}]Makes it possible to have different hash value for the same handle, when cookie changes. \item[{\em alphabet\_\-len}]Parameter for polynomial hashing algorithm \item[{\em index\_\-size}]The range of hash value will be [0..index\_\-size-\/1]\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The hash value 
\end{DoxyReturn}


Definition at line 77 of file fsal\_\-tools.c.\index{fsal\_\-tools.c@{fsal\_\-tools.c}!POSIXFSAL\_\-handlecmp@{POSIXFSAL\_\-handlecmp}}
\index{POSIXFSAL\_\-handlecmp@{POSIXFSAL\_\-handlecmp}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{POSIXFSAL\_\-handlecmp}]{\setlength{\rightskip}{0pt plus 5cm}int POSIXFSAL\_\-handlecmp (posixfsal\_\-handle\_\-t $\ast$ {\em handle1}, \/  posixfsal\_\-handle\_\-t $\ast$ {\em handle2}, \/  fsal\_\-status\_\-t $\ast$ {\em status})}\label{fsal__tools_8c_a53cbe2e91a4c6255f9c86ea2152642d3}
FSAL\_\-handlecmp: Compare 2 handles.


\begin{DoxyParams}{Parameters}
\item[{\em handle1}](input): The first handle to be compared. \item[{\em handle2}](input): The second handle to be compared. \item[{\em status}](output): The status of the compare operation.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/ 0 if handles are the same.
\begin{DoxyItemize}
\item A non null value else.
\item Segfault if status is a NULL pointer. 
\end{DoxyItemize}
\end{DoxyReturn}


Definition at line 47 of file fsal\_\-tools.c.

Referenced by POSIXFSAL\_\-rename().\index{fsal\_\-tools.c@{fsal\_\-tools.c}!POSIXFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf@{POSIXFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf}}
\index{POSIXFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf@{POSIXFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{POSIXFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t POSIXFSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf (config\_\-file\_\-t {\em in\_\-config}, \/  fsal\_\-parameter\_\-t $\ast$ {\em out\_\-parameter})}\label{fsal__tools_8c_a2bc09c4ddffe8e6add848bccb0d57d0e}
FSAL\_\-load\_\-FSAL\_\-parameter\_\-from\_\-conf, FSAL\_\-load\_\-FS\_\-common\_\-parameter\_\-from\_\-conf, FSAL\_\-load\_\-FS\_\-specific\_\-parameter\_\-from\_\-conf:

Those functions initialize the FSAL init parameter structure from a configuration structure.


\begin{DoxyParams}{Parameters}
\item[{\em in\_\-config}](input): Structure that represents the parsed configuration file. \item[{\em out\_\-parameter}](ouput) FSAL initialization structure filled according to the configuration file given as parameter.\end{DoxyParams}
\begin{DoxyReturn}{Returns}
ERR\_\-FSAL\_\-NO\_\-ERROR (no error) , ERR\_\-FSAL\_\-NOENT (missing a mandatory stanza in config file), ERR\_\-FSAL\_\-INVAL (invalid parameter), ERR\_\-FSAL\_\-SERVERFAULT (unexpected error) ERR\_\-FSAL\_\-FAULT (null pointer given as parameter), 
\end{DoxyReturn}


Definition at line 403 of file fsal\_\-tools.c.\index{fsal\_\-tools.c@{fsal\_\-tools.c}!POSIXFSAL\_\-SetDefault\_\-FSAL\_\-parameter@{POSIXFSAL\_\-SetDefault\_\-FSAL\_\-parameter}}
\index{POSIXFSAL\_\-SetDefault\_\-FSAL\_\-parameter@{POSIXFSAL\_\-SetDefault\_\-FSAL\_\-parameter}!fsal_tools.c@{fsal\_\-tools.c}}
\subsubsection[{POSIXFSAL\_\-SetDefault\_\-FSAL\_\-parameter}]{\setlength{\rightskip}{0pt plus 5cm}fsal\_\-status\_\-t POSIXFSAL\_\-SetDefault\_\-FSAL\_\-parameter (fsal\_\-parameter\_\-t $\ast$ {\em out\_\-parameter})}\label{fsal__tools_8c_a1440e292731f296ff0fb04f16d6a3501}
Those routines set the default parameters for FSAL init structure. \begin{DoxyReturn}{Returns}
ERR\_\-FSAL\_\-NO\_\-ERROR (no error) , ERR\_\-FSAL\_\-FAULT (null pointer given as parameter), ERR\_\-FSAL\_\-SERVERFAULT (unexpected error) 
\end{DoxyReturn}


Definition at line 299 of file fsal\_\-tools.c.