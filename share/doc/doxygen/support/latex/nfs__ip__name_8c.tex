\section{nfs\_\-ip\_\-name.c File Reference}
\label{nfs__ip__name_8c}\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
The management of the IP/name cache. 

{\tt \#include \char`\"{}Hash\-Data.h\char`\"{}}\par
{\tt \#include \char`\"{}Hash\-Table.h\char`\"{}}\par
{\tt \#include \char`\"{}log\_\-functions.h\char`\"{}}\par
{\tt \#include \char`\"{}stuff\_\-alloc.h\char`\"{}}\par
{\tt \#include \char`\"{}nfs\_\-core.h\char`\"{}}\par
{\tt \#include \char`\"{}nfs\_\-exports.h\char`\"{}}\par
{\tt \#include \char`\"{}config\_\-parsing.h\char`\"{}}\par
{\tt \#include $<$stdlib.h$>$}\par
{\tt \#include $<$string.h$>$}\par
{\tt \#include $<$sys/socket.h$>$}\par
{\tt \#include $<$netinet/in.h$>$}\par
{\tt \#include $<$arpa/inet.h$>$}\par
\subsection*{Functions}
\begin{CompactItemize}
\item 
unsigned long int {\bf ip\_\-name\_\-value\_\-hash\_\-func} (hash\_\-parameter\_\-t $\ast$p\_\-hparam, hash\_\-buffer\_\-t $\ast$buffclef)
\item 
unsigned long int {\bf ip\_\-name\_\-rbt\_\-hash\_\-func} (hash\_\-parameter\_\-t $\ast$p\_\-hparam, hash\_\-buffer\_\-t $\ast$buffclef)
\item 
int {\bf compare\_\-ip\_\-name} (hash\_\-buffer\_\-t $\ast$buff1, hash\_\-buffer\_\-t $\ast$buff2)
\item 
int {\bf display\_\-ip\_\-name} (hash\_\-buffer\_\-t $\ast$pbuff, char $\ast$str)
\item 
int {\bf display\_\-ip\_\-value} (hash\_\-buffer\_\-t $\ast$pbuff, char $\ast$str)
\item 
int {\bf nfs\_\-ip\_\-name\_\-add} (unsigned int ipaddr, char $\ast$hostname)
\item 
int {\bf nfs\_\-ip\_\-name\_\-get} (unsigned int ipaddr, char $\ast$hostname)
\item 
int {\bf nfs\_\-ip\_\-name\_\-remove} (int ipaddr)
\item 
int {\bf nfs\_\-Init\_\-ip\_\-name} (nfs\_\-ip\_\-name\_\-parameter\_\-t param)
\item 
int {\bf nfs\_\-ip\_\-name\_\-populate} (char $\ast$path)
\item 
void {\bf nfs\_\-ip\_\-name\_\-get\_\-stats} (hash\_\-stat\_\-t $\ast$phstat)
\end{CompactItemize}
\subsection*{Variables}
\begin{CompactItemize}
\item 
hash\_\-table\_\-t $\ast$ {\bf ht\_\-ip\_\-name}
\item 
nfs\_\-parameter\_\-t {\bf nfs\_\-param}
\item 
unsigned int {\bf expiration\_\-time}
\end{CompactItemize}


\subsection{Detailed Description}
The management of the IP/name cache. 

\begin{Desc}
\item[Author:]\begin{Desc}
\item[Author]leibovic \end{Desc}
\end{Desc}
\begin{Desc}
\item[Date:]\begin{Desc}
\item[Date]2006/01/20 07:39:23 \end{Desc}
\end{Desc}
\begin{Desc}
\item[Version:]\begin{Desc}
\item[Revision]1.6 \end{Desc}
\end{Desc}
{\bf nfs\_\-ip\_\-name.c}{\rm (p.\,\pageref{nfs__ip__name_8c})} : The management of the IP/name cache.

\begin{Desc}
\item[Header]/cea/S/home/cvs/cvs/SHERPA/Base\-Cvs/GANESHA/src/support/nfs\_\-ip\_\-name.c,v 1.6 2006/01/20 07:39:23 leibovic Exp \end{Desc}


\begin{Desc}
\item[Log]{\bf nfs\_\-ip\_\-name.c}{\rm (p.\,\pageref{nfs__ip__name_8c})},v \end{Desc}
Revision 1.6 2006/01/20 07:39:23 leibovic Back to the previous version.

Revision 1.4 2005/11/28 17:03:03 deniel Added Ce\-CILL headers

Revision 1.3 2005/11/24 13:44:29 deniel ajout du remove dans ipname track list in nfs\_\-mnt\_\-listc.

Revision 1.2 2005/11/10 07:53:25 deniel Corrected some memory leaks

Revision 1.1 2005/11/08 15:22:24 deniel Wild\-Card and Netgroup entry for exportlist are now supported

Definition in file {\bf nfs\_\-ip\_\-name.c}.

\subsection{Function Documentation}
\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!compare_ip_name@{compare\_\-ip\_\-name}}
\index{compare_ip_name@{compare\_\-ip\_\-name}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int compare\_\-ip\_\-name (hash\_\-buffer\_\-t $\ast$ {\em buff1}, hash\_\-buffer\_\-t $\ast$ {\em buff2})}\label{nfs__ip__name_8c_a5}


compare\_\-ip\_\-name: compares the ip address stored in the key buffers.

compare the ip address stored in the key buffers. This function is to be used as 'compare\_\-key' field in the hashtable storing the nfs duplicated requests.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em buff1}][IN] first key \item[{\em buff2}][IN] second key\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]0 if keys are identifical, 1 if they are different. \end{Desc}


Definition at line 187 of file nfs\_\-ip\_\-name.c.\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!display_ip_name@{display\_\-ip\_\-name}}
\index{display_ip_name@{display\_\-ip\_\-name}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int display\_\-ip\_\-name (hash\_\-buffer\_\-t $\ast$ {\em pbuff}, char $\ast$ {\em str})}\label{nfs__ip__name_8c_a6}


display\_\-ip\_\-name: displays the ip\_\-name stored in the buffer.

displays the ip\_\-name stored in the buffer. This function is to be used as 'key\_\-to\_\-str' field in the hashtable storing the nfs duplicated requests.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em buff1}][IN] buffer to display \item[{\em buff2}][OUT] output string\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]number of character written. \end{Desc}


Definition at line 208 of file nfs\_\-ip\_\-name.c.\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!display_ip_value@{display\_\-ip\_\-value}}
\index{display_ip_value@{display\_\-ip\_\-value}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int display\_\-ip\_\-value (hash\_\-buffer\_\-t $\ast$ {\em pbuff}, char $\ast$ {\em str})}\label{nfs__ip__name_8c_a7}




Definition at line 220 of file nfs\_\-ip\_\-name.c.\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!ip_name_rbt_hash_func@{ip\_\-name\_\-rbt\_\-hash\_\-func}}
\index{ip_name_rbt_hash_func@{ip\_\-name\_\-rbt\_\-hash\_\-func}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}unsigned long int ip\_\-name\_\-rbt\_\-hash\_\-func (hash\_\-parameter\_\-t $\ast$ {\em p\_\-hparam}, hash\_\-buffer\_\-t $\ast$ {\em buffclef})}\label{nfs__ip__name_8c_a4}


ip\_\-name\_\-rbt\_\-hash\_\-func: computes the rbt value for the entry in IP/name cache.

Computes the rbt value for the entry in IP/name cache. In fact, it just use the address value itself (which is an unsigned integer) as the rbt value. This function is called internal in the Has\-Table\_\-$\ast$ function

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em hparam}][IN] hash table parameter. \item[{\em buffcleff\mbox{[}in\mbox{]}}]pointer to the hash key buffer\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]the computed rbt value.\end{Desc}
\begin{Desc}
\item[See also:]Hash\-Table\_\-Init \end{Desc}


Definition at line 168 of file nfs\_\-ip\_\-name.c.\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!ip_name_value_hash_func@{ip\_\-name\_\-value\_\-hash\_\-func}}
\index{ip_name_value_hash_func@{ip\_\-name\_\-value\_\-hash\_\-func}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}unsigned long int ip\_\-name\_\-value\_\-hash\_\-func (hash\_\-parameter\_\-t $\ast$ {\em p\_\-hparam}, hash\_\-buffer\_\-t $\ast$ {\em buffclef})}\label{nfs__ip__name_8c_a3}


ip\_\-name\_\-rbt\_\-hash\_\-func: computes the hash value for the entry in IP/name cache.

Computes the hash value for the entry in IP/name cache. In fact, it just use addresse as value (identity function) modulo the size of the hash. This function is called internal in the Has\-Table\_\-$\ast$ function

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em hparam}][IN] hash table parameter. \item[{\em buffcleff\mbox{[}in\mbox{]}}]pointer to the hash key buffer\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]the computed hash value.\end{Desc}
\begin{Desc}
\item[See also:]Hash\-Table\_\-Init \end{Desc}


Definition at line 146 of file nfs\_\-ip\_\-name.c.\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!nfs_Init_ip_name@{nfs\_\-Init\_\-ip\_\-name}}
\index{nfs_Init_ip_name@{nfs\_\-Init\_\-ip\_\-name}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int nfs\_\-Init\_\-ip\_\-name (nfs\_\-ip\_\-name\_\-parameter\_\-t {\em param})}\label{nfs__ip__name_8c_a11}


nfs\_\-Init\_\-ip\_\-name: Init the hashtable for IP/name cache.

Perform all the required initialization for hashtable IP/name cache

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em param}][IN] parameter used to init the ip name cache\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]0 if successful, -1 otherwise \end{Desc}


Definition at line 393 of file nfs\_\-ip\_\-name.c.

References expiration\_\-time, and ht\_\-ip\_\-name.\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!nfs_ip_name_add@{nfs\_\-ip\_\-name\_\-add}}
\index{nfs_ip_name_add@{nfs\_\-ip\_\-name\_\-add}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int nfs\_\-ip\_\-name\_\-add (unsigned int {\em ipaddr}, char $\ast$ {\em hostname})}\label{nfs__ip__name_8c_a8}


nfs\_\-ip\_\-name\_\-add: adds an entry in the duplicate requests cache.

Adds an entry in the duplicate requests cache.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ipaddr}][IN] the ipaddr to be used as key \item[{\em hostname}][IN] the hostname added (found by using gethostbyaddr)\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]IP\_\-NAME\_\-SUCCESS if successfull\par
. 

IP\_\-NAME\_\-INSERT\_\-MALLOC\_\-ERROR if an error occured during the insertion process \par
 

IP\_\-NAME\_\-NETDB\_\-ERROR if an error occured during the netdb query (via gethostbyaddr). \end{Desc}


Definition at line 249 of file nfs\_\-ip\_\-name.c.

References ht\_\-ip\_\-name.

Referenced by nfs\_\-export\_\-check\_\-access().\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!nfs_ip_name_get@{nfs\_\-ip\_\-name\_\-get}}
\index{nfs_ip_name_get@{nfs\_\-ip\_\-name\_\-get}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int nfs\_\-ip\_\-name\_\-get (unsigned int {\em ipaddr}, char $\ast$ {\em hostname})}\label{nfs__ip__name_8c_a9}


nfs\_\-ip\_\-name\_\-get: Tries to get an entry for ip\_\-name cache.

Tries to get an entry for ip\_\-name cache.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ipaddr}][IN] the ip address requested \item[{\em hostname}][OUT] the hostname\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]the result previously set if $\ast$pstatus == IP\_\-NAME\_\-SUCCESS \end{Desc}


Definition at line 318 of file nfs\_\-ip\_\-name.c.

References ht\_\-ip\_\-name.

Referenced by nfs\_\-export\_\-check\_\-access().\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!nfs_ip_name_get_stats@{nfs\_\-ip\_\-name\_\-get\_\-stats}}
\index{nfs_ip_name_get_stats@{nfs\_\-ip\_\-name\_\-get\_\-stats}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void nfs\_\-ip\_\-name\_\-get\_\-stats (hash\_\-stat\_\-t $\ast$ {\em phstat})}\label{nfs__ip__name_8c_a13}


nfs\_\-ip\_\-name\_\-get\_\-stats: gets the hash table statistics for the IP\_\-NAME Table.

Gets the hash table statistics for the IP\_\-NAME Table.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em phstat}][OUT] pointer to the resulting stats.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]nothing (void function)\end{Desc}
\begin{Desc}
\item[See also:]Hash\-Table\_\-Get\-Stats \end{Desc}


Definition at line 505 of file nfs\_\-ip\_\-name.c.

References ht\_\-ip\_\-name.\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!nfs_ip_name_populate@{nfs\_\-ip\_\-name\_\-populate}}
\index{nfs_ip_name_populate@{nfs\_\-ip\_\-name\_\-populate}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int nfs\_\-ip\_\-name\_\-populate (char $\ast$ {\em path})}\label{nfs__ip__name_8c_a12}




Definition at line 408 of file nfs\_\-ip\_\-name.c.

References ht\_\-ip\_\-name.\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!nfs_ip_name_remove@{nfs\_\-ip\_\-name\_\-remove}}
\index{nfs_ip_name_remove@{nfs\_\-ip\_\-name\_\-remove}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int nfs\_\-ip\_\-name\_\-remove (int {\em ipaddr})}\label{nfs__ip__name_8c_a10}


nfs\_\-ip\_\-name\_\-remove: Tries to remove an entry for ip\_\-name cache

Tries to remove an entry for ip\_\-name cache.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ipaddr}][IN] the ip address to be uncached.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]the result previously set if $\ast$pstatus == IP\_\-NAME\_\-SUCCESS \end{Desc}


Definition at line 356 of file nfs\_\-ip\_\-name.c.

References ht\_\-ip\_\-name.

\subsection{Variable Documentation}
\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!expiration_time@{expiration\_\-time}}
\index{expiration_time@{expiration\_\-time}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}unsigned int {\bf expiration\_\-time}}\label{nfs__ip__name_8c_a2}




Definition at line 127 of file nfs\_\-ip\_\-name.c.

Referenced by nfs\_\-Init\_\-ip\_\-name().\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!ht_ip_name@{ht\_\-ip\_\-name}}
\index{ht_ip_name@{ht\_\-ip\_\-name}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}hash\_\-table\_\-t$\ast$ {\bf ht\_\-ip\_\-name}}\label{nfs__ip__name_8c_a0}




Definition at line 125 of file nfs\_\-ip\_\-name.c.

Referenced by nfs\_\-Init\_\-ip\_\-name(), nfs\_\-ip\_\-name\_\-add(), nfs\_\-ip\_\-name\_\-get(), nfs\_\-ip\_\-name\_\-get\_\-stats(), nfs\_\-ip\_\-name\_\-populate(), and nfs\_\-ip\_\-name\_\-remove().\index{nfs_ip_name.c@{nfs\_\-ip\_\-name.c}!nfs_param@{nfs\_\-param}}
\index{nfs_param@{nfs\_\-param}!nfs_ip_name.c@{nfs\_\-ip\_\-name.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}nfs\_\-parameter\_\-t {\bf nfs\_\-param}}\label{nfs__ip__name_8c_a1}




Definition at line 146 of file test\_\-clientid.c.