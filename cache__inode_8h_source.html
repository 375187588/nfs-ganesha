<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>nfs-ganesha: cache_inode.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">nfs-ganesha&#160;<span id="projectnumber">1.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>cache_inode.h</h1>  </div>
</div>
<div class="contents">
<a href="cache__inode_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Copyright CEA/DAM/DIF  (2008)</span>
<a name="l00005"></a>00005 <span class="comment"> * contributeur : Philippe DENIEL   philippe.deniel@cea.fr</span>
<a name="l00006"></a>00006 <span class="comment"> *                Thomas LEIBOVICI  thomas.leibovici@cea.fr</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l00010"></a>00010 <span class="comment"> * modify it under the terms of the GNU Lesser General Public License</span>
<a name="l00011"></a>00011 <span class="comment"> * as published by the Free Software Foundation; either version 3 of</span>
<a name="l00012"></a>00012 <span class="comment"> * the License, or (at your option) any later version.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * This program is distributed in the hope that it will be useful, but</span>
<a name="l00015"></a>00015 <span class="comment"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00016"></a>00016 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00017"></a>00017 <span class="comment"> * Lesser General Public License for more details.</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> * You should have received a copy of the GNU Lesser General Public</span>
<a name="l00020"></a>00020 <span class="comment"> * License along with this library; if not, write to the Free Software</span>
<a name="l00021"></a>00021 <span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span>
<a name="l00022"></a>00022 <span class="comment"> * 02110-1301 USA</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * ---------------------------------------</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 
<a name="l00036"></a>00036 <span class="preprocessor">#ifndef _CACHE_INODE_H</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span><span class="preprocessor">#define _CACHE_INODE_H</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;sys/param.h&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;time.h&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;pthread.h&gt;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="abstract__mem_8h.html" title="Abstract memory shims to allow swapping out allocators.">abstract_mem.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="HashData_8h.html">HashData.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="HashTable_8h.html" title="Header for hash functionality.">HashTable.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="avltree_8h.html">avltree.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="generic__weakref_8h.html" title="Generic weak reference package.">generic_weakref.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="fsal_8h.html" title="File System Abstraction Layer interface.">fsal.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="log_8h.html">log.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="config__parsing_8h.html">config_parsing.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="nfs23_8h.html">nfs23.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="nfs4_8h.html">nfs4.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#ifdef _USE_NLM</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="nlm4_8h.html">nlm4.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#endif</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="nlm__list_8h.html">nlm_list.h</a>&quot;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#ifdef _USE_NFS4_ACL</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="nfs4__acls_8h.html">nfs4_acls.h</a>&quot;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#endif </span><span class="comment">/* _USE_NFS4_ACL */</span>
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="keyword">extern</span> <a class="code" href="structhash__table.html">hash_table_t</a> *<a class="code" href="cache__inode_8h.html#aea4783fdf613711bce616cf9876ab62e">fh_to_cache_entry_ht</a>; <span class="comment">/*&lt; Global hash table for</span>
<a name="l00065"></a>00065 <span class="comment">                                               servicing lookups by</span>
<a name="l00066"></a>00066 <span class="comment">                                               fsal_handle_t. */</span>
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="comment">/* Forward references */</span>
<a name="l00069"></a><a class="code" href="cache__inode_8h.html#a3b6f3b3bd1ef014248ad9f077073486a">00069</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a>        <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a>;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> FILEHANDLE_MAX_LEN_V2 = 32; <span class="comment">/*&lt; Maximum size of NFSv2 handle */</span>
<a name="l00072"></a>00072 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> FILEHANDLE_MAX_LEN_V3 = 64; <span class="comment">/*&lt; Maximum size of NFSv3 handle */</span>
<a name="l00073"></a>00073 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> FILEHANDLE_MAX_LEN_V4 = 128; <span class="comment">/*&lt; Maximum size of NFSv4 handle */</span>
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> CACHE_INODE_UNSTABLE_BUFFERSIZE =
<a name="l00076"></a>00076   100*1024*1024; <span class="comment">/*&lt; Size for Ganesha unstable write buffers*/</span>
<a name="l00077"></a>00077 
<a name="l00083"></a><a class="code" href="cache__inode_8h.html#a75887b45d4dd2cc0a278d49b203f4344">00083</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="cache__inode_8h.html#a75887b45d4dd2cc0a278d49b203f4344">cache_inode_expire_type__</a>
<a name="l00084"></a>00084 {
<a name="l00085"></a><a class="code" href="cache__inode_8h.html#a75887b45d4dd2cc0a278d49b203f4344a4ab3a3b52ad3595a1019614a7fcfca16">00085</a>   <a class="code" href="cache__inode_8h.html#a75887b45d4dd2cc0a278d49b203f4344a4ab3a3b52ad3595a1019614a7fcfca16">CACHE_INODE_EXPIRE</a> = 0, <span class="comment">/*&lt; Data expire when they have been refreshed</span>
<a name="l00086"></a>00086 <span class="comment">                              less recently than grace period</span>
<a name="l00087"></a>00087 <span class="comment">                              for their type allows. */</span>
<a name="l00088"></a><a class="code" href="cache__inode_8h.html#a75887b45d4dd2cc0a278d49b203f4344ade60f0a5145d3c0ef683486dd8fc14c6">00088</a>   <a class="code" href="cache__inode_8h.html#a75887b45d4dd2cc0a278d49b203f4344ade60f0a5145d3c0ef683486dd8fc14c6">CACHE_INODE_EXPIRE_NEVER</a> = 1, <span class="comment">/*&lt; Data never expire based on time. */</span>
<a name="l00089"></a><a class="code" href="cache__inode_8h.html#a75887b45d4dd2cc0a278d49b203f4344aa9abc4a978bea6f82c84e0b45adec68c">00089</a>   <a class="code" href="cache__inode_8h.html#a75887b45d4dd2cc0a278d49b203f4344aa9abc4a978bea6f82c84e0b45adec68c">CACHE_INODE_EXPIRE_IMMEDIATE</a> = 2 <span class="comment">/*&lt; Data are always treated as</span>
<a name="l00090"></a>00090 <span class="comment">                                       expired. */</span>
<a name="l00091"></a>00091 } <a class="code" href="cache__inode_8h.html#a528237af2ef7cef5ff19555de7fb980a">cache_inode_expire_type_t</a>;
<a name="l00092"></a>00092 
<a name="l00097"></a><a class="code" href="cache__inode_8h.html#a8626994a696652386ad44670cb29c044">00097</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="cache__inode_8h.html#a8626994a696652386ad44670cb29c044">cache_inode_stability__</a> {
<a name="l00098"></a><a class="code" href="cache__inode_8h.html#a8626994a696652386ad44670cb29c044ab7a3c6420c33fb60fe0568adc3668981">00098</a>   <a class="code" href="cache__inode_8h.html#a8626994a696652386ad44670cb29c044ab7a3c6420c33fb60fe0568adc3668981">CACHE_INODE_UNSAFE_WRITE_TO_FS_BUFFER</a> = 0,
<a name="l00099"></a><a class="code" href="cache__inode_8h.html#a8626994a696652386ad44670cb29c044a77008a888d8a7e8f70ed386429c7b260">00099</a>   <a class="code" href="cache__inode_8h.html#a8626994a696652386ad44670cb29c044a77008a888d8a7e8f70ed386429c7b260">CACHE_INODE_SAFE_WRITE_TO_FS</a> = 1,
<a name="l00100"></a><a class="code" href="cache__inode_8h.html#a8626994a696652386ad44670cb29c044a4128d1984257cdcb767033b68e0a230c">00100</a>   <a class="code" href="cache__inode_8h.html#a8626994a696652386ad44670cb29c044a4128d1984257cdcb767033b68e0a230c">CACHE_INODE_UNSAFE_WRITE_TO_GANESHA_BUFFER</a> = 2
<a name="l00101"></a>00101 } <a class="code" href="cache__inode_8h.html#aed11d3b4bb5ec5b5adda6a57c192d70f">cache_inode_stability_t</a>;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 
<a name="l00108"></a><a class="code" href="structcache__inode__lru____.html">00108</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcache__inode__lru____.html">cache_inode_lru__</a>
<a name="l00109"></a>00109 {
<a name="l00110"></a><a class="code" href="structcache__inode__lru____.html#a60aa1aa6625068cd2bf4ad224efbfc33">00110</a>   <span class="keyword">struct </span><a class="code" href="structglist__head.html">glist_head</a> <a class="code" href="structcache__inode__lru____.html#a60aa1aa6625068cd2bf4ad224efbfc33">q</a>; <span class="comment">/*&lt; Link in the physical deque impelmenting a</span>
<a name="l00111"></a>00111 <span class="comment">                           portion of the logical LRU. */</span>
<a name="l00112"></a><a class="code" href="structcache__inode__lru____.html#a85dc09169187837637ed119f87b40844">00112</a>   pthread_mutex_t <a class="code" href="structcache__inode__lru____.html#a85dc09169187837637ed119f87b40844">mtx</a>; <span class="comment">/*&lt; Mutex protecting this entry with regard to</span>
<a name="l00113"></a>00113 <span class="comment">                           LRU operations. */</span>
<a name="l00114"></a><a class="code" href="structcache__inode__lru____.html#ab0389bf408b0deca1355cb247e5db8c1">00114</a>   <a class="code" href="extended__types_8h.html#a20c5e9a94aaa5a66a9f0165f027a8581">int64_t</a> <a class="code" href="structcache__inode__lru____.html#ab0389bf408b0deca1355cb247e5db8c1">refcount</a>; <span class="comment">/*&lt; Reference count.  This is signed to make</span>
<a name="l00115"></a>00115 <span class="comment">                        mistakes easy to see. */</span>
<a name="l00116"></a><a class="code" href="structcache__inode__lru____.html#a0233f97ab3baf905d3308330a40d176f">00116</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__lru____.html#a0233f97ab3baf905d3308330a40d176f">pin_refcnt</a>; <span class="comment">/*&lt; Unpin it only if this goes down to zero */</span>
<a name="l00117"></a><a class="code" href="structcache__inode__lru____.html#a2238bc7c2fe6152dba6a30351de31cd4">00117</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__lru____.html#a2238bc7c2fe6152dba6a30351de31cd4">flags</a>; <span class="comment">/*&lt; Flags for details of this entry&#39;s status, such</span>
<a name="l00118"></a>00118 <span class="comment">                      as whether it is pinned and whetehr it&#39;s in L1</span>
<a name="l00119"></a>00119 <span class="comment">                      or L2. */</span>
<a name="l00120"></a><a class="code" href="structcache__inode__lru____.html#ac30c911fcb49267ece248b830b94804f">00120</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__lru____.html#ac30c911fcb49267ece248b830b94804f">lane</a>; <span class="comment">/*&lt; The lane in which an entry currently resides, so</span>
<a name="l00121"></a>00121 <span class="comment">                     we can lock the deque and decrement the correct</span>
<a name="l00122"></a>00122 <span class="comment">                     counter when moving or deleting the entry. */</span>
<a name="l00123"></a>00123 } <a class="code" href="cache__inode_8h.html#ab4a49530ea295c722da50a41299399da">cache_inode_lru_t</a>;
<a name="l00124"></a>00124 
<a name="l00129"></a><a class="code" href="structcache__inode__parameter____.html">00129</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcache__inode__parameter____.html">cache_inode_parameter__</a>
<a name="l00130"></a>00130 {
<a name="l00131"></a><a class="code" href="structcache__inode__parameter____.html#a401ab6cf8bfa8250739c3ea5a4186510">00131</a>   <a class="code" href="structhash__param.html">hash_parameter_t</a> <a class="code" href="structcache__inode__parameter____.html#a401ab6cf8bfa8250739c3ea5a4186510">hparam</a>; <span class="comment">/*&lt; Parameter used for hashtable initialization */</span>
<a name="l00132"></a>00132 <span class="preprocessor">#ifdef _USE_NLM</span>
<a name="l00133"></a>00133 <span class="preprocessor"></span>  <a class="code" href="structhash__param.html">hash_parameter_t</a> cookie_param; <span class="comment">/*&lt; Parameters used for lock cookie hash table</span>
<a name="l00134"></a>00134 <span class="comment">                                     initialization */</span>
<a name="l00135"></a>00135 <span class="preprocessor">#endif</span>
<a name="l00136"></a><a class="code" href="structcache__inode__parameter____.html#a36e131762d50c490e179e9d63cae7da8">00136</a> <span class="preprocessor"></span>  <a class="code" href="fsal__types_8h.html#a3cf899c676941b1d5f789b2b22af8821">fsal_attrib_mask_t</a> <a class="code" href="structcache__inode__parameter____.html#a36e131762d50c490e179e9d63cae7da8">attrmask</a>; <span class="comment">/*&lt; FSAL attributes to be used in FSAL */</span>
<a name="l00137"></a><a class="code" href="structcache__inode__parameter____.html#a2d93b4433efdf9e3a782d9481eb949f7">00137</a>   <a class="code" href="cache__inode_8h.html#a528237af2ef7cef5ff19555de7fb980a">cache_inode_expire_type_t</a> <a class="code" href="structcache__inode__parameter____.html#a2d93b4433efdf9e3a782d9481eb949f7">expire_type_attr</a>; <span class="comment">/*&lt; Cache inode expiration type</span>
<a name="l00138"></a>00138 <span class="comment">                                                  for attributes */</span>
<a name="l00139"></a><a class="code" href="structcache__inode__parameter____.html#a56b2d8568a41948e4de98540ca71987c">00139</a>   <a class="code" href="cache__inode_8h.html#a528237af2ef7cef5ff19555de7fb980a">cache_inode_expire_type_t</a> <a class="code" href="structcache__inode__parameter____.html#a56b2d8568a41948e4de98540ca71987c">expire_type_link</a>; <span class="comment">/*&lt; Cache inode expiration type</span>
<a name="l00140"></a>00140 <span class="comment">                                                  for symbolic links */</span>
<a name="l00141"></a><a class="code" href="structcache__inode__parameter____.html#a36fadbe3b0a8e32c86df8b76a1a0a84f">00141</a>   <a class="code" href="cache__inode_8h.html#a528237af2ef7cef5ff19555de7fb980a">cache_inode_expire_type_t</a> <a class="code" href="structcache__inode__parameter____.html#a36fadbe3b0a8e32c86df8b76a1a0a84f">expire_type_dirent</a>; <span class="comment">/*&lt; Cache inode expiration type</span>
<a name="l00142"></a>00142 <span class="comment">                                                    for directory entries */</span>
<a name="l00143"></a><a class="code" href="structcache__inode__parameter____.html#a47bb0de2260144595a49fad6d5e1ca9d">00143</a>   time_t <a class="code" href="structcache__inode__parameter____.html#a47bb0de2260144595a49fad6d5e1ca9d">grace_period_attr</a>; <span class="comment">/*&lt; Cached attributes grace period */</span>
<a name="l00144"></a><a class="code" href="structcache__inode__parameter____.html#af97fd9d642058b8fdb67f0c68ae07e1f">00144</a>   time_t <a class="code" href="structcache__inode__parameter____.html#af97fd9d642058b8fdb67f0c68ae07e1f">grace_period_link</a>; <span class="comment">/*&lt; Cached link grace period */</span>
<a name="l00145"></a><a class="code" href="structcache__inode__parameter____.html#a0ebe5eefd0887d01be30247e7fdf4d8c">00145</a>   time_t <a class="code" href="structcache__inode__parameter____.html#a0ebe5eefd0887d01be30247e7fdf4d8c">grace_period_dirent</a>; <span class="comment">/*&lt; Cached dirent grace period */</span>
<a name="l00146"></a><a class="code" href="structcache__inode__parameter____.html#ad9df5fb133365d177a89498045bba55a">00146</a>   bool_t <a class="code" href="structcache__inode__parameter____.html#ad9df5fb133365d177a89498045bba55a">getattr_dir_invalidation</a>; <span class="comment">/*&lt; Use getattr as for directory</span>
<a name="l00147"></a>00147 <span class="comment">                                       invalidation */</span>
<a name="l00148"></a><a class="code" href="structcache__inode__parameter____.html#a802c4e84e8611eb415a9534390e4e20a">00148</a>   bool_t <a class="code" href="structcache__inode__parameter____.html#a802c4e84e8611eb415a9534390e4e20a">use_test_access</a>; <span class="comment">/*&lt; Is FSAL_test_access to be used? */</span>
<a name="l00149"></a><a class="code" href="structcache__inode__parameter____.html#a81994b0d1f982c7b76b07fec86dbbcf0">00149</a>   bool_t <a class="code" href="structcache__inode__parameter____.html#a81994b0d1f982c7b76b07fec86dbbcf0">use_fsal_hash</a>; <span class="comment">/*&lt; Do we rely on FSAL to hash handle or not? */</span>
<a name="l00150"></a>00150 } <a class="code" href="cache__inode_8h.html#a5dc8bb14a7cd20064bccffd3d2f6b654">cache_inode_parameter_t</a>;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <span class="keyword">extern</span> <a class="code" href="structcache__inode__parameter____.html">cache_inode_parameter_t</a> <a class="code" href="cache__inode__misc_8c.html#a5a0812544a4c46658121a4df772b4114">cache_inode_params</a>;
<a name="l00157"></a><a class="code" href="structcache__inode__opened__file____.html">00157</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcache__inode__opened__file____.html">cache_inode_opened_file__</a>
<a name="l00158"></a>00158 {
<a name="l00159"></a><a class="code" href="structcache__inode__opened__file____.html#ae0784752101d7681e4b22de2468af888">00159</a>   <a class="code" href="FSAL_2FSAL__TEMPLATE_2fsal__types_8h.html#aecb7132e1cc257d558b3b2b4fbe94284">fsal_file_t</a> <a class="code" href="structcache__inode__opened__file____.html#ae0784752101d7681e4b22de2468af888">fd</a>; <span class="comment">/*&lt; FSAL specific object representing a given file</span>
<a name="l00160"></a>00160 <span class="comment">                      open. */</span>
<a name="l00161"></a><a class="code" href="structcache__inode__opened__file____.html#a1f4d0e117b2b4b50a81cf6f25607fb8e">00161</a>   <a class="code" href="fsal__types_8h.html#a32a4d2db8d51a91baa4adf861fcdd914">fsal_openflags_t</a> <a class="code" href="structcache__inode__opened__file____.html#a1f4d0e117b2b4b50a81cf6f25607fb8e">openflags</a>; <span class="comment">/*&lt; Flags showing whether the file is</span>
<a name="l00162"></a>00162 <span class="comment">                                  open for reading, writing, or both. */</span>
<a name="l00163"></a>00163 } <a class="code" href="cache__inode_8h.html#a45747e748936957be638e48e75910099">cache_inode_opened_file_t</a>;
<a name="l00164"></a>00164 
<a name="l00168"></a><a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162f">00168</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162f">cache_inode_file_type__</a>
<a name="l00169"></a>00169 {
<a name="l00170"></a><a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa56ffb466ab6da4b7d190191d215f8b68">00170</a>   <a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa56ffb466ab6da4b7d190191d215f8b68">UNASSIGNED</a> = 1, <span class="comment">/*&lt; No filetype at all. */</span>
<a name="l00171"></a><a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa00512007115c06f83e278302d7c70590">00171</a>   <a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa00512007115c06f83e278302d7c70590">REGULAR_FILE</a> = 2, <span class="comment">/*&lt; Regular file (can be opened, read, written) */</span>
<a name="l00172"></a><a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa5cce7c1bcf18a02d872030a08920525d">00172</a>   <a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa5cce7c1bcf18a02d872030a08920525d">CHARACTER_FILE</a> = 3, <span class="comment">/*&lt; Character special device file */</span>
<a name="l00173"></a><a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa41c55f1669302a7550fe231999cfe7b6">00173</a>   <a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa41c55f1669302a7550fe231999cfe7b6">BLOCK_FILE</a> = 4, <span class="comment">/*&lt; Block special device file */</span>
<a name="l00174"></a><a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa5aa1ff2096b431ab7b623de67c43484b">00174</a>   <a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa5aa1ff2096b431ab7b623de67c43484b">SYMBOLIC_LINK</a> = 5, <span class="comment">/*&lt; Symbolic link */</span>
<a name="l00175"></a><a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fae16fb6ae763034a85f9995cc2509b6f6">00175</a>   <a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fae16fb6ae763034a85f9995cc2509b6f6">SOCKET_FILE</a> = 6, <span class="comment">/*&lt; Unix domain socket. */</span>
<a name="l00176"></a><a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162facc7cb5edb4d22c30f8a5fc945eb4c11a">00176</a>   <a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162facc7cb5edb4d22c30f8a5fc945eb4c11a">FIFO_FILE</a> = 7, <span class="comment">/*&lt; FIFO or &#39;named pipe&#39; */</span>
<a name="l00177"></a><a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa9d09f58160b1161920aad19080f568cc">00177</a>   <a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa9d09f58160b1161920aad19080f568cc">DIRECTORY</a> = 8, <span class="comment">/*&lt; A directory */</span>
<a name="l00178"></a><a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa911a59d697b2d669bc4a2f24a52860c1">00178</a>   <a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa911a59d697b2d669bc4a2f24a52860c1">FS_JUNCTION</a> = 9, <span class="comment">/*&lt; A directory-like node leading from one</span>
<a name="l00179"></a>00179 <span class="comment">                       filesystem to another */</span>
<a name="l00180"></a><a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa17481df3c6dd1da6126374bca1dc1163">00180</a>   <a class="code" href="cache__inode_8h.html#a2aee8d2ff73574138b75922c7652162fa17481df3c6dd1da6126374bca1dc1163">RECYCLED</a> = 10 <span class="comment">/*&lt; This entry has been recycled */</span>
<a name="l00181"></a>00181 } <a class="code" href="cache__inode_8h.html#ae017962c50fe48834d8638069c7edc99">cache_inode_file_type_t</a>;
<a name="l00182"></a>00182 
<a name="l00188"></a><a class="code" href="cache__inode_8h.html#a67d7c7093257ce44ef7db8473ba3bfe9">00188</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="cache__inode_8h.html#a67d7c7093257ce44ef7db8473ba3bfe9">io_direction__</a>
<a name="l00189"></a>00189 {
<a name="l00190"></a><a class="code" href="cache__inode_8h.html#a67d7c7093257ce44ef7db8473ba3bfe9aeae4ed38f0720d45bd9948b2107df50e">00190</a>   <a class="code" href="cache__inode_8h.html#a67d7c7093257ce44ef7db8473ba3bfe9aeae4ed38f0720d45bd9948b2107df50e">CACHE_INODE_READ</a> = 1, <span class="comment">/*&lt; Reading */</span>
<a name="l00191"></a><a class="code" href="cache__inode_8h.html#a67d7c7093257ce44ef7db8473ba3bfe9a7cf382eb3f7df151893437fff2bb5c0b">00191</a>   <a class="code" href="cache__inode_8h.html#a67d7c7093257ce44ef7db8473ba3bfe9a7cf382eb3f7df151893437fff2bb5c0b">CACHE_INODE_WRITE</a> = 2 <span class="comment">/*&lt; Writing */</span>
<a name="l00192"></a>00192 } <a class="code" href="cache__inode_8h.html#ab09d7c8ceb9e0d139e5cf6461fb37d2d">cache_inode_io_direction_t</a>;
<a name="l00193"></a>00193 
<a name="l00199"></a><a class="code" href="cache__inode_8h.html#a8e8f05087fc41d80cfe2615d91108633">00199</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="cache__inode_8h.html#a8e8f05087fc41d80cfe2615d91108633">cache_inode_dirent_op__</a>
<a name="l00200"></a>00200 {
<a name="l00201"></a><a class="code" href="cache__inode_8h.html#a8e8f05087fc41d80cfe2615d91108633a1c2f67023ce5210c5931958d081cb1b0">00201</a>   <a class="code" href="cache__inode_8h.html#a8e8f05087fc41d80cfe2615d91108633a1c2f67023ce5210c5931958d081cb1b0">CACHE_INODE_DIRENT_OP_LOOKUP</a> = 1, <span class="comment">/*&lt; Look up a name */</span>
<a name="l00202"></a><a class="code" href="cache__inode_8h.html#a8e8f05087fc41d80cfe2615d91108633ad3c6b79aa1d0ee9625dd215d21060ba0">00202</a>   <a class="code" href="cache__inode_8h.html#a8e8f05087fc41d80cfe2615d91108633ad3c6b79aa1d0ee9625dd215d21060ba0">CACHE_INODE_DIRENT_OP_REMOVE</a> = 2, <span class="comment">/*&lt; Remove a name */</span>
<a name="l00203"></a><a class="code" href="cache__inode_8h.html#a8e8f05087fc41d80cfe2615d91108633ac73da53b05163f949f4a4ebbc287fb1c">00203</a>   <a class="code" href="cache__inode_8h.html#a8e8f05087fc41d80cfe2615d91108633ac73da53b05163f949f4a4ebbc287fb1c">CACHE_INODE_DIRENT_OP_RENAME</a> = 3 <span class="comment">/*&lt; Rename node */</span>
<a name="l00204"></a>00204 } <a class="code" href="cache__inode_8h.html#a4961f3249c42b3ee87cc1799b3421ffd">cache_inode_dirent_op_t</a>;
<a name="l00205"></a>00205 
<a name="l00206"></a><a class="code" href="cache__inode_8h.html#a536c655c01a81064fcf5dc9369275a8c">00206</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="cache__inode_8h.html#a536c655c01a81064fcf5dc9369275a8c">cache_inode_avl_which__</a>
<a name="l00207"></a><a class="code" href="cache__inode_8h.html#a536c655c01a81064fcf5dc9369275a8caefcbee1e66db376ca590576f86739ff0">00207</a> { <a class="code" href="cache__inode_8h.html#a536c655c01a81064fcf5dc9369275a8caefcbee1e66db376ca590576f86739ff0">CACHE_INODE_AVL_NAMES</a> = 1,
<a name="l00208"></a><a class="code" href="cache__inode_8h.html#a536c655c01a81064fcf5dc9369275a8ca559233c00e869b9c0c5b22effd7bc8a5">00208</a>   <a class="code" href="cache__inode_8h.html#a536c655c01a81064fcf5dc9369275a8ca559233c00e869b9c0c5b22effd7bc8a5">CACHE_INODE_AVL_COOKIES</a> = 2,
<a name="l00209"></a><a class="code" href="cache__inode_8h.html#a536c655c01a81064fcf5dc9369275a8caae8ce2afda5ff18b977bb053cba6b650">00209</a>   <a class="code" href="cache__inode_8h.html#a536c655c01a81064fcf5dc9369275a8caae8ce2afda5ff18b977bb053cba6b650">CACHE_INODE_AVL_BOTH</a> = 3
<a name="l00210"></a>00210 } <a class="code" href="cache__inode_8h.html#ae6e49f8c8c15b191ff9ffc007d48043e">cache_inode_avl_which_t</a>;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="comment">/* Flags set on cache_entry_t::flags*/</span>
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_TRUST_ATTRS
<a name="l00215"></a>00215   = 0x00000001; <span class="comment">/*&lt; Trust stored attributes */</span>
<a name="l00216"></a>00216 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_TRUST_CONTENT
<a name="l00217"></a>00217   = 0x00000002; <span class="comment">/*&lt; Trust inode content (for the moment, directory and</span>
<a name="l00218"></a>00218 <span class="comment">                    symlink) */</span>
<a name="l00219"></a>00219 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_DIR_POPULATED
<a name="l00220"></a>00220   = 0x00000004; <span class="comment">/*&lt; The directory has been populated (negative lookups</span>
<a name="l00221"></a>00221 <span class="comment">                  are meaningful) */</span>
<a name="l00222"></a>00222 
<a name="l00227"></a><a class="code" href="structcache__inode__symlink____.html">00227</a> <span class="keyword">struct </span><a class="code" href="structcache__inode__symlink____.html">cache_inode_symlink__</a>
<a name="l00228"></a>00228 {
<a name="l00229"></a><a class="code" href="structcache__inode__symlink____.html#a2398016c7249de9a86ac3001edaa0553">00229</a>   <a class="code" href="structfsal__path____.html">fsal_path_t</a> <a class="code" href="structcache__inode__symlink____.html#a2398016c7249de9a86ac3001edaa0553">content</a>; <span class="comment">/*&lt; Content of the link */</span>
<a name="l00230"></a>00230 };
<a name="l00231"></a>00231 
<a name="l00237"></a><a class="code" href="structcache__inode__unstable__data____.html">00237</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcache__inode__unstable__data____.html">cache_inode_unstable_data__</a>
<a name="l00238"></a>00238 {
<a name="l00239"></a><a class="code" href="structcache__inode__unstable__data____.html#a1f230ef3dda0a47be18e0c5573c6ba04">00239</a>   caddr_t <a class="code" href="structcache__inode__unstable__data____.html#a1f230ef3dda0a47be18e0c5573c6ba04">buffer</a>; <span class="comment">/*&lt; Pointer in memory */</span>
<a name="l00240"></a><a class="code" href="structcache__inode__unstable__data____.html#a756013daca940aedc36ccb0d81b7d3e7">00240</a>   <a class="code" href="extended__types_8h.html#ad27ed092432b64ff558d2254c278720f">uint64_t</a> <a class="code" href="structcache__inode__unstable__data____.html#a756013daca940aedc36ccb0d81b7d3e7">offset</a>; <span class="comment">/*&lt; Offset (relative to the start of the file) */</span>
<a name="l00241"></a><a class="code" href="structcache__inode__unstable__data____.html#a843e6caa7385968efd5f160002e6445d">00241</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__unstable__data____.html#a843e6caa7385968efd5f160002e6445d">length</a>; <span class="comment">/*&lt; Length */</span>
<a name="l00242"></a>00242 } <a class="code" href="cache__inode_8h.html#a6a8c7c22a7d7148b7ec4aa73a47270b2">cache_inode_unstable_data_t</a>;
<a name="l00243"></a>00243 
<a name="l00248"></a>00248 <span class="comment">/* The ref counted share reservation state.</span>
<a name="l00249"></a>00249 <span class="comment"> *</span>
<a name="l00250"></a>00250 <span class="comment"> * Each field represents the count of instances of that flag being present</span>
<a name="l00251"></a>00251 <span class="comment"> * in a v3 or v4 share reservation.</span>
<a name="l00252"></a>00252 <span class="comment"> *</span>
<a name="l00253"></a>00253 <span class="comment"> * There is a separate count of v4 deny write flags so that they can be</span>
<a name="l00254"></a>00254 <span class="comment"> * enforced against v3 writes (v3 deny writes can not be enforced against</span>
<a name="l00255"></a>00255 <span class="comment"> * v3 writes because there is no connection between the share reservation</span>
<a name="l00256"></a>00256 <span class="comment"> * and the write operation). v3 reads will always be allowed.</span>
<a name="l00257"></a>00257 <span class="comment"> */</span>
<a name="l00258"></a><a class="code" href="structcache__inode__share____.html">00258</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcache__inode__share____.html">cache_inode_share__</a>
<a name="l00259"></a>00259 {
<a name="l00260"></a><a class="code" href="structcache__inode__share____.html#a6bada869a80f05c953025e4145014285">00260</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structcache__inode__share____.html#a6bada869a80f05c953025e4145014285">share_access_read</a>;
<a name="l00261"></a><a class="code" href="structcache__inode__share____.html#a2ccd7ea7b5168364eb9d38e4562cae9a">00261</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structcache__inode__share____.html#a2ccd7ea7b5168364eb9d38e4562cae9a">share_access_write</a>;
<a name="l00262"></a><a class="code" href="structcache__inode__share____.html#ad10fb4bcaca745a35f38dd20300affd4">00262</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structcache__inode__share____.html#ad10fb4bcaca745a35f38dd20300affd4">share_deny_read</a>;
<a name="l00263"></a><a class="code" href="structcache__inode__share____.html#a939cae8c9c6115bdeb5ea76d509fd5ac">00263</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structcache__inode__share____.html#a939cae8c9c6115bdeb5ea76d509fd5ac">share_deny_write</a>;
<a name="l00264"></a><a class="code" href="structcache__inode__share____.html#ad8b0e97ab61465fc844a6edaefc610ff">00264</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structcache__inode__share____.html#ad8b0e97ab61465fc844a6edaefc610ff">share_deny_write_v4</a>; 
<a name="l00265"></a>00265 } <a class="code" href="cache__inode_8h.html#a2c473a04b15e29725a29484c1e5e59be">cache_inode_share_t</a>;
<a name="l00266"></a>00266 
<a name="l00274"></a><a class="code" href="cache__inode_8h.html#adcdbcaa4000943e2825e317a7c25f952">00274</a> <span class="preprocessor">#define DIR_ENTRY_FLAG_NONE     0x0000</span>
<a name="l00275"></a><a class="code" href="cache__inode_8h.html#a04dac899bc41754c87b79be0b84dc157">00275</a> <span class="preprocessor"></span><span class="preprocessor">#define DIR_ENTRY_FLAG_DELETED  0x0001</span>
<a name="l00276"></a>00276 <span class="preprocessor"></span>
<a name="l00277"></a><a class="code" href="structcache__inode__dir__entry____.html">00277</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcache__inode__dir__entry____.html">cache_inode_dir_entry__</a>
<a name="l00278"></a>00278 {
<a name="l00279"></a><a class="code" href="structcache__inode__dir__entry____.html#aa810d5ffab9976e589ae8ec24cbb2747">00279</a>   <span class="keyword">struct </span><a class="code" href="structavltree__node.html">avltree_node</a> <a class="code" href="structcache__inode__dir__entry____.html#aa810d5ffab9976e589ae8ec24cbb2747">node_hk</a>; <span class="comment">/*&lt; AVL node in tree */</span>
<a name="l00280"></a>00280   <span class="keyword">struct </span>{
<a name="l00281"></a><a class="code" href="structcache__inode__dir__entry____.html#ab01ae37b568db6c54954a69fd69807ef">00281</a>     <a class="code" href="extended__types_8h.html#ad27ed092432b64ff558d2254c278720f">uint64_t</a> <a class="code" href="structcache__inode__dir__entry____.html#ab01ae37b568db6c54954a69fd69807ef">k</a>; <span class="comment">/*&lt; Integer cookie */</span>
<a name="l00282"></a><a class="code" href="structcache__inode__dir__entry____.html#a2b49f5af211249c98a04ef89e32228c6">00282</a>     <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__dir__entry____.html#a2b49f5af211249c98a04ef89e32228c6">p</a>; <span class="comment">/*&lt; Number of probes, an efficiency metric */</span>
<a name="l00283"></a>00283   } <a class="code" href="structcache__inode__dir__entry____.html#a8a9e48c6939de440b8674494c5676977">hk</a>;
<a name="l00284"></a><a class="code" href="structcache__inode__dir__entry____.html#a95663f617b0c2587058076ce628dbbc4">00284</a>   <a class="code" href="structgweakref__.html">gweakref_t</a> <a class="code" href="structcache__inode__dir__entry____.html#a95663f617b0c2587058076ce628dbbc4">entry</a>; <span class="comment">/*&lt; Weak reference pointing to the cache entry */</span>
<a name="l00285"></a><a class="code" href="structcache__inode__dir__entry____.html#a4a5d1a16bbd17840018403afcd676920">00285</a>   <a class="code" href="structfsal__name____.html">fsal_name_t</a> <a class="code" href="structcache__inode__dir__entry____.html#a4a5d1a16bbd17840018403afcd676920">name</a>; <span class="comment">/*&lt; The filename */</span>
<a name="l00286"></a><a class="code" href="structcache__inode__dir__entry____.html#a555f9f6f50ffda6284bd2ba360d00085">00286</a>   <a class="code" href="extended__types_8h.html#ad27ed092432b64ff558d2254c278720f">uint64_t</a> <a class="code" href="structcache__inode__dir__entry____.html#a555f9f6f50ffda6284bd2ba360d00085">fsal_cookie</a>; <span class="comment">/*&lt; The cookie returned by the FSAL. */</span>
<a name="l00287"></a><a class="code" href="structcache__inode__dir__entry____.html#a4edee17d7a49ca09aa086d0c22d3e496">00287</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__dir__entry____.html#a4edee17d7a49ca09aa086d0c22d3e496">flags</a>; <span class="comment">/*&lt; Flags */</span>
<a name="l00288"></a>00288 } <a class="code" href="cache__inode_8h.html#a318b39e8a3c00fb55f21fdc1ca92ac94">cache_inode_dir_entry_t</a>;
<a name="l00289"></a>00289 
<a name="l00336"></a><a class="code" href="structcache__entry__t.html">00336</a> <span class="keyword">struct </span><a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a>
<a name="l00337"></a>00337 {
<a name="l00338"></a><a class="code" href="structcache__entry__t.html#aaa7abf75d0997dba12395a01c09be705">00338</a>   <a class="code" href="structfsal__handle____.html">fsal_handle_t</a> <a class="code" href="structcache__entry__t.html#aaa7abf75d0997dba12395a01c09be705">handle</a>; <span class="comment">/*&lt; The FSAL Handle */</span>
<a name="l00339"></a><a class="code" href="structcache__entry__t.html#ab0b0e66cae7490cc83e316b2b61a2fad">00339</a>   <span class="keyword">struct </span><a class="code" href="structfsal__handle__desc.html">fsal_handle_desc</a> <a class="code" href="structcache__entry__t.html#ab0b0e66cae7490cc83e316b2b61a2fad">fh_desc</a>; <span class="comment">/*&lt; Points to handle.  Adds size,</span>
<a name="l00340"></a>00340 <span class="comment">                                       len for hash table etc. */</span>
<a name="l00341"></a><a class="code" href="structcache__entry__t.html#abfff4328d362e2e558cc01c519c83446">00341</a>   <a class="code" href="structgweakref__.html">gweakref_t</a> <a class="code" href="structcache__entry__t.html#abfff4328d362e2e558cc01c519c83446">weakref</a>; <span class="comment">/*&lt; A weakref for this entry (pointer and generation</span>
<a name="l00342"></a>00342 <span class="comment">                          number.)  The generation number is the only</span>
<a name="l00343"></a>00343 <span class="comment">                          interesting part, but this way the weakref</span>
<a name="l00344"></a>00344 <span class="comment">                          can be easily stashed somewhere. */</span>
<a name="l00345"></a><a class="code" href="structcache__entry__t.html#afa60c075430da0dbe9d5f4160f336294">00345</a>   <a class="code" href="cache__inode_8h.html#ae017962c50fe48834d8638069c7edc99">cache_inode_file_type_t</a> <a class="code" href="structcache__entry__t.html#afa60c075430da0dbe9d5f4160f336294">type</a>; <span class="comment">/*&lt; The type of the entry */</span>
<a name="l00346"></a><a class="code" href="structcache__entry__t.html#a896c6b9f342fbc763040ae330526bed8">00346</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__entry__t.html#a896c6b9f342fbc763040ae330526bed8">flags</a>; <span class="comment">/*&lt; Flags for this entry */</span>
<a name="l00347"></a><a class="code" href="structcache__entry__t.html#a564df0bd95a95605998780d01032619c">00347</a>   time_t <a class="code" href="structcache__entry__t.html#a564df0bd95a95605998780d01032619c">change_time</a>; <span class="comment">/*&lt; The time of the last operation ganesha knows</span>
<a name="l00348"></a>00348 <span class="comment">                          about.  We can ue this for change_info4, but</span>
<a name="l00349"></a>00349 <span class="comment">                          atomic MUST BE SET TO FALSE.  Don&#39;t use it</span>
<a name="l00350"></a>00350 <span class="comment">                          for anything else (servicing getattr,</span>
<a name="l00351"></a>00351 <span class="comment">                          etc.) */</span>
<a name="l00352"></a><a class="code" href="structcache__entry__t.html#a855ffe691f605541520b47bf4d12590f">00352</a>   time_t <a class="code" href="structcache__entry__t.html#a855ffe691f605541520b47bf4d12590f">attr_time</a>; <span class="comment">/*&lt; Time at which we last refreshed attributes. */</span>
<a name="l00353"></a><a class="code" href="structcache__entry__t.html#a71a999105c78e3dbad7579f502cd637d">00353</a>   <a class="code" href="structcache__inode__lru____.html">cache_inode_lru_t</a> <a class="code" href="structcache__entry__t.html#a71a999105c78e3dbad7579f502cd637d">lru</a>; <span class="comment">/*&lt; New style LRU link */</span>
<a name="l00354"></a><a class="code" href="structcache__entry__t.html#aa7bf1f222eb0fcefd928dde61c906b34">00354</a>   pthread_rwlock_t <a class="code" href="structcache__entry__t.html#aa7bf1f222eb0fcefd928dde61c906b34">attr_lock</a>; <span class="comment">/*&lt; Reader-writer lock for attributes */</span>
<a name="l00355"></a><a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">00355</a>   <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> <a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>; <span class="comment">/*&lt; The FSAL Attributes */</span>
<a name="l00356"></a><a class="code" href="structcache__entry__t.html#a5c113e24a9432c130ce0530cf05b7c03">00356</a>   pthread_rwlock_t <a class="code" href="structcache__entry__t.html#a5c113e24a9432c130ce0530cf05b7c03">state_lock</a>; <span class="comment">/*&lt; This is separated out from the</span>
<a name="l00357"></a>00357 <span class="comment">                                   content lock, since there are</span>
<a name="l00358"></a>00358 <span class="comment">                                   state oerations that don&#39;t affect</span>
<a name="l00359"></a>00359 <span class="comment">                                   anything guarded by content (for</span>
<a name="l00360"></a>00360 <span class="comment">                                   example, a layout return or</span>
<a name="l00361"></a>00361 <span class="comment">                                   request has no effect on a cached</span>
<a name="l00362"></a>00362 <span class="comment">                                   file handle) and the content lock</span>
<a name="l00363"></a>00363 <span class="comment">                                   may be released and reacquired</span>
<a name="l00364"></a>00364 <span class="comment">                                   several times in an operation that</span>
<a name="l00365"></a>00365 <span class="comment">                                   should not see changes i state. */</span>
<a name="l00366"></a><a class="code" href="structcache__entry__t.html#a53ea7e50b59d2e3c2c8af887ac3dd734">00366</a>   <span class="keyword">struct </span><a class="code" href="structglist__head.html">glist_head</a> <a class="code" href="structcache__entry__t.html#a53ea7e50b59d2e3c2c8af887ac3dd734">state_list</a>; <span class="comment">/*&lt; Pointers for state list */</span>
<a name="l00367"></a><a class="code" href="structcache__entry__t.html#a63cfd2d8617142c19cba82c7086fa101">00367</a>   pthread_rwlock_t <a class="code" href="structcache__entry__t.html#a63cfd2d8617142c19cba82c7086fa101">content_lock</a>; <span class="comment">/*&lt; Lock on type-specific cached</span>
<a name="l00368"></a>00368 <span class="comment">                                     content.  See locking discipline</span>
<a name="l00369"></a>00369 <span class="comment">                                     for details. */</span>
<a name="l00370"></a><a class="code" href="unioncache__entry__t_1_1cache__inode__fsobj____.html">00370</a>   <span class="keyword">union </span><a class="code" href="unioncache__entry__t_1_1cache__inode__fsobj____.html">cache_inode_fsobj__</a>
<a name="l00371"></a>00371   {
<a name="l00372"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__file____.html">00372</a>     <span class="keyword">struct </span><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__file____.html">cache_inode_file__</a>
<a name="l00373"></a>00373     {
<a name="l00374"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__file____.html#ae1d7a375eba0ff2b73b43097287dd822">00374</a>       <a class="code" href="structcache__inode__opened__file____.html">cache_inode_opened_file_t</a> <a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__file____.html#ae1d7a375eba0ff2b73b43097287dd822">open_fd</a>;<span class="comment">/*&lt; Cached fsal_file_t for</span>
<a name="l00375"></a>00375 <span class="comment">                                            optimized access */</span>
<a name="l00376"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__file____.html#a3025b35f5ab15d3b2094bfc7819a913b">00376</a>       <span class="keyword">struct </span><a class="code" href="structglist__head.html">glist_head</a> <a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__file____.html#a3025b35f5ab15d3b2094bfc7819a913b">lock_list</a>; <span class="comment">/*&lt; Pointers for lock list */</span>
<a name="l00377"></a>00377 <span class="preprocessor">#ifdef _USE_NLM</span>
<a name="l00378"></a>00378 <span class="preprocessor"></span>      <span class="keyword">struct </span><a class="code" href="structglist__head.html">glist_head</a> nlm_share_list; 
<a name="l00379"></a>00379 <span class="preprocessor">#endif</span>
<a name="l00380"></a>00380 <span class="preprocessor"></span>      <a class="code" href="structcache__inode__unstable__data____.html">cache_inode_unstable_data_t</a>
<a name="l00381"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__file____.html#a24b00eed48957e5f59df09d6eeed4ca0">00381</a>         <a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__file____.html#a24b00eed48957e5f59df09d6eeed4ca0">unstable_data</a>; <span class="comment">/*&lt; Unstable data, for use with WRITE/COMMIT */</span>
<a name="l00382"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__file____.html#abfb7ba5600d39bc9242e3bb266a0bd54">00382</a>       <a class="code" href="structcache__inode__share____.html">cache_inode_share_t</a> <a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__file____.html#abfb7ba5600d39bc9242e3bb266a0bd54">share_state</a>; <span class="comment">/*&lt; Share reservation state for</span>
<a name="l00383"></a>00383 <span class="comment">                                           this file. */</span>
<a name="l00384"></a>00384     } <a class="code" href="unioncache__entry__t_1_1cache__inode__fsobj____.html#a92f6a1482b689768ea47e2979629125a">file</a>; <span class="comment">/*&lt; REGULAR_FILE data */</span>
<a name="l00385"></a>00385 
<a name="l00386"></a><a class="code" href="unioncache__entry__t_1_1cache__inode__fsobj____.html#a785742d7a87d7d896ccea2a30044f2c7">00386</a>     <span class="keyword">struct </span><a class="code" href="structcache__inode__symlink____.html">cache_inode_symlink__</a> *<a class="code" href="unioncache__entry__t_1_1cache__inode__fsobj____.html#a785742d7a87d7d896ccea2a30044f2c7">symlink</a>; <span class="comment">/*&lt; SYMLINK data */</span>
<a name="l00387"></a>00387 
<a name="l00388"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html">00388</a>     <span class="keyword">struct </span><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html">cache_inode_dir__</a>
<a name="l00389"></a>00389     {
<a name="l00390"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#ae09e3fc3ac9b72bdbfa3fbc6672e9de0">00390</a>       bool_t <a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#ae09e3fc3ac9b72bdbfa3fbc6672e9de0">root</a>; <span class="comment">/*&lt; Marks this as the root directory of an export */</span>
<a name="l00391"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a876ee665db08c193442a08c47f519c68">00391</a>       <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a876ee665db08c193442a08c47f519c68">nbactive</a>; <span class="comment">/*&lt; Number of known active children */</span>
<a name="l00392"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a3dc493085e37eaae02c397f7d7cef060">00392</a>       <span class="keywordtype">char</span> *<a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a3dc493085e37eaae02c397f7d7cef060">referral</a>; <span class="comment">/*&lt; NULL is not a referral.  If not, this a</span>
<a name="l00393"></a>00393 <span class="comment">                          &#39;referral string&#39; */</span>
<a name="l00394"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a1fbdc011f8fde1abaa081c89556f8771">00394</a>       <a class="code" href="structgweakref__.html">gweakref_t</a> <a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a1fbdc011f8fde1abaa081c89556f8771">parent</a>; <span class="comment">/*&lt; The parent of this directory</span>
<a name="l00395"></a>00395 <span class="comment">                             (&#39;..&#39;) */</span>
<a name="l00396"></a>00396       <span class="keyword">struct </span>{
<a name="l00397"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a0ca9f318f3637ff3a3c990de39961972">00397</a>           <span class="keyword">struct </span><a class="code" href="structavltree.html">avltree</a> <a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a0ca9f318f3637ff3a3c990de39961972">t</a>;                     
<a name="l00398"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a388b33b2f042b6f623280c23c0497310">00398</a>           <span class="keyword">struct </span><a class="code" href="structavltree.html">avltree</a> <a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a388b33b2f042b6f623280c23c0497310">c</a>;                     
<a name="l00399"></a><a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a711de9586e18165de24ae3d077f76470">00399</a>           <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__entry__t_1_1cache__inode__fsobj_____1_1cache__inode__dir____.html#a711de9586e18165de24ae3d077f76470">collisions</a>;                  
<a name="l00400"></a>00400       } avl;
<a name="l00401"></a>00401     } <a class="code" href="unioncache__entry__t_1_1cache__inode__fsobj____.html#a2ed64c64f5a63c623efd5eef8e8b1859">dir</a>; <span class="comment">/*&lt; DIRECTORY data */</span>
<a name="l00402"></a>00402   } <a class="code" href="structcache__entry__t.html#a0767b2a90515593d88a51fe20dbcc55e">object</a>; <span class="comment">/*&lt; Filetype specific data, discriminated by the type</span>
<a name="l00403"></a>00403 <span class="comment">                field.  Note that data for special files is in</span>
<a name="l00404"></a>00404 <span class="comment">                attributes.rawdev */</span>
<a name="l00405"></a>00405 };
<a name="l00406"></a>00406 
<a name="l00407"></a><a class="code" href="cache__inode_8h.html#aa70621774daacdb60b2901ead6eac23c">00407</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>cache_inode_file__ <a class="code" href="cache__inode_8h.html#aa70621774daacdb60b2901ead6eac23c">cache_inode_file_t</a>;
<a name="l00408"></a><a class="code" href="cache__inode_8h.html#a40914b611b241a6a7067174a4dc49cbe">00408</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcache__inode__symlink____.html">cache_inode_symlink__</a> <a class="code" href="structcache__inode__symlink____.html">cache_inode_symlink_t</a>;
<a name="l00409"></a><a class="code" href="cache__inode_8h.html#ac94dcce5b9ad1a9085c1f067937eb220">00409</a> <span class="keyword">typedef</span> <span class="keyword">union </span>cache_inode_fsobj__ <a class="code" href="cache__inode_8h.html#ac94dcce5b9ad1a9085c1f067937eb220">cache_inode_fsobj_t</a>;
<a name="l00410"></a>00410 
<a name="l00415"></a><a class="code" href="structcache__inode__fsal__data____.html">00415</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcache__inode__fsal__data____.html">cache_inode_fsal_data__</a>
<a name="l00416"></a>00416 {
<a name="l00417"></a><a class="code" href="structcache__inode__fsal__data____.html#a4bb6eae804842b06f773ddeb873fb5b5">00417</a>   <span class="keyword">struct </span><a class="code" href="structfsal__handle__desc.html">fsal_handle_desc</a> <a class="code" href="structcache__inode__fsal__data____.html#a4bb6eae804842b06f773ddeb873fb5b5">fh_desc</a>;              
<a name="l00418"></a>00418 } <a class="code" href="cache__inode_8h.html#a82763549c47d6dd9f26294784c959937">cache_inode_fsal_data_t</a>;
<a name="l00419"></a>00419 
<a name="l00424"></a>00424 <span class="keyword">extern</span> <a class="code" href="structpool.html" title="Type representing a pool.">pool_t</a> *<a class="code" href="cache__inode__misc_8c.html#a24017ef99ad1d02cd2d2f9981e2cd25a">cache_inode_entry_pool</a>; <span class="comment">/*&lt; Cache entries pool */</span>
<a name="l00425"></a>00425 <span class="keyword">extern</span> <a class="code" href="structpool.html" title="Type representing a pool.">pool_t</a> *<a class="code" href="cache__inode__misc_8c.html#a0d6ecab9a98b12c2a268e3ee49de29bf">cache_inode_symlink_pool</a>; <span class="comment">/*&lt; Pool for SYMLINK data */</span>
<a name="l00426"></a>00426 <span class="keyword">extern</span> <a class="code" href="structpool.html" title="Type representing a pool.">pool_t</a> *<a class="code" href="cache__inode__misc_8c.html#a811c5d9e902d385c085dbc4fa3992628">cache_inode_dir_entry_pool</a>; <span class="comment">/*&lt; Cached dir entry pool */</span>
<a name="l00427"></a>00427 
<a name="l00432"></a><a class="code" href="structcache__inode__gc__policy____.html">00432</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcache__inode__gc__policy____.html">cache_inode_gc_policy__</a>
<a name="l00433"></a>00433 {
<a name="l00434"></a><a class="code" href="structcache__inode__gc__policy____.html#a5cc5157724280cd8833ea884a26c6bea">00434</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__gc__policy____.html#a5cc5157724280cd8833ea884a26c6bea">entries_hwmark</a>; <span class="comment">/*&lt; High water mark for cache entries */</span>
<a name="l00435"></a><a class="code" href="structcache__inode__gc__policy____.html#a83fa75fe98eaec3ecc15dbd98063fe76">00435</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__gc__policy____.html#a83fa75fe98eaec3ecc15dbd98063fe76">entries_lwmark</a>; <span class="comment">/*&lt; Low water mark for cache_entries */</span>
<a name="l00436"></a><a class="code" href="structcache__inode__gc__policy____.html#a2a29592981f4fa8f91e930b918ad1aea">00436</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__gc__policy____.html#a2a29592981f4fa8f91e930b918ad1aea">lru_run_interval</a>;  <span class="comment">/*&lt; Interval in seconds between runs of</span>
<a name="l00437"></a>00437 <span class="comment">                                  the LRU cleaner thread */</span>
<a name="l00438"></a><a class="code" href="structcache__inode__gc__policy____.html#ad3477ee19d6386e6c3dc4e43df7219b9">00438</a>   bool_t <a class="code" href="structcache__inode__gc__policy____.html#ad3477ee19d6386e6c3dc4e43df7219b9">use_fd_cache</a>; <span class="comment">/*&lt; Do we cache fd or not? */</span>
<a name="l00439"></a><a class="code" href="structcache__inode__gc__policy____.html#a1f6c5b843f979247ceeb0f51382c4926">00439</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__gc__policy____.html#a1f6c5b843f979247ceeb0f51382c4926">fd_limit_percent</a>; <span class="comment">/*&lt; The percentage of the system-imposed</span>
<a name="l00440"></a>00440 <span class="comment">                                 maximum of file descriptors at which</span>
<a name="l00441"></a>00441 <span class="comment">                                 Ganesha will deny requests. */</span>
<a name="l00442"></a><a class="code" href="structcache__inode__gc__policy____.html#a413dee58253e3de214dc3b07bab05a62">00442</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__gc__policy____.html#a413dee58253e3de214dc3b07bab05a62">fd_hwmark_percent</a>; <span class="comment">/*&lt; The percentage of the system-imposed</span>
<a name="l00443"></a>00443 <span class="comment">                                  maximum of file descriptors above</span>
<a name="l00444"></a>00444 <span class="comment">                                  which Ganesha will make greater</span>
<a name="l00445"></a>00445 <span class="comment">                                  efforts at reaping. */</span>
<a name="l00446"></a><a class="code" href="structcache__inode__gc__policy____.html#ab522b01a60514fef773b677b3d437792">00446</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__gc__policy____.html#ab522b01a60514fef773b677b3d437792">fd_lwmark_percent</a>; <span class="comment">/*&lt; The percentage of the system-imposed</span>
<a name="l00447"></a>00447 <span class="comment">                                  maximum of file descriptors below</span>
<a name="l00448"></a>00448 <span class="comment">                                  which Ganesha will not reap file</span>
<a name="l00449"></a>00449 <span class="comment">                                  descriptonot reap file</span>
<a name="l00450"></a>00450 <span class="comment">                                  descriptorsrs. */</span>
<a name="l00451"></a><a class="code" href="structcache__inode__gc__policy____.html#a29f7027f967666760a1322bfe01b7642">00451</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__gc__policy____.html#a29f7027f967666760a1322bfe01b7642">reaper_work</a>; <span class="comment">/*&lt; Roughly, the amount of work to do on each</span>
<a name="l00452"></a>00452 <span class="comment">                            pass through the thread under normal</span>
<a name="l00453"></a>00453 <span class="comment">                            conditions.  (Ideally, a multipel of the</span>
<a name="l00454"></a>00454 <span class="comment">                            number of lanes.) */</span>
<a name="l00455"></a><a class="code" href="structcache__inode__gc__policy____.html#a220c239fb22728fd096d12b7463bfedd">00455</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__gc__policy____.html#a220c239fb22728fd096d12b7463bfedd">biggest_window</a>; <span class="comment">/*&lt; The largest window (as a percentage of</span>
<a name="l00456"></a>00456 <span class="comment">                               the system-imposed limit on FDs) of</span>
<a name="l00457"></a>00457 <span class="comment">                               work that we will do in extremis. */</span>
<a name="l00458"></a><a class="code" href="structcache__inode__gc__policy____.html#ae1c66d9148f63bea52768bf57365e757">00458</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__gc__policy____.html#ae1c66d9148f63bea52768bf57365e757">required_progress</a>; <span class="comment">/*&lt; Percentage of progress toward the</span>
<a name="l00459"></a>00459 <span class="comment">                                  high water mark required in in a</span>
<a name="l00460"></a>00460 <span class="comment">                                  pass through the thread when in</span>
<a name="l00461"></a>00461 <span class="comment">                                  extremis. */</span>
<a name="l00462"></a><a class="code" href="structcache__inode__gc__policy____.html#a15b177539b5cc6cbb9a6364dd7bfd9bf">00462</a>   <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="structcache__inode__gc__policy____.html#a15b177539b5cc6cbb9a6364dd7bfd9bf">futility_count</a>; <span class="comment">/*&lt; Number of failures to approach the high</span>
<a name="l00463"></a>00463 <span class="comment">                               watermark before we disable caching,</span>
<a name="l00464"></a>00464 <span class="comment">                               when in extremis. */</span>
<a name="l00465"></a>00465 } <a class="code" href="cache__inode_8h.html#ac8e47608764dcc97afc2c15be34710b4">cache_inode_gc_policy_t</a>;
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 <span class="keyword">extern</span> <a class="code" href="structcache__inode__gc__policy____.html">cache_inode_gc_policy_t</a> <a class="code" href="cache__inode__misc_8c.html#a10f3ba7df98a25f4b9a73e7cf1a0f33a">cache_inode_gc_policy</a>;
<a name="l00468"></a>00468 
<a name="l00473"></a><a class="code" href="unioncache__inode__create__arg____.html">00473</a> <span class="keyword">typedef</span> <span class="keyword">union </span><a class="code" href="unioncache__inode__create__arg____.html">cache_inode_create_arg__</a>
<a name="l00474"></a>00474 {
<a name="l00475"></a><a class="code" href="unioncache__inode__create__arg____.html#ace4ac560db9deae4afd7127f2dc5f934">00475</a>   <a class="code" href="structfsal__path____.html">fsal_path_t</a> <a class="code" href="unioncache__inode__create__arg____.html#ace4ac560db9deae4afd7127f2dc5f934">link_content</a>; <span class="comment">/*&lt; Content of a symbolic link */</span>
<a name="l00476"></a><a class="code" href="unioncache__inode__create__arg____.html#ab26bb3c3ebaf3ba8bc26b4540ab64e2f">00476</a>   <a class="code" href="structfsal__dev____.html">fsal_dev_t</a>  <a class="code" href="unioncache__inode__create__arg____.html#ab26bb3c3ebaf3ba8bc26b4540ab64e2f">dev_spec</a>; <span class="comment">/*&lt; Major/minor numbers for a device file */</span>
<a name="l00477"></a><a class="code" href="unioncache__inode__create__arg____.html#a537d0f7e6cf9b876f0d80f4f7a29cfa4">00477</a>   bool_t <a class="code" href="unioncache__inode__create__arg____.html#a537d0f7e6cf9b876f0d80f4f7a29cfa4">newly_created_dir</a>; <span class="comment">/*&lt; True if this directory has just been</span>
<a name="l00478"></a>00478 <span class="comment">                                created, rather than pre-existing and</span>
<a name="l00479"></a>00479 <span class="comment">                                loaded into the cache. */</span>
<a name="l00480"></a>00480 } <a class="code" href="cache__inode_8h.html#ac7084b2085736420f06658dfa7e5e2a6">cache_inode_create_arg_t</a>;
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 <span class="comment">/*</span>
<a name="l00483"></a>00483 <span class="comment"> * Flags</span>
<a name="l00484"></a>00484 <span class="comment"> */</span>
<a name="l00485"></a>00485 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_FLAG_NONE = 0x00; <span class="comment">/*&lt; The null flag */</span>
<a name="l00486"></a>00486 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_FLAG_CREATE = 0x01; <span class="comment">/*&lt; Indicate that this</span>
<a name="l00487"></a>00487 <span class="comment">                                                   inode newly</span>
<a name="l00488"></a>00488 <span class="comment">                                                   created, rather</span>
<a name="l00489"></a>00489 <span class="comment">                                                   than just being</span>
<a name="l00490"></a>00490 <span class="comment">                                                   loaded into the</span>
<a name="l00491"></a>00491 <span class="comment">                                                   cache */</span>
<a name="l00492"></a>00492 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_FLAG_LOCK = 0x02; <span class="comment">/*&lt; Instruct the called</span>
<a name="l00493"></a>00493 <span class="comment">                                                 function to take a</span>
<a name="l00494"></a>00494 <span class="comment">                                                 lock on the entry */</span>
<a name="l00495"></a>00495 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_FLAG_ATTR_HOLD = 0x04; <span class="comment">/*&lt; For a function</span>
<a name="l00496"></a>00496 <span class="comment">                                                      called with the</span>
<a name="l00497"></a>00497 <span class="comment">                                                      attribute lock</span>
<a name="l00498"></a>00498 <span class="comment">                                                      held, do not</span>
<a name="l00499"></a>00499 <span class="comment">                                                      release the</span>
<a name="l00500"></a>00500 <span class="comment">                                                      attribute lock</span>
<a name="l00501"></a>00501 <span class="comment">                                                      before</span>
<a name="l00502"></a>00502 <span class="comment">                                                      returning */</span>
<a name="l00503"></a>00503 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_FLAG_CONTENT_HOLD = 0x08; <span class="comment">/*&lt; For a</span>
<a name="l00504"></a>00504 <span class="comment">                                                         function</span>
<a name="l00505"></a>00505 <span class="comment">                                                         called with</span>
<a name="l00506"></a>00506 <span class="comment">                                                         the content</span>
<a name="l00507"></a>00507 <span class="comment">                                                         lock held, do</span>
<a name="l00508"></a>00508 <span class="comment">                                                         not release</span>
<a name="l00509"></a>00509 <span class="comment">                                                         the content</span>
<a name="l00510"></a>00510 <span class="comment">                                                         lock before</span>
<a name="l00511"></a>00511 <span class="comment">                                                         returning */</span>
<a name="l00512"></a>00512 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_FLAG_ATTR_HAVE = 0x10; <span class="comment">/*&lt; For a function,</span>
<a name="l00513"></a>00513 <span class="comment">                                                      indicates that</span>
<a name="l00514"></a>00514 <span class="comment">                                                      the attribute</span>
<a name="l00515"></a>00515 <span class="comment">                                                      lock is held */</span>
<a name="l00516"></a>00516 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_FLAG_CONTENT_HAVE = 0x20; <span class="comment">/*&lt; For a</span>
<a name="l00517"></a>00517 <span class="comment">                                                         function,</span>
<a name="l00518"></a>00518 <span class="comment">                                                         indicates</span>
<a name="l00519"></a>00519 <span class="comment">                                                         that the</span>
<a name="l00520"></a>00520 <span class="comment">                                                         content lock</span>
<a name="l00521"></a>00521 <span class="comment">                                                         is held */</span>
<a name="l00522"></a>00522 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_FLAG_REALLYCLOSE = 0x80; <span class="comment">/*&lt; Close a file</span>
<a name="l00523"></a>00523 <span class="comment">                                                        even with</span>
<a name="l00524"></a>00524 <span class="comment">                                                        caching</span>
<a name="l00525"></a>00525 <span class="comment">                                                        enabled */</span>
<a name="l00526"></a>00526 <span class="comment">/*</span>
<a name="l00527"></a>00527 <span class="comment"> * Flags to cache_inode_invalidate</span>
<a name="l00528"></a>00528 <span class="comment"> */</span>
<a name="l00529"></a>00529 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_INVALIDATE_CLEARBITS = 0x01;
<a name="l00530"></a>00530 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> CACHE_INODE_INVALIDATE_CLOSE = 0x02;
<a name="l00531"></a>00531 
<a name="l00532"></a>00532 <span class="comment">/*</span>
<a name="l00533"></a>00533 <span class="comment"> * Prototypes for the functions</span>
<a name="l00534"></a>00534 <span class="comment"> */</span>
<a name="l00535"></a>00535 
<a name="l00536"></a>00536 <span class="comment">/*</span>
<a name="l00537"></a>00537 <span class="comment"> * Possible errors</span>
<a name="l00538"></a>00538 <span class="comment"> */</span>
<a name="l00539"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">00539</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a>
<a name="l00540"></a>00540 {
<a name="l00541"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a3fdbbb2367268ae84ac11d7b189643d8">00541</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a3fdbbb2367268ae84ac11d7b189643d8">CACHE_INODE_SUCCESS</a>               = 0,
<a name="l00542"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a1915843665e061f9b874510cc6382bc9">00542</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a1915843665e061f9b874510cc6382bc9">CACHE_INODE_MALLOC_ERROR</a>          = 1,
<a name="l00543"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a9cf5e7e7d9af15c56de98d2e3a8528ce">00543</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a9cf5e7e7d9af15c56de98d2e3a8528ce">CACHE_INODE_POOL_MUTEX_INIT_ERROR</a> = 2,
<a name="l00544"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a7fce719c38bc7c5184590549d6d659d1">00544</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a7fce719c38bc7c5184590549d6d659d1">CACHE_INODE_GET_NEW_LRU_ENTRY</a>     = 3,
<a name="l00545"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a1fb3e5d693699c6142279757810ae6c3">00545</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a1fb3e5d693699c6142279757810ae6c3">CACHE_INODE_UNAPPROPRIATED_KEY</a>    = 4,
<a name="l00546"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a86613bc3a05ba135756f102393944133">00546</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a86613bc3a05ba135756f102393944133">CACHE_INODE_INIT_ENTRY_FAILED</a>     = 5,
<a name="l00547"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2aa3de98320a1cba72aeeefd31e124712a">00547</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2aa3de98320a1cba72aeeefd31e124712a">CACHE_INODE_FSAL_ERROR</a>            = 6,
<a name="l00548"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a076de8b129f67057d1294bedf7094aed">00548</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a076de8b129f67057d1294bedf7094aed">CACHE_INODE_LRU_ERROR</a>             = 7,
<a name="l00549"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ac1838632304273d612cd61d2ab31a1ce">00549</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ac1838632304273d612cd61d2ab31a1ce">CACHE_INODE_HASH_SET_ERROR</a>        = 8,
<a name="l00550"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a31102fd54b8481b29ee40b6a7f692e75">00550</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a31102fd54b8481b29ee40b6a7f692e75">CACHE_INODE_NOT_A_DIRECTORY</a>       = 9,
<a name="l00551"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a3b4d85140a3d8f501b3e318c82f0d13a">00551</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a3b4d85140a3d8f501b3e318c82f0d13a">CACHE_INODE_INCONSISTENT_ENTRY</a>    = 10,
<a name="l00552"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a461c7aae0d7d8861bc61ee7031bf79a9">00552</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a461c7aae0d7d8861bc61ee7031bf79a9">CACHE_INODE_BAD_TYPE</a>              = 11,
<a name="l00553"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ae81d3dfa51b14e0e0a26bb33b2f46490">00553</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ae81d3dfa51b14e0e0a26bb33b2f46490">CACHE_INODE_ENTRY_EXISTS</a>          = 12,
<a name="l00554"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2aa13bf3166511315448442f01b9909bfa">00554</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2aa13bf3166511315448442f01b9909bfa">CACHE_INODE_DIR_NOT_EMPTY</a>         = 13,
<a name="l00555"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a49bfbcb4177d74986dd63a1c8aaaadfc">00555</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a49bfbcb4177d74986dd63a1c8aaaadfc">CACHE_INODE_NOT_FOUND</a>             = 14,
<a name="l00556"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a07fdf53f0646a04f877c108ed99c293b">00556</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a07fdf53f0646a04f877c108ed99c293b">CACHE_INODE_INVALID_ARGUMENT</a>      = 15,
<a name="l00557"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2af9495df7ccc04c50609ceaf8f81e9c9b">00557</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2af9495df7ccc04c50609ceaf8f81e9c9b">CACHE_INODE_INSERT_ERROR</a>          = 16,
<a name="l00558"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a37c51c9a4e1098130f3d50e15af58635">00558</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a37c51c9a4e1098130f3d50e15af58635">CACHE_INODE_HASH_TABLE_ERROR</a>      = 17,
<a name="l00559"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2afa6e4cda579bf50a4cc7efddccab904b">00559</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2afa6e4cda579bf50a4cc7efddccab904b">CACHE_INODE_FSAL_EACCESS</a>          = 18,
<a name="l00560"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a3c0860cc76f604bcfc7bc09779d3d06c">00560</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a3c0860cc76f604bcfc7bc09779d3d06c">CACHE_INODE_IS_A_DIRECTORY</a>        = 19,
<a name="l00561"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2aaf42a5520c80584c436e6577c848fbed">00561</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2aaf42a5520c80584c436e6577c848fbed">CACHE_INODE_FSAL_EPERM</a>            = 20,
<a name="l00562"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a0b3b3a0e6a65c9f375c366e6d0349852">00562</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a0b3b3a0e6a65c9f375c366e6d0349852">CACHE_INODE_NO_SPACE_LEFT</a>         = 21,
<a name="l00563"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a6ea3d914d4fb4de66c7d13f31245a5ac">00563</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a6ea3d914d4fb4de66c7d13f31245a5ac">CACHE_INODE_CACHE_CONTENT_ERROR</a>   = 22,
<a name="l00564"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ab5b3592038c0b37022a99a7b0c87aa17">00564</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ab5b3592038c0b37022a99a7b0c87aa17">CACHE_INODE_CACHE_CONTENT_EXISTS</a>  = 23,
<a name="l00565"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ad76de37772e149413ed754160f118752">00565</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ad76de37772e149413ed754160f118752">CACHE_INODE_CACHE_CONTENT_EMPTY</a>   = 24,
<a name="l00566"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a2735653dbb65fcae621e042fe40316e3">00566</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a2735653dbb65fcae621e042fe40316e3">CACHE_INODE_READ_ONLY_FS</a>          = 25,
<a name="l00567"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2acc50439e4e107ce5487e79adfdbf4dc0">00567</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2acc50439e4e107ce5487e79adfdbf4dc0">CACHE_INODE_IO_ERROR</a>              = 26,
<a name="l00568"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a753b5e42145f8290242d1990792dbb0d">00568</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a753b5e42145f8290242d1990792dbb0d">CACHE_INODE_FSAL_ESTALE</a>           = 27,
<a name="l00569"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2acdd7ce7a12331e8bd87270730d23b298">00569</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2acdd7ce7a12331e8bd87270730d23b298">CACHE_INODE_FSAL_ERR_SEC</a>          = 28,
<a name="l00570"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ad34d88bf1ed87798b4c684a4fa5ac940">00570</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ad34d88bf1ed87798b4c684a4fa5ac940">CACHE_INODE_STATE_CONFLICT</a>        = 29,
<a name="l00571"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2af5c6f8a87057aebc9e59154de348d56a">00571</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2af5c6f8a87057aebc9e59154de348d56a">CACHE_INODE_QUOTA_EXCEEDED</a>        = 30,
<a name="l00572"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ac52f764b2c5c664df1cf11d8751965fb">00572</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ac52f764b2c5c664df1cf11d8751965fb">CACHE_INODE_DEAD_ENTRY</a>            = 31,
<a name="l00573"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a216876f1f0ed1ec8c7e61969e9e6cbfb">00573</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a216876f1f0ed1ec8c7e61969e9e6cbfb">CACHE_INODE_ASYNC_POST_ERROR</a>      = 32,
<a name="l00574"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a58fc37d01af497af261b2ee8ce65f137">00574</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a58fc37d01af497af261b2ee8ce65f137">CACHE_INODE_NOT_SUPPORTED</a>         = 33,
<a name="l00575"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a30d77d9ece8c0b24f90e6839eba76906">00575</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a30d77d9ece8c0b24f90e6839eba76906">CACHE_INODE_STATE_ERROR</a>           = 34,
<a name="l00576"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a682d21c0f90702d383c9b658e169f534">00576</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a682d21c0f90702d383c9b658e169f534">CACHE_INODE_DELAY</a>                 = 35,
<a name="l00577"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2aca5633ef3c1b4ca3d7b6c757b33e6cad">00577</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2aca5633ef3c1b4ca3d7b6c757b33e6cad">CACHE_INODE_NAME_TOO_LONG</a>         = 36,
<a name="l00578"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2aab32538c7951dae2ab8e045c141cb348">00578</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2aab32538c7951dae2ab8e045c141cb348">CACHE_INODE_BAD_COOKIE</a>            = 40,
<a name="l00579"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a7aa1c02604a27429b69ae2acf7914c37">00579</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a7aa1c02604a27429b69ae2acf7914c37">CACHE_INODE_FILE_BIG</a>              = 41,
<a name="l00580"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ac101705a0ba258752096d3b209a6c588">00580</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2ac101705a0ba258752096d3b209a6c588">CACHE_INODE_KILLED</a>                = 42,
<a name="l00581"></a><a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a913f825d5ec21974a3c12eb143b6f5de">00581</a>   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a913f825d5ec21974a3c12eb143b6f5de">CACHE_INODE_FILE_OPEN</a>             = 43,
<a name="l00582"></a>00582 } <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a>;
<a name="l00583"></a>00583 
<a name="l00596"></a><a class="code" href="cache__inode_8h.html#ae15b4790d2635a17e60170281546aa01">00596</a> <span class="keyword">typedef</span> bool_t(*<a class="code" href="cache__inode_8h.html#ae15b4790d2635a17e60170281546aa01" title="Type of callback for cache_inode_readdir.">cache_inode_readdir_cb_t</a>)(
<a name="l00597"></a>00597      <span class="keywordtype">void</span> *opaque,
<a name="l00598"></a>00598      <span class="keywordtype">char</span> *<a class="code" href="mount_8h.html#a2946c588fc7fa2fa5b43ac54b7872725">name</a>,
<a name="l00599"></a>00599      <a class="code" href="structfsal__handle____.html">fsal_handle_t</a> *handle,
<a name="l00600"></a>00600      <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attrs,
<a name="l00601"></a>00601      <a class="code" href="extended__types_8h.html#ad27ed092432b64ff558d2254c278720f">uint64_t</a> cookie);
<a name="l00602"></a>00602 
<a name="l00603"></a>00603 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="cache__inode__misc_8c.html#afc3c484c168ba4be4e799b77a6454ea3">cache_inode_err_str</a>(<a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> err);
<a name="l00604"></a>00604 
<a name="l00605"></a>00605 <span class="keywordtype">void</span> <a class="code" href="cache__inode__misc_8c.html#af5ac07e9bceb51f9867005ef900441a5" title="Final cleaning of an entry.">cache_inode_clean_entry</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry);
<a name="l00606"></a>00606 <span class="keywordtype">int</span> <a class="code" href="cache__inode__misc_8c.html#ab2ed61f21523805c300eae3d843ada57" title="Compares two keys used in cache inode.">cache_inode_compare_key_fsal</a>(<a class="code" href="structhash__buff.html">hash_buffer_t</a> *buff1, <a class="code" href="structhash__buff.html">hash_buffer_t</a> *buff2);
<a name="l00607"></a>00607 <span class="keywordtype">void</span> <a class="code" href="cache__inode__misc_8c.html#a2a029272e21a2d81fd91808dbe8ba01e" title="Release symlink content.">cache_inode_release_symlink</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry);
<a name="l00608"></a>00608 
<a name="l00609"></a>00609 <a class="code" href="structhash__table.html">hash_table_t</a> *<a class="code" href="cache__inode__init_8c.html#a8f1debb2bb4d8a5ba0647fbe26105ea2" title="Initialize the caching layer.">cache_inode_init</a>(<a class="code" href="structcache__inode__parameter____.html">cache_inode_parameter_t</a> <a class="code" href="Connectathon__config__parsing_8c.html#a84f6f668b79957f185ab5a6c535f2e7c">param</a>,
<a name="l00610"></a>00610                                <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> * status);
<a name="l00611"></a>00611 
<a name="l00612"></a>00612 <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *<a class="code" href="cache__inode__get_8c.html#af93e3320581ae2ea6e5633598d5a2c77" title="Gets an entry by using its fsdata as a key and caches it if needed.">cache_inode_get</a>(<a class="code" href="structcache__inode__fsal__data____.html">cache_inode_fsal_data_t</a> *fsdata,
<a name="l00613"></a>00613                                <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr,
<a name="l00614"></a>00614                                <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00615"></a>00615                                <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *associated,
<a name="l00616"></a>00616                                <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00617"></a>00617 <span class="keywordtype">void</span> <a class="code" href="cache__inode__get_8c.html#a8ff682b5012ccc7a46cb876664d0a7a2">cache_inode_put</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry);
<a name="l00618"></a>00618 
<a name="l00619"></a>00619 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__access_8c.html#a5f07fcb8c1b42d25d25fd0f3cd0e1ce7" title="Checks the permissions on an object.">cache_inode_access_sw</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00620"></a>00620                                            <a class="code" href="fsal__types_8h.html#a67f294990c65fb1f373bd9a21b139d67">fsal_accessflags_t</a> access_type,
<a name="l00621"></a>00621                                            <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00622"></a>00622                                            <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status,
<a name="l00623"></a>00623                                            bool_t use_mutex);
<a name="l00624"></a>00624 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__access_8c.html#a0d928b5c1e7861eaab1d30badeee10e8" title="Checks entry permissions without taking a lock.">cache_inode_access_no_mutex</a>(
<a name="l00625"></a>00625     <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00626"></a>00626     <a class="code" href="fsal__types_8h.html#a67f294990c65fb1f373bd9a21b139d67">fsal_accessflags_t</a> access_type,
<a name="l00627"></a>00627     <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00628"></a>00628     <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00629"></a>00629 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__access_8c.html#a63d66070c6c6d69bbf8959a1d6c724c5" title="Checks permissions on an entry.">cache_inode_access</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00630"></a>00630                                         <a class="code" href="fsal__types_8h.html#a67f294990c65fb1f373bd9a21b139d67">fsal_accessflags_t</a> access_type,
<a name="l00631"></a>00631                                         <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00632"></a>00632                                         <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00633"></a>00633 
<a name="l00634"></a>00634 <a class="code" href="FSAL_2FSAL__TEMPLATE_2fsal__types_8h.html#aecb7132e1cc257d558b3b2b4fbe94284">fsal_file_t</a> *<a class="code" href="cache__inode__open__close_8c.html#ad56db1a0f05a02b28859ef3256cdd3ba" title="Returns a file descriptor, if open.">cache_inode_fd</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry);
<a name="l00635"></a>00635 
<a name="l00636"></a>00636 bool_t <a class="code" href="cache__inode__open__close_8c.html#aa7867c8645252f82b0226587176e6ccb" title="Check if a file is available to read.">is_open_for_read</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry);
<a name="l00637"></a>00637 bool_t <a class="code" href="cache__inode__open__close_8c.html#a1b72d802ca1e38404534aff676268034" title="Check if a file is available to write.">is_open_for_write</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry);
<a name="l00638"></a>00638 
<a name="l00639"></a>00639 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__open__close_8c.html#a396684171093081bc52283a6030e6267" title="Opens a file descriptor.">cache_inode_open</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00640"></a>00640                                       <a class="code" href="fsal__types_8h.html#a32a4d2db8d51a91baa4adf861fcdd914">fsal_openflags_t</a> openflags,
<a name="l00641"></a>00641                                       <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00642"></a>00642                                       <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> flags,
<a name="l00643"></a>00643                                       <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00644"></a>00644 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__open__close_8c.html#a6f0677cfc2f256bff97a4f49cb2728d5" title="Close a file.">cache_inode_close</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00645"></a>00645                                        <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> flags,
<a name="l00646"></a>00646                                        <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00647"></a>00647 
<a name="l00648"></a>00648 <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *<a class="code" href="cache__inode__create_8c.html#a9d4c789a65dcfb50a066d74e7c2e2322" title="Creates an object in a directory.">cache_inode_create</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry_parent,
<a name="l00649"></a>00649                                   <a class="code" href="structfsal__name____.html">fsal_name_t</a> *<a class="code" href="mount_8h.html#a2946c588fc7fa2fa5b43ac54b7872725">name</a>,
<a name="l00650"></a>00650                                   <a class="code" href="cache__inode_8h.html#ae017962c50fe48834d8638069c7edc99">cache_inode_file_type_t</a> type,
<a name="l00651"></a>00651                                   <a class="code" href="fsal__types_8h.html#ae8181bd7dedf0606eeaf57e8fb64a7f0">fsal_accessmode_t</a> mode,
<a name="l00652"></a>00652                                   <a class="code" href="unioncache__inode__create__arg____.html">cache_inode_create_arg_t</a> *create_arg,
<a name="l00653"></a>00653                                   <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr,
<a name="l00654"></a>00654                                   <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00655"></a>00655                                   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00656"></a>00656 
<a name="l00657"></a>00657 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__getattr_8c.html#a08ad01b43bf9ec833899b526cea387bf" title="Gets the attributes for a cached entry.">cache_inode_getattr</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00658"></a>00658                                          <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr,
<a name="l00659"></a>00659                                          <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00660"></a>00660                                          <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00661"></a>00661 
<a name="l00662"></a>00662 <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *<a class="code" href="cache__inode__lookup_8c.html#ae661a3ae39198c8bd4fe0c7f5860be32" title="Do the work of looking up a name in a directory.">cache_inode_lookup_impl</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry_parent,
<a name="l00663"></a>00663                                        <a class="code" href="structfsal__name____.html">fsal_name_t</a> *<a class="code" href="mount_8h.html#a2946c588fc7fa2fa5b43ac54b7872725">name</a>,
<a name="l00664"></a>00664                                        <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00665"></a>00665                                        <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00666"></a>00666 <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *<a class="code" href="cache__inode__lookup_8c.html#adaf1a294e00f05580dcf2a8b54309454" title="Public function for looking up a name in a directory.">cache_inode_lookup</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry_parent,
<a name="l00667"></a>00667                                   <a class="code" href="structfsal__name____.html">fsal_name_t</a> *<a class="code" href="mount_8h.html#a2946c588fc7fa2fa5b43ac54b7872725">name</a>,
<a name="l00668"></a>00668                                   <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr,
<a name="l00669"></a>00669                                   <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00670"></a>00670                                   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00671"></a>00671 
<a name="l00672"></a>00672 <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *<a class="code" href="cache__inode__lookupp_8c.html#aec2852f8ac37de4be9716cfa81f9a129" title="Implements parent lookup functionality.">cache_inode_lookupp_impl</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00673"></a>00673                                         <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00674"></a>00674                                         <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00675"></a>00675 <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *<a class="code" href="cache__inode__lookupp_8c.html#a67ba9f31113205922a6a17cc37971a9c" title="Public function to look up a directory&amp;#39;s parent.">cache_inode_lookupp</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00676"></a>00676                                    <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00677"></a>00677                                    <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00678"></a>00678 
<a name="l00679"></a>00679 
<a name="l00680"></a>00680 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__readlink_8c.html#a21f6342539cfd7cf905eaa0b52e065fb" title="Read the target of a symlink.">cache_inode_readlink</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00681"></a>00681                                           <a class="code" href="structfsal__path____.html">fsal_path_t</a> *link_content,
<a name="l00682"></a>00682                                           <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00683"></a>00683                                           <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00684"></a>00684 
<a name="l00685"></a>00685 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__link_8c.html#a7d492ae716714b58299f7272f59c82cb" title="Links a new name to a file.">cache_inode_link</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry_src,
<a name="l00686"></a>00686                                       <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry_dir_dest,
<a name="l00687"></a>00687                                       <a class="code" href="structfsal__name____.html">fsal_name_t</a> *link_name,
<a name="l00688"></a>00688                                       <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr,
<a name="l00689"></a>00689                                       <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00690"></a>00690                                       <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00691"></a>00691 
<a name="l00692"></a>00692 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__remove_8c.html#a65e424d859ebefaff9700d3f3287a9e1" title="Public function to remove a name from a directory.">cache_inode_remove</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00693"></a>00693                                         <a class="code" href="structfsal__name____.html">fsal_name_t</a> *node_name,
<a name="l00694"></a>00694                                         <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr,
<a name="l00695"></a>00695                                         <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00696"></a>00696                                         <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00697"></a>00697 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__remove_8c.html#a21528f9124f3756dca64b8a6d09f3e22" title="Implement actual work of removing file.">cache_inode_remove_impl</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00698"></a>00698                                              <a class="code" href="structfsal__name____.html">fsal_name_t</a> *<a class="code" href="mount_8h.html#a2946c588fc7fa2fa5b43ac54b7872725">name</a>,
<a name="l00699"></a>00699                                              <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00700"></a>00700                                              <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status,
<a name="l00701"></a>00701                                              <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> flags);
<a name="l00702"></a>00702 
<a name="l00703"></a>00703 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__remove_8c.html#a10e64dec0972b520298e287c45a16a16" title="Clean resources associated with entry.">cache_inode_clean_internal</a>(
<a name="l00704"></a>00704      <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *to_remove_entry);
<a name="l00705"></a>00705 
<a name="l00706"></a>00706 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__readdir_8c.html#ab3ddec50026559a17735910f48f49cee" title="Perform an operation on it on a cached entry.">cache_inode_operate_cached_dirent</a>(
<a name="l00707"></a>00707      <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry_parent,
<a name="l00708"></a>00708      <a class="code" href="structfsal__name____.html">fsal_name_t</a> *<a class="code" href="mount_8h.html#a2946c588fc7fa2fa5b43ac54b7872725">name</a>,
<a name="l00709"></a>00709      <a class="code" href="structfsal__name____.html">fsal_name_t</a> *newname,
<a name="l00710"></a>00710      <a class="code" href="cache__inode_8h.html#a4961f3249c42b3ee87cc1799b3421ffd">cache_inode_dirent_op_t</a> dirent_op);
<a name="l00711"></a>00711 
<a name="l00712"></a>00712 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__readdir_8c.html#aaf48f8a77f45fb31c001b0c7e0405e4a" title="Removes an entry from a cached directory.">cache_inode_remove_cached_dirent</a>(
<a name="l00713"></a>00713      <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry_parent,
<a name="l00714"></a>00714      <a class="code" href="structfsal__name____.html">fsal_name_t</a> *<a class="code" href="mount_8h.html#a2946c588fc7fa2fa5b43ac54b7872725">name</a>,
<a name="l00715"></a>00715      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00716"></a>00716 
<a name="l00717"></a>00717 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__rename_8c.html#a903f923eb51b5d3b169ee5be2039dea5" title="Renames an entry in the same directory.">cache_inode_rename_cached_dirent</a>(
<a name="l00718"></a>00718      <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry_parent,
<a name="l00719"></a>00719      <a class="code" href="structfsal__name____.html">fsal_name_t</a> *oldname,
<a name="l00720"></a>00720      <a class="code" href="structfsal__name____.html">fsal_name_t</a> *newname,
<a name="l00721"></a>00721      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00722"></a>00722 
<a name="l00723"></a>00723 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__rename_8c.html#af0a97520c36e0c0677cfb6b9273d3a37" title="Renames an entry.">cache_inode_rename</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00724"></a>00724                                         <a class="code" href="structfsal__name____.html">fsal_name_t</a> *oldname,
<a name="l00725"></a>00725                                         <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry_dirdest,
<a name="l00726"></a>00726                                         <a class="code" href="structfsal__name____.html">fsal_name_t</a> *newname,
<a name="l00727"></a>00727                                         <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr_src,
<a name="l00728"></a>00728                                         <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr_dst,
<a name="l00729"></a>00729                                         <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00730"></a>00730                                         <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00731"></a>00731 
<a name="l00732"></a>00732 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__setattr_8c.html#a0e222cc66f530e1355b313bb51d87b75" title="Set the attributes for a file.">cache_inode_setattr</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00733"></a>00733                                          <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr,
<a name="l00734"></a>00734                                          <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00735"></a>00735                                          <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00736"></a>00736 
<a name="l00737"></a>00737 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a>
<a name="l00738"></a>00738 <a class="code" href="cache__inode__truncate_8c.html#a9382637d273a69e4191655560b29a366" title="truncates a regular file">cache_inode_truncate_impl</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00739"></a>00739                           <a class="code" href="fsal__types_8h.html#a30fc893739650c71e910bc834eb401df">fsal_size_t</a> length,
<a name="l00740"></a>00740                           <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr,
<a name="l00741"></a>00741                           <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00742"></a>00742                           <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00743"></a>00743 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__truncate_8c.html#aa98116f729d68a672032239042bbe915" title="Truncates a regular file specified by its cache entry.">cache_inode_truncate</a>(
<a name="l00744"></a>00744      <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00745"></a>00745      <a class="code" href="fsal__types_8h.html#a30fc893739650c71e910bc834eb401df">fsal_size_t</a> length,
<a name="l00746"></a>00746      <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr,
<a name="l00747"></a>00747      <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00748"></a>00748      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00749"></a>00749 
<a name="l00750"></a>00750 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__misc_8c.html#aaa50487b9b403fd85b4a845de1a3df69" title="Converts an FSAL error to the corresponding cache_inode error.">cache_inode_error_convert</a>(<a class="code" href="structfsal__status____.html">fsal_status_t</a> fsal_status);
<a name="l00751"></a>00751 
<a name="l00752"></a>00752 <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *<a class="code" href="cache__inode__misc_8c.html#a6bc339e647145f134c4c2b01450d229d" title="Adds a new entry to the cache.">cache_inode_new_entry</a>(<a class="code" href="structcache__inode__fsal__data____.html">cache_inode_fsal_data_t</a> *fsdata,
<a name="l00753"></a>00753                                      <a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a> *attr,
<a name="l00754"></a>00754                                      <a class="code" href="cache__inode_8h.html#ae017962c50fe48834d8638069c7edc99">cache_inode_file_type_t</a> type,
<a name="l00755"></a>00755                                      <a class="code" href="unioncache__inode__create__arg____.html">cache_inode_create_arg_t</a> *create_arg,
<a name="l00756"></a>00756                                      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00757"></a>00757 
<a name="l00758"></a>00758 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode_8h.html#aaedc1987c1fc2fd14e2d742d95881ab1">cache_inode_add_data_cache</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00759"></a>00759                                                 <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00760"></a>00760                                                 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00761"></a>00761 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode_8h.html#aa1da48f0f3c23ae5511a236853fa19cb">cache_inode_release_data_cache</a>(
<a name="l00762"></a>00762      <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00763"></a>00763      <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00764"></a>00764      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00765"></a>00765 
<a name="l00766"></a>00766 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__rdwr_8c.html#a232a9f0d0b4a94f1fd2c5f2714d6d60c" title="Reads/Writes through the cache layer.">cache_inode_rdwr</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00767"></a>00767                                       <a class="code" href="cache__inode_8h.html#ab09d7c8ceb9e0d139e5cf6461fb37d2d">cache_inode_io_direction_t</a> io_direction,
<a name="l00768"></a>00768                                       <a class="code" href="extended__types_8h.html#ad27ed092432b64ff558d2254c278720f">uint64_t</a> offset,
<a name="l00769"></a>00769                                       <span class="keywordtype">size_t</span> io_size,
<a name="l00770"></a>00770                                       <span class="keywordtype">size_t</span> *bytes_moved,
<a name="l00771"></a>00771                                       <span class="keywordtype">void</span> *buffer,
<a name="l00772"></a>00772                                       bool_t *eof,
<a name="l00773"></a>00773                                       <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00774"></a>00774                                       <a class="code" href="cache__inode_8h.html#aed11d3b4bb5ec5b5adda6a57c192d70f">cache_inode_stability_t</a> stable,
<a name="l00775"></a>00775                                       <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00776"></a>00776 
<a name="l00777"></a>00777 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a>
<a name="l00778"></a>00778 cache_inode_read(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00779"></a>00779                  <a class="code" href="extended__types_8h.html#ad27ed092432b64ff558d2254c278720f">uint64_t</a> offset,
<a name="l00780"></a>00780                  <span class="keywordtype">size_t</span> io_size,
<a name="l00781"></a>00781                  <span class="keywordtype">size_t</span> *bytes_moved,
<a name="l00782"></a>00782                  <span class="keywordtype">void</span> *buffer,
<a name="l00783"></a>00783                  bool_t *eof,
<a name="l00784"></a>00784                  <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00785"></a>00785                  <a class="code" href="cache__inode_8h.html#aed11d3b4bb5ec5b5adda6a57c192d70f">cache_inode_stability_t</a> stable,
<a name="l00786"></a>00786                  <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status)
<a name="l00787"></a>00787 {
<a name="l00788"></a>00788   <span class="keywordflow">return</span> <a class="code" href="cache__inode__rdwr_8c.html#a232a9f0d0b4a94f1fd2c5f2714d6d60c" title="Reads/Writes through the cache layer.">cache_inode_rdwr</a>(entry, <a class="code" href="cache__inode_8h.html#a67d7c7093257ce44ef7db8473ba3bfe9aeae4ed38f0720d45bd9948b2107df50e">CACHE_INODE_READ</a>, offset, io_size,
<a name="l00789"></a>00789                           bytes_moved, buffer, eof, context,
<a name="l00790"></a>00790                           stable, status);
<a name="l00791"></a>00791 }
<a name="l00792"></a>00792 
<a name="l00793"></a>00793 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a>
<a name="l00794"></a>00794 cache_inode_write(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00795"></a>00795                   <a class="code" href="extended__types_8h.html#ad27ed092432b64ff558d2254c278720f">uint64_t</a> offset,
<a name="l00796"></a>00796                   <span class="keywordtype">size_t</span> io_size,
<a name="l00797"></a>00797                   <span class="keywordtype">size_t</span> *bytes_moved,
<a name="l00798"></a>00798                   <span class="keywordtype">void</span> *buffer,
<a name="l00799"></a>00799                   bool_t *eof,
<a name="l00800"></a>00800                   <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00801"></a>00801                   <a class="code" href="cache__inode_8h.html#aed11d3b4bb5ec5b5adda6a57c192d70f">cache_inode_stability_t</a> stable,
<a name="l00802"></a>00802                   <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status)
<a name="l00803"></a>00803 {
<a name="l00804"></a>00804   <span class="keywordflow">return</span> <a class="code" href="cache__inode__rdwr_8c.html#a232a9f0d0b4a94f1fd2c5f2714d6d60c" title="Reads/Writes through the cache layer.">cache_inode_rdwr</a>(entry, <a class="code" href="cache__inode_8h.html#a67d7c7093257ce44ef7db8473ba3bfe9a7cf382eb3f7df151893437fff2bb5c0b">CACHE_INODE_WRITE</a>, offset, io_size,
<a name="l00805"></a>00805                           bytes_moved, buffer, eof, context,
<a name="l00806"></a>00806                           stable, status);
<a name="l00807"></a>00807 }
<a name="l00808"></a>00808 
<a name="l00809"></a>00809 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__commit_8c.html#aafcfdb84e4b706f608ba33ab3b693c8b" title="Commits a write operation to stable storage.">cache_inode_commit</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00810"></a>00810                                         <a class="code" href="extended__types_8h.html#ad27ed092432b64ff558d2254c278720f">uint64_t</a> offset,
<a name="l00811"></a>00811                                         <span class="keywordtype">size_t</span> count,
<a name="l00812"></a>00812                                         <a class="code" href="cache__inode_8h.html#aed11d3b4bb5ec5b5adda6a57c192d70f">cache_inode_stability_t</a> stability,
<a name="l00813"></a>00813                                         <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00814"></a>00814                                         <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__readdir_8c.html#aa159b2619535ae3c7da6ccd44dd7c020" title="Cache complete directory contents.">cache_inode_readdir_populate</a>(
<a name="l00817"></a>00817      <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *directory,
<a name="l00818"></a>00818      <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00819"></a>00819      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00820"></a>00820 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__readdir_8c.html#a4bedd92e6b201a9fff52ba1751f0b770" title="Reads a directory.">cache_inode_readdir</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *directory,
<a name="l00821"></a>00821                                          <a class="code" href="extended__types_8h.html#ad27ed092432b64ff558d2254c278720f">uint64_t</a> cookie,
<a name="l00822"></a>00822                                          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *nbfound,
<a name="l00823"></a>00823                                          bool_t *eod_met,
<a name="l00824"></a>00824                                          <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00825"></a>00825                                          <a class="code" href="cache__inode_8h.html#ae15b4790d2635a17e60170281546aa01" title="Type of callback for cache_inode_readdir.">cache_inode_readdir_cb_t</a> cb,
<a name="l00826"></a>00826                                          <span class="keywordtype">void</span> *cb_opaque,
<a name="l00827"></a>00827                                          <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00828"></a>00828 
<a name="l00829"></a>00829 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__readdir_8c.html#a812cc6580870ef10e5a773b4be496969" title="Adds a directory entry to a cached directory.">cache_inode_add_cached_dirent</a>(
<a name="l00830"></a>00830      <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *parent,
<a name="l00831"></a>00831      <a class="code" href="structfsal__name____.html">fsal_name_t</a> *<a class="code" href="mount_8h.html#a2946c588fc7fa2fa5b43ac54b7872725">name</a>,
<a name="l00832"></a>00832      <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00833"></a>00833      <a class="code" href="structcache__inode__dir__entry____.html">cache_inode_dir_entry_t</a> **dir_entry,
<a name="l00834"></a>00834      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00835"></a>00835 <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *<a class="code" href="cache__inode__make__root_8c.html#a1832d7485298304ec3f2c191c1f7621e" title="Inserts the root of a FS in the cache.">cache_inode_make_root</a>(<a class="code" href="structcache__inode__fsal__data____.html">cache_inode_fsal_data_t</a> *fsdata,
<a name="l00836"></a>00836                                      <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00837"></a>00837                                      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00838"></a>00838 
<a name="l00839"></a>00839 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__misc_8c.html#a75d94c6dd8bc4aa6466faa7c71de9a66" title="Conditionally refresh attributes.">cache_inode_check_trust</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00840"></a>00840                                              <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context);
<a name="l00841"></a>00841 
<a name="l00842"></a>00842 <a class="code" href="cache__inode_8h.html#ae017962c50fe48834d8638069c7edc99">cache_inode_file_type_t</a> <a class="code" href="cache__inode__misc_8c.html#a8f6934bbf38300379caf1342b6a63b26" title="converts an FSAL type to the corresponding cache_inode type">cache_inode_fsal_type_convert</a>(<a class="code" href="fsal__types_8h.html#ac7b386ef9390188b635598625b481fb1">fsal_nodetype_t</a> type);
<a name="l00843"></a>00843 
<a name="l00844"></a>00844 <span class="keywordtype">int</span> <a class="code" href="cache__inode__misc_8c.html#a82d5fbc5e1c8796fe22378f8a7efc835" title="Test if an entry can be overwritten during a rename.">cache_inode_types_are_rename_compatible</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *src,
<a name="l00845"></a>00845                                             <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *dest);
<a name="l00846"></a>00846 
<a name="l00847"></a>00847 <span class="keywordtype">void</span> <a class="code" href="cache__inode__misc_8c.html#ac01c860fa6b33b5212b274b6f78e26ec" title="Prints the content of a directory.">cache_inode_print_dir</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *cache_entry_root);
<a name="l00848"></a>00848 
<a name="l00849"></a>00849 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__statfs_8c.html#af75281ba04ae34842f1228bbc0544b09">cache_inode_statfs</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00850"></a>00850                                         <a class="code" href="structfsal__dynamicfsinfo____.html">fsal_dynamicfsinfo_t</a> *dynamicinfo,
<a name="l00851"></a>00851                                         <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context,
<a name="l00852"></a>00852                                         <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00853"></a>00853 
<a name="l00854"></a>00854 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__remove_8c.html#ae75a83f45bc8a43ef6dba615c5d811cc" title="Checks if a directory is empty without a lock.">cache_inode_is_dir_empty</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry);
<a name="l00855"></a>00855 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__remove_8c.html#acac288f3fc82cfe50c639be19afe7cfd" title="Checks if a directory is empty, acquiring lock.">cache_inode_is_dir_empty_WithLock</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry);
<a name="l00856"></a>00856 
<a name="l00857"></a>00857 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__readdir_8c.html#a71db87a36331a75b6ff7987f609cd58b" title="Invalidates all cached entries for a directory.">cache_inode_invalidate_all_cached_dirent</a>(
<a name="l00858"></a>00858      <a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00859"></a>00859      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status);
<a name="l00860"></a>00860 
<a name="l00861"></a>00861 <span class="keywordtype">void</span> <a class="code" href="cache__inode__misc_8c.html#adb681e68b3e72288cbc0b4dab6aeebae" title="Release cached directory content.">cache_inode_release_dirents</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00862"></a>00862                                  <a class="code" href="cache__inode_8h.html#ae6e49f8c8c15b191ff9ffc007d48043e">cache_inode_avl_which_t</a> which);
<a name="l00863"></a>00863 
<a name="l00864"></a>00864 <span class="keywordtype">void</span> <a class="code" href="cache__inode__kill__entry_8c.html#a643ff87017990abdba2c38f0939cd5af" title="Some routines for management of the cache_inode layer, shared by other calls.">cache_inode_kill_entry</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry);
<a name="l00865"></a>00865 
<a name="l00866"></a>00866 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__invalidate_8c.html#a919c878a11acf9bee7a38e1b02ab5361" title="invalidates an entry in the cache">cache_inode_invalidate</a>(
<a name="l00867"></a>00867      <a class="code" href="structcache__inode__fsal__data____.html">cache_inode_fsal_data_t</a> *fsal_data,
<a name="l00868"></a>00868      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> *status,
<a name="l00869"></a>00869      <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> flags);
<a name="l00870"></a>00870 
<a name="l00871"></a>00871 <span class="comment">/* Parsing functions */</span>
<a name="l00872"></a>00872 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__read__conf_8c.html#a6809dfdf569235e4d734ebc495203b0b" title="Read the configuration for the Cache_inode hash table.">cache_inode_read_conf_hash_parameter</a>(
<a name="l00873"></a>00873      <a class="code" href="config__parsing_8h.html#adfea46b92009fb7b8d52287bd2aa1900">config_file_t</a> in_config,
<a name="l00874"></a>00874      <a class="code" href="structcache__inode__parameter____.html">cache_inode_parameter_t</a> *pparam);
<a name="l00875"></a>00875 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__read__conf_8c.html#a714afeb5f13ca662dbb8151f40692be2" title="Read the configuration for the Cache inode layer.">cache_inode_read_conf_parameter</a>(
<a name="l00876"></a>00876      <a class="code" href="config__parsing_8h.html#adfea46b92009fb7b8d52287bd2aa1900">config_file_t</a> in_config,
<a name="l00877"></a>00877      <a class="code" href="structcache__inode__parameter____.html">cache_inode_parameter_t</a> *pparam);
<a name="l00878"></a>00878 <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> <a class="code" href="cache__inode__read__conf_8c.html#a82a05191186d965dbdb7a470d8f84b50" title="Read the garbage collection policy.">cache_inode_read_conf_gc_policy</a>(
<a name="l00879"></a>00879      <a class="code" href="config__parsing_8h.html#adfea46b92009fb7b8d52287bd2aa1900">config_file_t</a> in_config,
<a name="l00880"></a>00880      <a class="code" href="structcache__inode__gc__policy____.html">cache_inode_gc_policy_t</a> *ppolicy);
<a name="l00881"></a>00881 <span class="keywordtype">void</span> <a class="code" href="cache__inode__read__conf_8c.html#af65fc78f0b981972d82cfe32477cfec2" title="Prints the garbage collection policy.">cache_inode_print_conf_hash_parameter</a>(FILE *output,
<a name="l00882"></a>00882                                            <a class="code" href="structcache__inode__parameter____.html">cache_inode_parameter_t</a> *<a class="code" href="Connectathon__config__parsing_8c.html#a84f6f668b79957f185ab5a6c535f2e7c">param</a>);
<a name="l00883"></a>00883 <span class="keywordtype">void</span> <a class="code" href="cache__inode__read__conf_8c.html#ac71c6ac416a3560927396dbf47481427" title="Prints cache inode configuration.">cache_inode_print_conf_parameter</a>(
<a name="l00884"></a>00884      FILE *output,
<a name="l00885"></a>00885      <a class="code" href="structcache__inode__parameter____.html">cache_inode_parameter_t</a> *<a class="code" href="Connectathon__config__parsing_8c.html#a84f6f668b79957f185ab5a6c535f2e7c">param</a>);
<a name="l00886"></a>00886 <span class="keywordtype">void</span> <a class="code" href="cache__inode__read__conf_8c.html#ac382c72017372adcf3dad7c52ecd21bf" title="Prints the garbage collection policy.">cache_inode_print_conf_gc_policy</a>(FILE *output,
<a name="l00887"></a>00887                                       <a class="code" href="structcache__inode__gc__policy____.html">cache_inode_gc_policy_t</a> *gcpolicy);
<a name="l00888"></a>00888 <span class="keywordtype">void</span> <a class="code" href="cache__inode__read__conf_8c.html#add615c99ca80ea61b95346faa49e6200">cache_inode_expire_to_str</a>(<a class="code" href="cache__inode_8h.html#a528237af2ef7cef5ff19555de7fb980a">cache_inode_expire_type_t</a> type,
<a name="l00889"></a>00889                                time_t value,
<a name="l00890"></a>00890                                <span class="keywordtype">char</span> *<a class="code" href="test__nfs__ip__name_8c.html#a0204bbf34f64a80680c73f74564b6d22">out</a>);
<a name="l00891"></a>00891 <span class="keyword">inline</span> bool_t <a class="code" href="cache__inode__misc_8c.html#a0b14aaea5e11339b9b72dee2268d93c3" title="Return true if a file holds state.">cache_inode_file_holds_state</a>(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry);
<a name="l00892"></a>00892 
<a name="l00893"></a>00893 <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="cache__inode__misc_8c.html#a029c96ce29eba0cd347ceee39d8bcaae" title="Set the fsal_time in a pentry struct to the current time.">cache_inode_set_time_current</a>(<a class="code" href="structfsal__time____.html">fsal_time_t</a> *ptime);
<a name="l00894"></a>00894 
<a name="l00895"></a>00895 <span class="comment">/* Hash functions for hashtables and RBT */</span>
<a name="l00896"></a>00896 <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="cache__inode__fsal__hash_8c.html#ab951ddce73109332f38b619de9ee769b">cache_inode_fsal_hash_func</a>(<a class="code" href="structhash__param.html">hash_parameter_t</a> *p_hparam,
<a name="l00897"></a>00897                                          <a class="code" href="structhash__buff.html">hash_buffer_t</a> *buffclef);
<a name="l00898"></a>00898 <a class="code" href="extended__types_8h.html#ad27ed092432b64ff558d2254c278720f">uint64_t</a> <a class="code" href="cache__inode__fsal__hash_8c.html#a0da6f2aa693609bfbd5ec18167002ad4">cache_inode_fsal_rbt_func</a>(<a class="code" href="structhash__param.html">hash_parameter_t</a> *p_hparam,
<a name="l00899"></a>00899                                         <a class="code" href="structhash__buff.html">hash_buffer_t</a> *buffclef);
<a name="l00900"></a>00900 <span class="keywordtype">int</span> <a class="code" href="cache__inode__fsal__hash_8c.html#a129ce28465554788ea4c0f3273373144">cache_inode_fsal_rbt_both</a>(<a class="code" href="structhash__param.html">hash_parameter_t</a> *p_hparam,
<a name="l00901"></a>00901                               <a class="code" href="structhash__buff.html">hash_buffer_t</a> *buffclef,
<a name="l00902"></a>00902                               <a class="code" href="extended__types_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *phashval,
<a name="l00903"></a>00903                               <a class="code" href="extended__types_8h.html#ad27ed092432b64ff558d2254c278720f">uint64_t</a> *prbtval);
<a name="l00904"></a>00904 <span class="keywordtype">int</span> <a class="code" href="cache__inode__fsal__hash_8c.html#ab57b9991b37ed9c7d252a036cecc1eb2">display_key</a>(<a class="code" href="structhash__buff.html">hash_buffer_t</a> *pbuff, <span class="keywordtype">char</span> *str);
<a name="l00905"></a>00905 <span class="keywordtype">int</span> <a class="code" href="cache__inode__fsal__hash_8c.html#a63eb2d82a50eb35afc8fd351d2d3bc1f">display_not_implemented</a>(<a class="code" href="structhash__buff.html">hash_buffer_t</a> *pbuff,
<a name="l00906"></a>00906                             <span class="keywordtype">char</span> *str);
<a name="l00907"></a>00907 <span class="keywordtype">int</span> <a class="code" href="cache__inode__fsal__hash_8c.html#ab57e58023e08c7ba4ac7611e100ada2c">display_value</a>(<a class="code" href="structhash__buff.html">hash_buffer_t</a> *pbuff, <span class="keywordtype">char</span> *str);
<a name="l00908"></a>00908 
<a name="l00919"></a>00919 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00920"></a>00920 cache_inode_fixup_md(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry)
<a name="l00921"></a>00921 {
<a name="l00922"></a>00922      <span class="comment">/* Set the refresh time for the cache entry */</span>
<a name="l00923"></a>00923      entry-&gt;<a class="code" href="structcache__entry__t.html#a855ffe691f605541520b47bf4d12590f">attr_time</a> = time(<a class="code" href="Getopt_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00924"></a>00924      <span class="comment">/* TODO: This should really be changed to use sub-second time</span>
<a name="l00925"></a>00925 <span class="comment">        resolution when it&#39;s available. */</span>
<a name="l00926"></a>00926      entry-&gt;<a class="code" href="structcache__entry__t.html#a564df0bd95a95605998780d01032619c">change_time</a> = entry-&gt;<a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>.<a class="code" href="structfsal__attrib__list____.html#a7a45f08cab3e7b75d23099f913e1b219">chgtime</a>.<a class="code" href="structfsal__time____.html#add92ec6180384f0ba10dd2a79b659548">seconds</a>;
<a name="l00927"></a>00927      <span class="comment">/* Almost certainly not necessary */</span>
<a name="l00928"></a>00928      entry-&gt;<a class="code" href="structcache__entry__t.html#afa60c075430da0dbe9d5f4160f336294">type</a> = <a class="code" href="cache__inode__misc_8c.html#a8f6934bbf38300379caf1342b6a63b26" title="converts an FSAL type to the corresponding cache_inode type">cache_inode_fsal_type_convert</a>(entry-&gt;<a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>.<a class="code" href="structfsal__attrib__list____.html#a03249aca39ba1b16b4712079d93b025e">type</a>);
<a name="l00929"></a>00929      <span class="comment">/* We have just loaded the attributes from the FSAL. */</span>
<a name="l00930"></a>00930      entry-&gt;<a class="code" href="structcache__entry__t.html#a896c6b9f342fbc763040ae330526bed8">flags</a> |= CACHE_INODE_TRUST_ATTRS;
<a name="l00931"></a>00931 }
<a name="l00932"></a>00932 
<a name="l00944"></a>00944 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a>
<a name="l00945"></a>00945 cache_inode_refresh_attrs(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l00946"></a>00946                           <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context)
<a name="l00947"></a>00947 {
<a name="l00948"></a>00948      <a class="code" href="structfsal__status____.html">fsal_status_t</a> fsal_status = {<a class="code" href="err__fsal_8h.html#a5fca950e941463a0c2462761a96d20f2a2ab4fbc56e98d01fc4f166d513f92df1">ERR_FSAL_NO_ERROR</a>, 0};
<a name="l00949"></a>00949      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> cache_status = <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a3fdbbb2367268ae84ac11d7b189643d8">CACHE_INODE_SUCCESS</a>;
<a name="l00950"></a>00950 
<a name="l00951"></a>00951 <span class="preprocessor">#ifdef _USE_NFS4_ACL</span>
<a name="l00952"></a>00952 <span class="preprocessor"></span>     <span class="keywordflow">if</span> (entry-&gt;<a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>.<a class="code" href="structfsal__attrib__list____.html#a8dafc43a881e3c759511afdf3fac06fe">acl</a>) {
<a name="l00953"></a>00953          <a class="code" href="nfs4__acls_8h.html#a8c952b9bdb887a74d7bd618bc74b55b0">fsal_acl_status_t</a> acl_status = 0;
<a name="l00954"></a>00954 
<a name="l00955"></a>00955          <a class="code" href="nfs4__acls_8h.html#a943c5fc056d6ef9f315cd1afbb3df072">nfs4_acl_release_entry</a>(entry-&gt;<a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>.<a class="code" href="structfsal__attrib__list____.html#a8dafc43a881e3c759511afdf3fac06fe">acl</a>, &amp;acl_status);
<a name="l00956"></a>00956          <span class="keywordflow">if</span> (acl_status != <a class="code" href="nfs4__acls_8h.html#a1012eba8c448e23e7255f5c29b818a53">NFS_V4_ACL_SUCCESS</a>) {
<a name="l00957"></a>00957               <a class="code" href="log_8h.html#a014a663a4d20c38e82ab3f35298667e8">LogEvent</a>(<a class="code" href="log_8h.html#aef38a41286a6a40320bc7d64135b1556ac33e4664c7c96ac209167e6809fb2ba3">COMPONENT_CACHE_INODE</a>,
<a name="l00958"></a>00958                        <span class="stringliteral">&quot;Failed to release old acl, status=%d&quot;</span>,
<a name="l00959"></a>00959                        acl_status);
<a name="l00960"></a>00960          }
<a name="l00961"></a>00961          entry-&gt;<a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>.<a class="code" href="structfsal__attrib__list____.html#a8dafc43a881e3c759511afdf3fac06fe">acl</a> = <a class="code" href="Getopt_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00962"></a>00962      }
<a name="l00963"></a>00963 <span class="preprocessor">#endif </span><span class="comment">/* _USE_NFS4_ACL */</span>
<a name="l00964"></a>00964 
<a name="l00965"></a>00965      memset(&amp;entry-&gt;<a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="structfsal__attrib__list____.html">fsal_attrib_list_t</a>));
<a name="l00966"></a>00966      entry-&gt;<a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>.<a class="code" href="structfsal__attrib__list____.html#a7e26fea079dd3c9bb56a2426805765b9">asked_attributes</a> = cache_inode_params.<a class="code" href="structcache__inode__parameter____.html#a36e131762d50c490e179e9d63cae7da8">attrmask</a>;
<a name="l00967"></a>00967 
<a name="l00968"></a>00968      <span class="comment">/* I assume this function will go away in the Lieb</span>
<a name="l00969"></a>00969 <span class="comment">        Rearchitecture. */</span>
<a name="l00970"></a>00970      fsal_status = <a class="code" href="fsal__glue_8c.html#a2dc1dbe2ee0013b013839a0f2a0f929f">FSAL_getattrs_descriptor</a>(<a class="code" href="cache__inode__open__close_8c.html#ad56db1a0f05a02b28859ef3256cdd3ba" title="Returns a file descriptor, if open.">cache_inode_fd</a>(entry),
<a name="l00971"></a>00971                                             &amp;entry-&gt;<a class="code" href="structcache__entry__t.html#aaa7abf75d0997dba12395a01c09be705">handle</a>,
<a name="l00972"></a>00972                                             context,
<a name="l00973"></a>00973                                             &amp;entry-&gt;<a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>);
<a name="l00974"></a>00974      <span class="keywordflow">if</span> (<a class="code" href="fsal_8h.html#a7c2a97ec2fa552dea8e497c7dd8a2b86">FSAL_IS_ERROR</a>(fsal_status) &amp;&amp;
<a name="l00975"></a>00975          (fsal_status.<a class="code" href="structfsal__status____.html#ab12ffb4b1b65891a5dd5939fc7d543de">major</a> == <a class="code" href="err__fsal_8h.html#a5fca950e941463a0c2462761a96d20f2a7cb7749ac4307379d0388675f926dd37">ERR_FSAL_NOT_OPENED</a>)) {
<a name="l00976"></a>00976           fsal_status = <a class="code" href="fsal__glue_8c.html#a6442b3db127420aba2d823d6591ede1c">FSAL_getattrs</a>(&amp;entry-&gt;<a class="code" href="structcache__entry__t.html#aaa7abf75d0997dba12395a01c09be705">handle</a>,
<a name="l00977"></a>00977                                       context,
<a name="l00978"></a>00978                                       &amp;entry-&gt;<a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>);
<a name="l00979"></a>00979      }
<a name="l00980"></a>00980      <span class="keywordflow">if</span> (<a class="code" href="fsal_8h.html#a7c2a97ec2fa552dea8e497c7dd8a2b86">FSAL_IS_ERROR</a>(fsal_status)) {
<a name="l00981"></a>00981           <a class="code" href="cache__inode__kill__entry_8c.html#a643ff87017990abdba2c38f0939cd5af" title="Some routines for management of the cache_inode layer, shared by other calls.">cache_inode_kill_entry</a>(entry);
<a name="l00982"></a>00982           cache_status
<a name="l00983"></a>00983                = <a class="code" href="cache__inode__misc_8c.html#aaa50487b9b403fd85b4a845de1a3df69" title="Converts an FSAL error to the corresponding cache_inode error.">cache_inode_error_convert</a>(fsal_status);
<a name="l00984"></a>00984           <span class="keywordflow">goto</span> <a class="code" href="test__nfs__ip__name_8c.html#a0204bbf34f64a80680c73f74564b6d22">out</a>;
<a name="l00985"></a>00985      }
<a name="l00986"></a>00986 
<a name="l00987"></a>00987      cache_inode_fixup_md(entry);
<a name="l00988"></a>00988 
<a name="l00989"></a>00989      cache_status = <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a3fdbbb2367268ae84ac11d7b189643d8">CACHE_INODE_SUCCESS</a>;
<a name="l00990"></a>00990 
<a name="l00991"></a>00991 <a class="code" href="test__nfs__ip__name_8c.html#a0204bbf34f64a80680c73f74564b6d22">out</a>:
<a name="l00992"></a>00992      <span class="keywordflow">return</span> cache_status;
<a name="l00993"></a>00993 }
<a name="l00994"></a>00994 
<a name="l01005"></a>01005 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="nfsv40_8h.html#a188972b4ccdd37df707acf964b3ef6c9">changeid4</a>
<a name="l01006"></a>01006 cache_inode_get_changeid4(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry)
<a name="l01007"></a>01007 {
<a name="l01008"></a>01008      <span class="keywordflow">return</span> (<a class="code" href="nfsv40_8h.html#a188972b4ccdd37df707acf964b3ef6c9">changeid4</a>) entry-&gt;<a class="code" href="structcache__entry__t.html#a564df0bd95a95605998780d01032619c">change_time</a>;
<a name="l01009"></a>01009 }
<a name="l01010"></a>01010 
<a name="l01028"></a>01028 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a>
<a name="l01029"></a>01029 cache_inode_lock_trust_attrs(<a class="code" href="structcache__entry__t.html" title="Represents a cached inode.">cache_entry_t</a> *entry,
<a name="l01030"></a>01030                              <a class="code" href="structfsal__op__context____.html">fsal_op_context_t</a> *context)
<a name="l01031"></a>01031 {
<a name="l01032"></a>01032      <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2">cache_inode_status_t</a> cache_status = <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a3fdbbb2367268ae84ac11d7b189643d8">CACHE_INODE_SUCCESS</a>;
<a name="l01033"></a>01033 
<a name="l01034"></a>01034 
<a name="l01035"></a>01035      pthread_rwlock_rdlock(&amp;entry-&gt;<a class="code" href="structcache__entry__t.html#aa7bf1f222eb0fcefd928dde61c906b34">attr_lock</a>);
<a name="l01036"></a>01036      <span class="comment">/* Do we need to refresh? */</span>
<a name="l01037"></a>01037      <span class="keywordflow">if</span> (!(entry-&gt;<a class="code" href="structcache__entry__t.html#a896c6b9f342fbc763040ae330526bed8">flags</a> &amp; CACHE_INODE_TRUST_ATTRS) ||
<a name="l01038"></a>01038          <a class="code" href="fsal_8h.html#a22431080664a539634e88f4c7420aaef">FSAL_TEST_MASK</a>(entry-&gt;<a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>.<a class="code" href="structfsal__attrib__list____.html#a7e26fea079dd3c9bb56a2426805765b9">asked_attributes</a>,
<a name="l01039"></a>01039                         <a class="code" href="fsal__types_8h.html#a7d3ea4f9f07f7c968f9c331a43017f00">FSAL_ATTR_RDATTR_ERR</a>)) {
<a name="l01040"></a>01040           pthread_rwlock_unlock(&amp;entry-&gt;<a class="code" href="structcache__entry__t.html#aa7bf1f222eb0fcefd928dde61c906b34">attr_lock</a>);
<a name="l01041"></a>01041           pthread_rwlock_wrlock(&amp;entry-&gt;<a class="code" href="structcache__entry__t.html#aa7bf1f222eb0fcefd928dde61c906b34">attr_lock</a>);
<a name="l01042"></a>01042           <span class="comment">/* Has someone else done it for us? */</span>
<a name="l01043"></a>01043           <span class="keywordflow">if</span> (!(entry-&gt;<a class="code" href="structcache__entry__t.html#a896c6b9f342fbc763040ae330526bed8">flags</a> &amp; CACHE_INODE_TRUST_ATTRS) ||
<a name="l01044"></a>01044               <a class="code" href="fsal_8h.html#a22431080664a539634e88f4c7420aaef">FSAL_TEST_MASK</a>(entry-&gt;<a class="code" href="structcache__entry__t.html#aad2a56294dcb57329b3b9fcd56e31f27">attributes</a>.<a class="code" href="structfsal__attrib__list____.html#a7e26fea079dd3c9bb56a2426805765b9">asked_attributes</a>,
<a name="l01045"></a>01045                              <a class="code" href="fsal__types_8h.html#a7d3ea4f9f07f7c968f9c331a43017f00">FSAL_ATTR_RDATTR_ERR</a>)) {
<a name="l01046"></a>01046                <span class="comment">/* Release the lock on error */</span>
<a name="l01047"></a>01047                <span class="keywordflow">if</span> ((cache_status =
<a name="l01048"></a>01048                     cache_inode_refresh_attrs(entry,
<a name="l01049"></a>01049                                               context))
<a name="l01050"></a>01050                    != <a class="code" href="cache__inode_8h.html#aa6929668cedf7463f35a22998b8e08d2a3fdbbb2367268ae84ac11d7b189643d8">CACHE_INODE_SUCCESS</a>) {
<a name="l01051"></a>01051                     pthread_rwlock_unlock(&amp;entry-&gt;<a class="code" href="structcache__entry__t.html#aa7bf1f222eb0fcefd928dde61c906b34">attr_lock</a>);
<a name="l01052"></a>01052                }
<a name="l01053"></a>01053           }
<a name="l01054"></a>01054      }
<a name="l01055"></a>01055 
<a name="l01056"></a>01056      <span class="keywordflow">return</span> cache_status;
<a name="l01057"></a>01057 }
<a name="l01058"></a>01058 
<a name="l01059"></a>01059 <span class="preprocessor">#endif </span><span class="comment">/*  _CACHE_INODE_H */</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Nov 21 2012 for nfs-ganesha by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
